<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>JPG转PDF工具：免费在线将图片转换为PDF文档 | 批量转换支持</title>
      <link href="/2024/12/11/JPG%E8%BD%ACPDF/"/>
      <url>/2024/12/11/JPG%E8%BD%ACPDF/</url>
      
        <content type="html"><![CDATA[<h1 id="JPG-转-PDF：免费好用的在线图片转-PDF-工具"><a href="#JPG-转-PDF：免费好用的在线图片转-PDF-工具" class="headerlink" title="JPG 转 PDF：免费好用的在线图片转 PDF 工具"></a>JPG 转 PDF：免费好用的在线图片转 PDF 工具</h1><p>在日常工作和生活中，我们经常需要将图片转换为 PDF 格式。无论是制作电子文档、准备演示材料，还是整理照片集，将图片转换为 PDF 都是一个常见的需求。今天为大家介绍一款完全免费、无需下载的在线工具：JPG 转 PDF。</p><h2 id="🔗-立即体验"><a href="#🔗-立即体验" class="headerlink" title="🔗 立即体验"></a>🔗 立即体验</h2><p>在线使用地址：<a href="https://jpg2pdf.cdtools.click/">https://jpg2pdf.cdtools.click/</a></p><p>欢迎访问我的博客：<a href="https://cdtools.click/">https://cdtools.click</a>，这里有更多实用的工具和技术分享。</p><p><img src="https://cdn.jsdelivr.net/gh/houxiaozhao/imageLibrary@master/uPic/2024/12/11/lBofRG.png" alt="lBofRG"></p><h2 id="🔍-使用场景"><a href="#🔍-使用场景" class="headerlink" title="🔍 使用场景"></a>🔍 使用场景</h2><ul><li>📑 制作电子简历：将证书照片整合成 PDF 文档</li><li>📊 准备商务文档：把产品图片、数据截图等转换为专业的 PDF 报告</li><li>📸 整理照片集：将多张旅行照片合并为一个 PDF 相册</li><li>📋 文档归档：把各类图片文件统一转换为 PDF 格式存档</li><li>🖼️ 作品集制作：设计师将作品图片整合为 PDF 作品集</li></ul><h2 id="✨-核心功能"><a href="#✨-核心功能" class="headerlink" title="✨ 核心功能"></a>✨ 核心功能</h2><h3 id="1-批量转换"><a href="#1-批量转换" class="headerlink" title="1. 批量转换"></a>1. 批量转换</h3><ul><li>支持同时上传多张图片</li><li>支持拖拽调整图片顺序</li><li>一键生成 PDF 文档</li></ul><h3 id="2-图片调整"><a href="#2-图片调整" class="headerlink" title="2. 图片调整"></a>2. 图片调整</h3><ul><li>支持图片旋转</li><li>自由调整页面大小</li><li>灵活设置页面边距</li></ul><h3 id="3-便捷操作"><a href="#3-便捷操作" class="headerlink" title="3. 便捷操作"></a>3. 便捷操作</h3><ul><li>拖拽排序功能</li><li>实时预览效果</li><li>支持中英文界面</li><li>深色模式支持</li></ul><h3 id="4-其他特点"><a href="#4-其他特点" class="headerlink" title="4. 其他特点"></a>4. 其他特点</h3><ul><li>完全免费使用</li><li>无需注册登录</li><li>所有处理都在本地完成，保护隐私</li><li>支持主流图片格式（JPG、PNG 等）</li></ul><h2 id="📝-使用说明"><a href="#📝-使用说明" class="headerlink" title="📝 使用说明"></a>📝 使用说明</h2><ol><li><strong>上传图片</strong><ul><li>点击”选择图片文件”按钮</li><li>或直接拖拽图片到上传区域</li></ul></li><li><strong>调整设置</strong><ul><li>选择页面大小（原始大小&#x2F;A4）</li><li>设置页面边距（无边距&#x2F;小边距&#x2F;大边距）</li></ul></li><li><strong>编辑图片</strong><ul><li>拖动调整图片顺序</li><li>点击旋转按钮调整图片方向</li><li>预览区实时查看效果</li></ul></li><li><strong>生成 PDF</strong><ul><li>确认设置和顺序无误后</li><li>点击”生成 PDF”按钮</li><li>自动下载转换后的 PDF 文件</li></ul></li></ol><h2 id="🌟-特色优势"><a href="#🌟-特色优势" class="headerlink" title="🌟 特色优势"></a>🌟 特色优势</h2><ol><li><p><strong>简单易用</strong></p><ul><li>界面直观清晰</li><li>操作步骤简单</li><li>无需学习成本</li></ul></li><li><p><strong>功能完善</strong></p><ul><li>支持批量处理</li><li>提供图片编辑</li><li>灵活的输出选项</li></ul></li><li><p><strong>安全可靠</strong></p><ul><li>本地处理，无需上传服务器</li><li>保护文件隐私</li><li>转换速度快</li></ul></li><li><p><strong>免费开源</strong></p><ul><li>完全免费使用</li><li>代码开源，透明可靠</li><li>持续更新维护</li></ul></li></ol><h2 id="📦-开源地址"><a href="#📦-开源地址" class="headerlink" title="📦 开源地址"></a>📦 开源地址</h2><p><a href="https://github.com/houxiaozhao/jpg2pdf">https://github.com/houxiaozhao/jpg2pdf</a></p><h2 id="🤝-参与贡献"><a href="#🤝-参与贡献" class="headerlink" title="🤝 参与贡献"></a>🤝 参与贡献</h2><p>欢迎提出建议和反馈，帮助我们把工具做得更好！</p><hr><p>如果您觉得这个工具对您有帮助，欢迎分享给更多需要的人。您的支持是我们持续改进的动力！</p>]]></content>
      
      
      
        <tags>
            
            <tag> 图片处理 </tag>
            
            <tag> 在线工具 </tag>
            
            <tag> 文档转换 </tag>
            
            <tag> PDF工具 </tag>
            
            <tag> 免费软件 </tag>
            
            <tag> 开源项目 </tag>
            
            <tag> 文件转换 </tag>
            
            <tag> 效率工具 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>UTM和WGS84坐标转换工具-专业地理坐标系统转换解决方案</title>
      <link href="/2024/12/10/UTM-WGS84%E5%9D%90%E6%A0%87%E8%BD%AC%E6%8D%A2%E5%B7%A5%E5%85%B7/"/>
      <url>/2024/12/10/UTM-WGS84%E5%9D%90%E6%A0%87%E8%BD%AC%E6%8D%A2%E5%B7%A5%E5%85%B7/</url>
      
        <content type="html"><![CDATA[<h1 id="UTM-x2F-WGS84-坐标转换工具"><a href="#UTM-x2F-WGS84-坐标转换工具" class="headerlink" title="UTM&#x2F;WGS84 坐标转换工具"></a>UTM&#x2F;WGS84 坐标转换工具</h1><h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h2><p>在地理信息系统(GIS)、测绘、工程等领域，经常需要处理不同坐标系统之间的转换。这个在线工具提供了 UTM（通用横轴墨卡托）坐标系和 WGS84（GPS）坐标系之间的双向转换功能，让坐标转换变得简单快捷。</p><p>🔗 在线体验：<a href="https://utm.cdtools.click/">UTM&#x2F;WGS84 坐标转换工具</a></p><p>欢迎访问我的博客：<a href="https://cdtools.click/">https://cdtools.click</a>，这里有更多实用的工具和技术分享。</p><p><img src="https://cdn.jsdelivr.net/gh/houxiaozhao/imageLibrary@master/uPic/2024/12/10/D7ReiI.png" alt="D7ReiI"></p><h2 id="主要功能"><a href="#主要功能" class="headerlink" title="主要功能"></a>主要功能</h2><h3 id="1-坐标转换"><a href="#1-坐标转换" class="headerlink" title="1. 坐标转换"></a>1. 坐标转换</h3><ul><li>UTM 坐标转 WGS84(GPS)坐标</li><li>WGS84(GPS)坐标转 UTM 坐标</li><li>支持批量转换（多行坐标同时转换）</li></ul><h3 id="2-可视化展示"><a href="#2-可视化展示" class="headerlink" title="2. 可视化展示"></a>2. 可视化展示</h3><ul><li>转换结果在地图上实时显示</li><li>自动调整地图视角以显示所有坐标点</li><li>支持地图缩放和平移</li></ul><h3 id="3-数据导出"><a href="#3-数据导出" class="headerlink" title="3. 数据导出"></a>3. 数据导出</h3><ul><li>支持将转换结果导出为 CSV 格式</li><li>导出文件包含完整的坐标信息和表头</li></ul><h3 id="4-便捷功能"><a href="#4-便捷功能" class="headerlink" title="4. 便捷功能"></a>4. 便捷功能</h3><ul><li>深色&#x2F;浅色主题切换</li><li>中文&#x2F;英文界面切换</li><li>实时坐标格式验证</li><li>一键清空输入</li></ul><h2 id="使用说明"><a href="#使用说明" class="headerlink" title="使用说明"></a>使用说明</h2><h3 id="UTM-坐标转-GPS-坐标"><a href="#UTM-坐标转-GPS-坐标" class="headerlink" title="UTM 坐标转 GPS 坐标"></a>UTM 坐标转 GPS 坐标</h3><ol><li>在左侧上方文本框中输入 UTM 坐标</li><li>格式为：<code>东向坐标 北向坐标 带号 带字母</code></li><li>例如：<code>699999 5000000 30 N</code></li><li>点击”UTM 转 GPS”按钮进行转换</li><li>转换结果将显示在下方文本框中，并在地图上标注位置</li></ol><h3 id="GPS-坐标转-UTM-坐标"><a href="#GPS-坐标转-UTM-坐标" class="headerlink" title="GPS 坐标转 UTM 坐标"></a>GPS 坐标转 UTM 坐标</h3><ol><li>在左侧下方文本框中输入 GPS 坐标</li><li>格式为：<code>纬度 经度</code></li><li>例如：<code>45.123456 -123.123456</code></li><li>点击”GPS 转 UTM”按钮进行转换</li><li>转换结果将显示在上方文本框中，并在地图上标注位置</li></ol><h3 id="批量转换"><a href="#批量转换" class="headerlink" title="批量转换"></a>批量转换</h3><ul><li>每行输入一组坐标</li><li>支持同时转换多组坐标</li><li>所有转换结果将在地图上同时显示</li></ul><h3 id="注意事项"><a href="#注意事项" class="headerlink" title="注意事项"></a>注意事项</h3><ul><li>UTM 坐标的带字母必须是 C-X 之间的字母</li><li>GPS 坐标的纬度范围为-90 到 90 度</li><li>GPS 坐标的经度范围为-180 到 180 度</li><li>输入格式错误会有提示信息</li><li>建议使用空格或逗号分隔坐标数值</li></ul><h2 id="开源地址"><a href="#开源地址" class="headerlink" title="开源地址"></a>开源地址</h2><p>🔗 GitHub: <a href="https://github.com/houxiaozhao/utmCoordinateTransformation">项目地址</a></p>]]></content>
      
      
      
        <tags>
            
            <tag> UTM坐标转换 </tag>
            
            <tag> WGS84坐标 </tag>
            
            <tag> GIS工具 </tag>
            
            <tag> 地理信息系统 </tag>
            
            <tag> 坐标转换工具 </tag>
            
            <tag> 地理空间数据 </tag>
            
            <tag> 测绘工具 </tag>
            
            <tag> 地图坐标转换 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>AI智能图片背景移除工具：快速、免费、本地处理</title>
      <link href="/2024/12/09/AI%E5%9B%BE%E7%89%87%E8%83%8C%E6%99%AF%E7%A7%BB%E9%99%A4%E5%B7%A5%E5%85%B7/"/>
      <url>/2024/12/09/AI%E5%9B%BE%E7%89%87%E8%83%8C%E6%99%AF%E7%A7%BB%E9%99%A4%E5%B7%A5%E5%85%B7/</url>
      
        <content type="html"><![CDATA[<h1 id="AI-图片背景移除工具"><a href="#AI-图片背景移除工具" class="headerlink" title="AI 图片背景移除工具"></a>AI 图片背景移除工具</h1><p>一款完全免费、无需注册的 AI 图片背景移除工具。基于先进的 AI 模型，可以快速准确地移除图片背景，支持批量处理。</p><h2 id="在线使用"><a href="#在线使用" class="headerlink" title="在线使用"></a>在线使用</h2><p>访问地址：<a href="https://removebg.cdtools.click/">AI 背景移除工具</a></p><p>欢迎访问我的博客：<a href="https://cdtools.click/">https://cdtools.click</a>，这里有更多实用的工具和技术分享。</p><p><img src="https://cdn.jsdelivr.net/gh/houxiaozhao/imageLibrary@master/uPic/2024/12/09/KmApCM.png" alt="KmApCM"></p><h2 id="为什么选择这款工具？"><a href="#为什么选择这款工具？" class="headerlink" title="为什么选择这款工具？"></a>为什么选择这款工具？</h2><p>在当今数字时代，高质量的图片处理需求日益增长。无论是电商产品图、个人社交媒体还是专业设计工作，移除图片背景都是一个常见需求。我们的 AI 图片背景移除工具具有以下独特优势：</p><h3 id="1-极致的用户体验"><a href="#1-极致的用户体验" class="headerlink" title="1. 极致的用户体验"></a>1. 极致的用户体验</h3><ul><li><strong>简单直观的界面设计</strong>：采用直观的拖放操作和清晰的界面布局，即使是首次使用的用户也能迅速上手。</li><li><strong>实时预览功能</strong>：通过创新的滑块对比功能，用户可以直观地对比原图和处理后的效果，确保处理结果符合预期。</li><li><strong>批量处理能力</strong>：支持同时上传多张图片，系统会自动将它们加入处理队列，大大提高工作效率。</li></ul><h3 id="2-强大的处理能力"><a href="#2-强大的处理能力" class="headerlink" title="2. 强大的处理能力"></a>2. 强大的处理能力</h3><ul><li><strong>智能边缘检测</strong>：基于深度学习的图像分割技术，能够精确识别主体和背景的边界，处理效果远超传统算法。</li><li><strong>细节保留</strong>：在去除背景的同时，完美保留头发丝、毛皮等细节，确保图片主体的完整性。</li><li><strong>多场景适配</strong>：<ul><li>产品图：完美处理各类商品图片，适合电商场景</li><li>人像图：智能识别人物轮廓，适合证件照或社交媒体头像</li><li>动物图：准确处理复杂的毛发边缘</li><li>植物图：精确分割叶片等细节部分</li></ul></li></ul><h3 id="3-注重隐私保护"><a href="#3-注重隐私保护" class="headerlink" title="3. 注重隐私保护"></a>3. 注重隐私保护</h3><p>在数据安全日益重要的今天，我们的工具采用了全本地处理的方案：</p><ul><li><strong>本地运算</strong>：所有图片处理都在用户浏览器中完成，无需上传到服务器</li><li><strong>无需注册</strong>：不收集任何用户信息，保护用户隐私</li><li><strong>离线可用</strong>：首次加载模型后，可在离线环境下继续使用</li></ul><h3 id="4-技术创新"><a href="#4-技术创新" class="headerlink" title="4. 技术创新"></a>4. 技术创新</h3><p>本工具采用了多项创新技术，确保处理效果和性能的最优平衡：</p><ul><li><strong>WebGPU 加速</strong>：利用最新的 WebGPU 技术，充分发挥显卡性能，提供接近原生应用的处理速度</li><li><strong>智能队列管理</strong>：自动调节处理队列，防止浏览器过载</li><li><strong>渐进式处理</strong>：大图片采用分块处理技术，确保流畅的用户体验</li><li><strong>自适应优化</strong>：根据设备性能自动调整处理参数，在不同设备上都能获得最佳体验</li></ul><h3 id="5-应用场景"><a href="#5-应用场景" class="headerlink" title="5. 应用场景"></a>5. 应用场景</h3><p>我们的工具广泛应用于多个领域：</p><ol><li><p><strong>电商领域</strong></p><ul><li>产品图片处理：快速生成透明背景的产品图</li><li>营销图片制作：创建专业的营销展示图片</li><li>批量处理商品图：高效处理大量商品图片</li></ul></li><li><p><strong>设计行业</strong></p><ul><li>平面设计：快速获取所需素材</li><li>UI 设计：制作应用界面元素</li><li>海报设计：提取主体元素进行创意组合</li></ul></li><li><p><strong>个人用户</strong></p><ul><li>社交媒体：制作个性化头像和封面</li><li>证件照片：生成标准证件照</li><li>个人作品：创作艺术照片和图片合成</li></ul></li></ol><h3 id="6-使用技巧"><a href="#6-使用技巧" class="headerlink" title="6. 使用技巧"></a>6. 使用技巧</h3><p>为了帮助用户获得最佳效果，这里分享一些实用技巧：</p><ol><li><p><strong>图片准备</strong></p><ul><li>选择清晰度较高的原图</li><li>确保主体和背景有一定对比度</li><li>避免使用过于复杂的背景</li></ul></li><li><p><strong>处理建议</strong></p><ul><li>对于大尺寸图片，建议先裁剪到合适大小</li><li>批量处理时，建议按照相似场景分组上传</li><li>使用滑块仔细检查边缘细节</li></ul></li><li><p><strong>导出选项</strong></p><ul><li>根据使用场景选择合适的图片尺寸</li><li>需要二次编辑时推荐使用 PNG 格式</li><li>可以利用批量导出功能节省时间</li></ul></li></ol><h2 id="功能特点"><a href="#功能特点" class="headerlink" title="功能特点"></a>功能特点</h2><ul><li>✨ 完全免费，无需注册</li><li>🚀 本地运算，保护隐私</li><li>🖼️ 支持批量处理</li><li>📱 支持移动端和 PC 端</li><li>🎯 高精度 AI 识别</li><li>🔄 实时预览效果</li><li>💾 一键导出所有结果</li></ul><h2 id="使用说明"><a href="#使用说明" class="headerlink" title="使用说明"></a>使用说明</h2><h3 id="上传图片"><a href="#上传图片" class="headerlink" title="上传图片"></a>上传图片</h3><p>有两种方式上传图片：</p><ol><li>点击上传区域选择图片</li><li>直接拖拽图片到上传区域</li></ol><p>支持同时上传多张图片进行批量处理。</p><h3 id="预览和对比"><a href="#预览和对比" class="headerlink" title="预览和对比"></a>预览和对比</h3><ul><li>使用滑块可以直观对比原图和处理后的效果</li><li>支持查看处理进度</li><li>可以随时删除单张图片或清空所有图片</li></ul><h3 id="导出结果"><a href="#导出结果" class="headerlink" title="导出结果"></a>导出结果</h3><ul><li>处理完成后，可以点击”导出全部”一键保存所有处理结果</li><li>每张图片都保持原始尺寸</li><li>导出格式为 PNG，保留透明背景</li></ul><h2 id="技术亮点"><a href="#技术亮点" class="headerlink" title="技术亮点"></a>技术亮点</h2><p>本工具使用了 Transformers.js 技术，这是一个突破性的 JavaScript AI 框架，让我们能够直接在浏览器中运行强大的 AI 模型。在本项目中，Transformers.js 的使用主要体现在：</p><ol><li><p>模型加载</p><ul><li>使用了 RMBG-1.4 模型，这是一个专门针对背景移除优化的 AI 模型</li><li>模型完全在本地运行，无需服务器支持</li><li>首次使用时会自动下载模型文件</li></ul></li><li><p>图像处理</p><ul><li>支持多种图片格式和尺寸</li><li>自动优化处理参数，确保最佳效果</li><li>使用 WebGPU 加速，提供快速的处理速度</li></ul></li><li><p>隐私保护</p><ul><li>所有处理都在本地完成，图片不会上传到服务器</li><li>无需担心隐私泄露问题</li></ul></li></ol><h2 id="开源地址"><a href="#开源地址" class="headerlink" title="开源地址"></a>开源地址</h2><p><a href="https://github.com/houxiaozhao/remove-bg">GitHub 开源地址</a></p><h2 id="问题反馈"><a href="#问题反馈" class="headerlink" title="问题反馈"></a>问题反馈</h2><p>如果您在使用过程中遇到任何问题，或者有功能建议，欢迎通过以下方式反馈：</p><ol><li>在 GitHub 仓库提交 Issue</li></ol><p>感谢您的使用和支持！</p>]]></content>
      
      
      
        <tags>
            
            <tag> AI工具 </tag>
            
            <tag> 图片处理 </tag>
            
            <tag> 背景移除 </tag>
            
            <tag> 在线工具 </tag>
            
            <tag> WebGPU </tag>
            
            <tag> 人工智能 </tag>
            
            <tag> 设计工具 </tag>
            
            <tag> 免费工具 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>在线PDF合并工具 - 快速、免费、安全的文档处理解决方案 | Online PDF Merger Tool</title>
      <link href="/2024/12/06/PDF%E5%90%88%E5%B9%B6%E5%B7%A5%E5%85%B7/"/>
      <url>/2024/12/06/PDF%E5%90%88%E5%B9%B6%E5%B7%A5%E5%85%B7/</url>
      
        <content type="html"><![CDATA[<h1 id="PDF-合并工具-在线免费-PDF-合并"><a href="#PDF-合并工具-在线免费-PDF-合并" class="headerlink" title="PDF 合并工具 - 在线免费 PDF 合并"></a>PDF 合并工具 - 在线免费 PDF 合并</h1><p>在线体验：<a href="https://merge-pdf.cdtools.click/">https://merge-pdf.cdtools.click</a></p><p>欢迎访问我的博客：<a href="https://cdtools.click/">https://cdtools.click</a>，这里有更多实用的工具和技术分享。</p><p><img src="https://cdn.jsdelivr.net/gh/houxiaozhao/imageLibrary@master/uPic/2024/12/06/jvOcKs.png" alt="jvOcKs"></p><h2 id="功能介绍"><a href="#功能介绍" class="headerlink" title="功能介绍"></a>功能介绍</h2><p>PDF 合并工具是一个简单易用的在线 PDF 文件合并工具，可以帮助您快速将多个 PDF 文件合并成一个文档。无需下载安装任何软件，完全免费使用，并且所有操作都在浏览器本地完成，确保文件安全。</p><h3 id="主要特点"><a href="#主要特点" class="headerlink" title="主要特点"></a>主要特点</h3><ul><li>完全免费：无需付费，无需注册</li><li>本地处理：所有文件在您的浏览器本地处理，保护文件安全</li><li>支持批量：可同时上传多个 PDF 文件进行合并</li><li>灵活排序：支持拖拽调整文件顺序</li><li>文件限制：单个文件最大支持 50MB</li><li>多语言支持：支持中文和英文界面</li><li>深色模式：支持明亮&#x2F;暗黑两种显示模式</li></ul><h2 id="使用说明"><a href="#使用说明" class="headerlink" title="使用说明"></a>使用说明</h2><ol><li><p><strong>上传文件</strong></p><ul><li>点击上传区域或直接将 PDF 文件拖拽到上传区域</li><li>支持一次性选择多个 PDF 文件</li><li>每个文件大小不能超过 50MB</li></ul></li><li><p><strong>调整顺序</strong></p><ul><li>上传的文件将显示在文件列表中</li><li>通过拖拽可以调整文件的合并顺序</li><li>可以点击”按名称排序”或”按大小排序”进行快速排序</li><li>不需要的文件可以点击删除按钮移除</li></ul></li><li><p><strong>合并文件</strong></p><ul><li>确认文件顺序后，点击”合并 PDF”按钮</li><li>等待合并完成后，系统会自动下载合并后的 PDF 文件</li><li>合并后的文件名为”merged.pdf”</li></ul></li></ol><h2 id="注意事项"><a href="#注意事项" class="headerlink" title="注意事项"></a>注意事项</h2><ul><li>请确保上传的文件为 PDF 格式</li><li>建议使用现代浏览器（Chrome、Firefox、Safari 等）访问</li><li>如果文件较大，合并时可能需要等待几秒钟</li><li>所有文件都在本地处理，不会上传到服务器</li></ul><p>开源地址 <a href="https://github.com/houxiaozhao/pdfmerge">https://github.com/houxiaozhao/pdfmerge</a></p><h2 id="问题反馈"><a href="#问题反馈" class="headerlink" title="问题反馈"></a>问题反馈</h2><p>如果您在使用过程中遇到任何问题，或有功能建议，欢迎通过以下方式反馈：</p><ol><li>在 GitHub 项目中提交 Issue</li></ol>]]></content>
      
      
      
        <tags>
            
            <tag> 在线工具 </tag>
            
            <tag> 免费工具 </tag>
            
            <tag> PDF工具 </tag>
            
            <tag> 效率工具 </tag>
            
            <tag> 文档处理 </tag>
            
            <tag> 文件合并 </tag>
            
            <tag> 办公软件 </tag>
            
            <tag> 文档管理 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>豆瓣小组爬虫：轻松获取小组讨论内容</title>
      <link href="/2024/12/06/%E8%B1%86%E7%93%A3%E5%B0%8F%E7%BB%84%E7%88%AC%E8%99%AB/"/>
      <url>/2024/12/06/%E8%B1%86%E7%93%A3%E5%B0%8F%E7%BB%84%E7%88%AC%E8%99%AB/</url>
      
        <content type="html"><![CDATA[<h1 id="豆瓣小组爬虫：轻松获取小组讨论内容"><a href="#豆瓣小组爬虫：轻松获取小组讨论内容" class="headerlink" title="豆瓣小组爬虫：轻松获取小组讨论内容"></a>豆瓣小组爬虫：轻松获取小组讨论内容</h1><p>开源地址：<a href="git@github.com:houxiaozhao/douban.git">https://github.com/houxiaozhao/douban</a></p><p>欢迎访问我的博客：<a href="https://cdtools.click/">https://cdtools.click</a>，这里有更多实用的工具和技术分享。</p><p>这是一个专门用于获取豆瓣小组讨论内容的工具。它可以帮助你自动收集感兴趣的小组讨论，支持多个小组同时采集，并且智能地只获取最新内容，避免重复。</p><h2 id="功能特点"><a href="#功能特点" class="headerlink" title="功能特点"></a>功能特点</h2><h3 id="1-支持多个小组同时采集"><a href="#1-支持多个小组同时采集" class="headerlink" title="1. 支持多个小组同时采集"></a>1. 支持多个小组同时采集</h3><p>你可以同时关注多个感兴趣的小组，比如：</p><ul><li>外企招聘</li><li>北京租房</li><li>其他任何你感兴趣的小组</li></ul><p><img src="https://cdn.jsdelivr.net/gh/houxiaozhao/imageLibrary@master/uPic/2024/12/06/oOTGb5.png" alt="oOTGb5"></p><h3 id="2-智能增量更新"><a href="#2-智能增量更新" class="headerlink" title="2. 智能增量更新"></a>2. 智能增量更新</h3><ul><li>自动记录已经采集的内容</li><li>每次运行时只获取新发布的讨论</li><li>避免重复采集相同的内容</li></ul><h3 id="3-完整的讨论信息"><a href="#3-完整的讨论信息" class="headerlink" title="3. 完整的讨论信息"></a>3. 完整的讨论信息</h3><p>每条讨论都会保存以下信息：</p><ul><li>标题</li><li>作者</li><li>发布时间</li><li>讨论链接</li><li>所属小组</li></ul><h2 id="使用说明"><a href="#使用说明" class="headerlink" title="使用说明"></a>使用说明</h2><h3 id="第一步：配置关注的小组"><a href="#第一步：配置关注的小组" class="headerlink" title="第一步：配置关注的小组"></a>第一步：配置关注的小组</h3><p>在配置文件中添加你想要关注的豆瓣小组名称，例如：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">groups = ForeignCompany,beijingzufang</span><br></pre></td></tr></table></figure><h3 id="第二步：设置时间范围"><a href="#第二步：设置时间范围" class="headerlink" title="第二步：设置时间范围"></a>第二步：设置时间范围</h3><p>可以设置只获取某个时间之后的讨论，例如：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">earliestTime = 2024-12-05 00:00:00</span><br></pre></td></tr></table></figure><p>这样就只会获取 2024 年 12 月 5 日之后的新讨论。</p><h3 id="第三步：运行程序"><a href="#第三步：运行程序" class="headerlink" title="第三步：运行程序"></a>第三步：运行程序</h3><p>运行程序后，它会自动：</p><ol><li>访问配置的所有小组</li><li>获取每个小组的最新讨论</li><li>保存所有符合时间要求的讨论内容</li><li>自动去重，避免重复采集</li></ol><h2 id="使用场景"><a href="#使用场景" class="headerlink" title="使用场景"></a>使用场景</h2><ol><li><strong>求职信息采集</strong></li></ol><ul><li>关注各大招聘小组</li><li>及时获取最新职位信息</li><li>不会错过感兴趣的机会</li></ul><ol start="2"><li><strong>租房信息跟踪</strong></li></ol><ul><li>同时关注多个租房小组</li><li>实时获取新发布的房源</li><li>快人一步找到心仪房源</li></ul><ol start="3"><li><strong>兴趣小组跟踪</strong></li></ol><ul><li>关注你感兴趣的话题小组</li><li>不错过重要的讨论内容</li><li>随时了解小组动态</li></ul><h2 id="注意事项"><a href="#注意事项" class="headerlink" title="注意事项"></a>注意事项</h2><ol><li>使用前请确保遵守豆瓣的使用条款</li><li>建议合理设置采集频率</li><li>目前暂不支持评论内容的采集</li><li>获取的时间是最后回复时间，不是发布时间</li></ol><h2 id="未来规划"><a href="#未来规划" class="headerlink" title="未来规划"></a>未来规划</h2><ol><li>添加代理支持，提高稳定性</li><li>优化结束判断逻辑</li><li>支持获取发布时间</li><li>添加更多自定义配置选项</li></ol>]]></content>
      
      
      
        <tags>
            
            <tag> 自动化工具 </tag>
            
            <tag> 数据采集 </tag>
            
            <tag> 豆瓣API </tag>
            
            <tag> 网络爬虫 </tag>
            
            <tag> 数据抓取 </tag>
            
            <tag> 增量更新 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>火车座位靠窗查询工具：智能快速定位列车观景座位</title>
      <link href="/2024/12/05/%E7%81%AB%E8%BD%A6%E9%9D%A0%E7%AA%97%E5%BA%A7%E4%BD%8D%E6%9F%A5%E8%AF%A2%E7%B3%BB%E7%BB%9F/"/>
      <url>/2024/12/05/%E7%81%AB%E8%BD%A6%E9%9D%A0%E7%AA%97%E5%BA%A7%E4%BD%8D%E6%9F%A5%E8%AF%A2%E7%B3%BB%E7%BB%9F/</url>
      
        <content type="html"><![CDATA[<h1 id="火车靠窗座位查询系统：轻松找到最佳观景位置"><a href="#火车靠窗座位查询系统：轻松找到最佳观景位置" class="headerlink" title="火车靠窗座位查询系统：轻松找到最佳观景位置"></a>火车靠窗座位查询系统：轻松找到最佳观景位置</h1><p>在线查询地址：<a href="https://seat.cdtools.click/">https://seat.cdtools.click</a></p><p>欢迎访问我的博客：<a href="https://cdtools.click/">https://cdtools.click</a>，这里有更多实用的工具和技术分享。</p><h2 id="功能介绍"><a href="#功能介绍" class="headerlink" title="功能介绍"></a>功能介绍</h2><p>火车靠窗座位查询系统是一个免费、快速、准确的在线工具，帮助您在购买火车票时轻松确认座位是否靠窗。无论是想欣赏沿途风景，还是想安静休息，选择一个靠窗的座位都能让您的旅程更加舒适。</p><h2 id="使用说明"><a href="#使用说明" class="headerlink" title="使用说明"></a>使用说明</h2><h3 id="普通列车（K、T-字头，纯数字）"><a href="#普通列车（K、T-字头，纯数字）" class="headerlink" title="普通列车（K、T 字头，纯数字）"></a>普通列车（K、T 字头，纯数字）</h3><ol><li>选择火车类型（K&#x2F;T 字头，纯数字）</li><li>选择座位类型<ul><li>无列车长办公室（118 座）</li><li>有列车长办公室（112 座）<blockquote><p>温馨提示：</p><ul><li>长途车：列车长办公室在 8 号车厢</li><li>短途车：列车长办公室在 5 号车厢</li></ul></blockquote></li></ul></li><li>输入座位号</li><li>系统会立即显示该座位是否靠窗</li></ol><p><img src="https://cdn.jsdelivr.net/gh/houxiaozhao/imageLibrary@master/uPic/2024/12/05/B8ieqG.png" alt="B8ieqG"></p><h3 id="高铁-x2F-动车（G-x2F-D-字头）"><a href="#高铁-x2F-动车（G-x2F-D-字头）" class="headerlink" title="高铁&#x2F;动车（G&#x2F;D 字头）"></a>高铁&#x2F;动车（G&#x2F;D 字头）</h3><ol><li>选择火车类型（G&#x2F;D 字头）</li><li>选择座位字母（A&#x2F;B&#x2F;C&#x2F;D&#x2F;F）</li><li>系统会立即显示该座位是否靠窗<ul><li>A、F 座为靠窗座位</li><li>B、C、D 座为非靠窗座位</li></ul></li></ol><p><img src="https://cdn.jsdelivr.net/gh/houxiaozhao/imageLibrary@master/uPic/2024/12/05/xQAgbZ.png" alt="xQAgbZ"></p><h2 id="特色优势"><a href="#特色优势" class="headerlink" title="特色优势"></a>特色优势</h2><ul><li><strong>完全免费</strong>：提供免费的座位查询服务</li><li><strong>快速查询</strong>：即时获取座位位置信息</li><li><strong>准确可靠</strong>：数据准确，查询结果可靠</li><li><strong>简单易用</strong>：界面直观，操作简单</li><li><strong>无需注册</strong>：直接访问即可使用</li></ul><h2 id="开源信息"><a href="#开源信息" class="headerlink" title="开源信息"></a>开源信息</h2><p>本项目已在 GitHub 开源，欢迎访问：</p><p><a href="https://github.com/houxiaozhao/trainseat">https://github.com/houxiaozhao/trainseat</a></p><h2 id="问题反馈"><a href="#问题反馈" class="headerlink" title="问题反馈"></a>问题反馈</h2><p>如果您在使用过程中遇到任何问题，或有任何建议，欢迎通过以下方式反馈：</p><ul><li>在 GitHub 项目中提交 Issue</li></ul><hr><p>希望这个工具能帮助您在购票时做出更好的选择，祝您旅途愉快！</p>]]></content>
      
      
      
        <tags>
            
            <tag> 火车座位查询 </tag>
            
            <tag> 列车靠窗座位 </tag>
            
            <tag> 火车票购买指南 </tag>
            
            <tag> 旅行工具 </tag>
            
            <tag> 火车出行 </tag>
            
            <tag> 座位预订 </tag>
            
            <tag> 列车座位导航 </tag>
            
            <tag> 火车旅行体验 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>在线文本格式转换工具：JSON、XML、YAML等多格式一键转换</title>
      <link href="/2024/12/04/%E6%96%87%E6%9C%AC%E6%A0%BC%E5%BC%8F%E8%BD%AC%E6%8D%A2%E5%B7%A5%E5%85%B7-%E5%A4%9A%E6%A0%BC%E5%BC%8F%E4%BA%92%E8%BD%AC%E7%9A%84%E5%9C%A8%E7%BA%BF%E5%88%A9%E5%99%A8/"/>
      <url>/2024/12/04/%E6%96%87%E6%9C%AC%E6%A0%BC%E5%BC%8F%E8%BD%AC%E6%8D%A2%E5%B7%A5%E5%85%B7-%E5%A4%9A%E6%A0%BC%E5%BC%8F%E4%BA%92%E8%BD%AC%E7%9A%84%E5%9C%A8%E7%BA%BF%E5%88%A9%E5%99%A8/</url>
      
        <content type="html"><![CDATA[<h1 id="文本格式转换工具：多格式互转的在线利器"><a href="#文本格式转换工具：多格式互转的在线利器" class="headerlink" title="文本格式转换工具：多格式互转的在线利器"></a>文本格式转换工具：多格式互转的在线利器</h1><p>在线体验地址：<a href="https://textformat.cdtools.click/">https://textformat.cdtools.click</a></p><p><img src="https://cdn.jsdelivr.net/gh/houxiaozhao/imageLibrary@master/uPic/2024/12/04/ljhBXP.png" alt="ljhBXP"></p><p>在开发过程中，我们经常需要处理不同格式的数据文件，比如 JSON、XML、YAML 等。手动转换这些格式不仅耗时，还容易出错。为此，我们开发了这款在线文本格式转换工具，它能够帮助开发者快速、准确地在不同格式之间进行转换。</p><h2 id="功能特点"><a href="#功能特点" class="headerlink" title="功能特点"></a>功能特点</h2><h3 id="1-多格式支持"><a href="#1-多格式支持" class="headerlink" title="1. 多格式支持"></a>1. 多格式支持</h3><ul><li>JSON：最常用的数据交换格式</li><li>XML：广泛应用于配置文件和 Web 服务</li><li>YAML：易读性强，常用于配置文件</li><li>CSV：表格数据格式</li><li>TOML：简单易读的配置文件格式</li><li>Properties：Java 属性文件格式</li><li>INI：传统的配置文件格式</li></ul><h3 id="2-智能格式检测"><a href="#2-智能格式检测" class="headerlink" title="2. 智能格式检测"></a>2. 智能格式检测</h3><p>工具会自动检测输入文本的格式，无需手动指定源格式，让转换过程更加便捷。</p><h3 id="3-实时转换"><a href="#3-实时转换" class="headerlink" title="3. 实时转换"></a>3. 实时转换</h3><ul><li>输入文本后自动检测格式</li><li>选择目标格式后即时转换</li><li>转换结果实时显示</li></ul><h3 id="4-便捷操作"><a href="#4-便捷操作" class="headerlink" title="4. 便捷操作"></a>4. 便捷操作</h3><ul><li>一键格式化：规范化输入文本的格式</li><li>一键复制：快速复制转换结果</li><li>一键清空：清除输入区域内容</li></ul><h3 id="5-美观的界面"><a href="#5-美观的界面" class="headerlink" title="5. 美观的界面"></a>5. 美观的界面</h3><ul><li>支持深色&#x2F;浅色主题切换</li><li>代码高亮显示</li><li>响应式设计，适配各种屏幕尺寸</li></ul><p><img src="https://cdn.jsdelivr.net/gh/houxiaozhao/imageLibrary@master/uPic/2024/12/04/3hnFNs.png" alt="3hnFNs"></p><h2 id="使用指南"><a href="#使用指南" class="headerlink" title="使用指南"></a>使用指南</h2><ol><li><p><strong>输入文本</strong></p><ul><li>将需要转换的文本粘贴到左侧输入框</li><li>工具会自动检测文本格式</li><li>可以点击”格式化”按钮美化输入文本</li></ul></li><li><p><strong>选择目标格式</strong></p><ul><li>在右侧下拉菜单中选择想要转换的目标格式</li><li>支持的格式包括：JSON、XML、YAML、CSV、TOML、Properties、INI</li></ul></li><li><p><strong>获取结果</strong></p><ul><li>转换结果会实时显示在右侧区域</li><li>结果会自动进行语法高亮处理</li><li>点击”复制”按钮即可复制转换结果</li></ul></li><li><p><strong>格式化与清空</strong></p><ul><li>使用”格式化”按钮可以美化当前输入的文本</li><li>“清空”按钮可以快速清除输入区域的内容</li></ul></li><li><p><strong>主题切换</strong></p><ul><li>点击右上角的主题切换按钮（🌞&#x2F;🌙）</li><li>可以在浅色和深色主题之间切换</li><li>主题会自动保存，下次访问时保持一致</li></ul></li></ol><h2 id="使用场景"><a href="#使用场景" class="headerlink" title="使用场景"></a>使用场景</h2><ol><li><p><strong>开发调试</strong></p><ul><li>接口数据格式转换</li><li>配置文件格式迁移</li><li>数据结构验证</li></ul></li><li><p><strong>数据处理</strong></p><ul><li>配置文件格式转换</li><li>数据导入导出格式转换</li><li>日志数据格式化</li></ul></li><li><p><strong>文档编写</strong></p><ul><li>API 文档示例数据转换</li><li>技术文档中的数据格式转换</li><li>配置示例生成</li></ul></li></ol><h2 id="开源地址"><a href="#开源地址" class="headerlink" title="开源地址"></a>开源地址</h2><ul><li>GitHub: <a href="https://github.com/houxiaozhao/textFormatConversion">https://github.com/houxiaozhao/textFormatConversion</a></li></ul><hr><p>如果您在使用过程中遇到任何问题或有功能建议，欢迎通过 GitHub 提交 issue 或 PR。我们会持续优化工具的功能和使用体验。</p>]]></content>
      
      
      
        <tags>
            
            <tag> 在线工具 </tag>
            
            <tag> 开发工具 </tag>
            
            <tag> 文本转换 </tag>
            
            <tag> JSON转换 </tag>
            
            <tag> XML转换 </tag>
            
            <tag> YAML转换 </tag>
            
            <tag> CSV转换 </tag>
            
            <tag> 格式转换 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>静谧空间：专业的在线白噪声生成与环境音效平台</title>
      <link href="/2024/11/29/%E9%9D%99%E8%B0%A7%E7%A9%BA%E9%97%B4%E6%89%93%E9%80%A0%E6%82%A8%E7%9A%84%E4%B8%93%E5%B1%9E%E7%99%BD%E5%99%AA%E5%A3%B0%E7%8E%AF%E5%A2%83/"/>
      <url>/2024/11/29/%E9%9D%99%E8%B0%A7%E7%A9%BA%E9%97%B4%E6%89%93%E9%80%A0%E6%82%A8%E7%9A%84%E4%B8%93%E5%B1%9E%E7%99%BD%E5%99%AA%E5%A3%B0%E7%8E%AF%E5%A2%83/</url>
      
        <content type="html"><![CDATA[<h1 id="静谧空间：打造您的专属白噪声环境"><a href="#静谧空间：打造您的专属白噪声环境" class="headerlink" title="静谧空间：打造您的专属白噪声环境"></a>静谧空间：打造您的专属白噪声环境</h1><p>在这个喧嚣的世界里，我们常常需要一个宁静的空间来放松、专注或入眠。静谧空间应运而生，为您提供了一个简单而强大的白噪声生成工具，帮助您创造完美的声境环境。</p><h2 id="在线体验"><a href="#在线体验" class="headerlink" title="在线体验"></a>在线体验</h2><p><a href="https://peace.cdtools.click/">在线体验</a></p><p><img src="https://cdn.jsdelivr.net/gh/houxiaozhao/imageLibrary@master/uPic/2024/12/03/wuhzdA.png" alt="wuhzdA"></p><h2 id="主要功能"><a href="#主要功能" class="headerlink" title="主要功能"></a>主要功能</h2><h3 id="1-多种噪声类型"><a href="#1-多种噪声类型" class="headerlink" title="1. 多种噪声类型"></a>1. 多种噪声类型</h3><h4 id="白噪声"><a href="#白噪声" class="headerlink" title="白噪声"></a>白噪声</h4><ul><li>特点：所有频率功率均匀分布</li><li>声音特征：类似电视无信号时的沙沙声</li><li>适用场景：助眠、音频测试、掩盖背景噪声</li></ul><h4 id="粉噪声"><a href="#粉噪声" class="headerlink" title="粉噪声"></a>粉噪声</h4><ul><li>特点：每倍频程内能量相同，低频成分较强</li><li>声音特征：温暖的沙沙声，较为低沉</li><li>适用场景：助眠、音响调试、模拟自然环境声音</li></ul><h4 id="棕噪声"><a href="#棕噪声" class="headerlink" title="棕噪声"></a>棕噪声</h4><ul><li>特点：频率越低能量越强，每倍频程衰减 6dB</li><li>声音特征：深沉的轰鸣，类似瀑布声</li><li>适用场景：深度放松、掩盖低频噪声、创造沉浸感</li></ul><h3 id="2-智能定时功能"><a href="#2-智能定时功能" class="headerlink" title="2. 智能定时功能"></a>2. 智能定时功能</h3><ul><li>灵活设置：支持自定义时长，精确到分钟</li><li>快捷预设：提供常用时长快速选择</li><li>实时显示：清晰显示剩余时间</li><li>随时取消：一键停止定时功能</li></ul><h3 id="3-音量精确控制"><a href="#3-音量精确控制" class="headerlink" title="3. 音量精确控制"></a>3. 音量精确控制</h3><ul><li>独立调节：每种噪声类型都可以单独调节音量</li><li>百分比显示：直观显示当前音量大小</li><li>实时响应：音量调节即时生效</li></ul><h2 id="使用指南"><a href="#使用指南" class="headerlink" title="使用指南"></a>使用指南</h2><ol><li><p><strong>选择噪声类型</strong></p><ul><li>点击对应的噪声卡片启动&#x2F;停止播放</li><li>可以同时播放多种噪声，创造独特的声音环境</li></ul></li><li><p><strong>调节音量</strong></p><ul><li>使用滑块调节各个噪声的音量</li><li>建议从低音量开始，逐步调整到舒适水平</li></ul></li><li><p><strong>设置定时</strong></p><ul><li>直接输入所需分钟数，或使用预设时间</li><li>点击”开始计时”启动定时功能</li><li>需要时可随时取消定时</li></ul></li></ol><h2 id="使用场景"><a href="#使用场景" class="headerlink" title="使用场景"></a>使用场景</h2><ul><li><strong>工作专注</strong>：使用白噪声掩盖办公环境的干扰声</li><li><strong>睡眠辅助</strong>：选择粉噪声或棕噪声创造舒适的睡眠环境</li><li><strong>冥想放松</strong>：使用任意噪声类型，配合定时功能进行冥想练习</li><li><strong>学习环境</strong>：营造稳定的背景音，提高学习效率</li></ul><h2 id="开源信息"><a href="#开源信息" class="headerlink" title="开源信息"></a>开源信息</h2><p>本项目完全开源，欢迎访问我们的代码仓库：<br><a href="https://github.com/houxiaozhao/whiteNoise">GitHub 仓库地址</a></p><h2 id="反馈与建议"><a href="#反馈与建议" class="headerlink" title="反馈与建议"></a>反馈与建议</h2><p>如果您在使用过程中有任何问题或建议，欢迎通过以下方式联系我们：</p><ul><li>在 GitHub 仓库提交 Issue</li></ul><hr><p>希望静谧空间能够为您的生活带来一份宁静与专注。</p>]]></content>
      
      
      <categories>
          
          <category> 在线工具 </category>
          
          <category> 音频处理 </category>
          
          <category> 健康工具 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 白噪声 </tag>
            
            <tag> 环境音效 </tag>
            
            <tag> 助眠工具 </tag>
            
            <tag> 专注力 </tag>
            
            <tag> 噪声生成器 </tag>
            
            <tag> 放松工具 </tag>
            
            <tag> 冥想辅助 </tag>
            
            <tag> 声音环境 </tag>
            
            <tag> 音频工具 </tag>
            
            <tag> 睡眠改善 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>在线图片切片工具：专业的九宫格切图与图片分割平台</title>
      <link href="/2024/11/28/%E5%9B%BE%E7%89%87%E5%88%87%E7%89%87%E5%B7%A5%E5%85%B7%E5%85%8D%E8%B4%B9%E5%9C%A8%E7%BA%BF%E4%B9%9D%E5%AE%AB%E6%A0%BC%E5%88%87%E5%9B%BE%E5%B7%A5%E5%85%B7/"/>
      <url>/2024/11/28/%E5%9B%BE%E7%89%87%E5%88%87%E7%89%87%E5%B7%A5%E5%85%B7%E5%85%8D%E8%B4%B9%E5%9C%A8%E7%BA%BF%E4%B9%9D%E5%AE%AB%E6%A0%BC%E5%88%87%E5%9B%BE%E5%B7%A5%E5%85%B7/</url>
      
        <content type="html"><![CDATA[<h1 id="图片切片工具：免费在线九宫格切图工具"><a href="#图片切片工具：免费在线九宫格切图工具" class="headerlink" title="图片切片工具：免费在线九宫格切图工具"></a>图片切片工具：免费在线九宫格切图工具</h1><blockquote><p>在线使用地址：<a href="https://cut.cdtools.click/">https://cut.cdtools.click</a></p></blockquote><p>一款完全免费的在线图片切片工具，专为社交媒体九宫格分割设计。无需下载安装任何软件，打开网页即可使用。</p><h2 id="🌟-产品特点"><a href="#🌟-产品特点" class="headerlink" title="🌟 产品特点"></a>🌟 产品特点</h2><ul><li><strong>完全免费</strong>：永久免费使用，没有任何收费项目</li><li><strong>保护隐私</strong>：所有图片处理都在本地完成，不会上传到服务器</li><li><strong>无限制</strong>：支持任意大小的图片文件，无文件大小限制</li><li><strong>批量处理</strong>：可同时处理多张图片，无数量限制</li><li><strong>暗黑模式</strong>：支持明暗两种主题切换，保护眼睛</li><li><strong>移动适配</strong>：完美支持手机端操作，随时随地使用</li></ul><h2 id="📱-功能展示"><a href="#📱-功能展示" class="headerlink" title="📱 功能展示"></a>📱 功能展示</h2><p><img src="https://cdn.jsdelivr.net/gh/houxiaozhao/imageLibrary@master/uPic/2024/12/03/uKk1e7.png" alt="uKk1e7"></p><h2 id="🚀-使用方法"><a href="#🚀-使用方法" class="headerlink" title="🚀 使用方法"></a>🚀 使用方法</h2><h3 id="1-上传图片"><a href="#1-上传图片" class="headerlink" title="1. 上传图片"></a>1. 上传图片</h3><ul><li>直接拖拽图片到上传区域</li><li>或点击上传区域选择图片文件</li><li>支持同时上传多张图片</li></ul><h3 id="2-设置切片参数"><a href="#2-设置切片参数" class="headerlink" title="2. 设置切片参数"></a>2. 设置切片参数</h3><ul><li>选择切片的行数（1-10 行）</li><li>选择切片的列数（1-10 列）</li><li>实时预览切片效果</li></ul><h3 id="3-导出切片"><a href="#3-导出切片" class="headerlink" title="3. 导出切片"></a>3. 导出切片</h3><ul><li>点击”导出切片”按钮</li><li>自动将所有切片打包成 zip 文件下载</li><li>每张图片的切片会单独存放在以原图命名的文件夹中</li></ul><h2 id="💡-使用场景"><a href="#💡-使用场景" class="headerlink" title="💡 使用场景"></a>💡 使用场景</h2><ol><li><p><strong>社交媒体九宫格</strong></p><ul><li>朋友圈九宫格发图</li><li>Instagram 九宫格排版</li><li>微博多图分割</li></ul></li><li><p><strong>长图切割</strong></p><ul><li>将长图分割成等大小的多张图片</li><li>适合分享长截图或长图文</li></ul></li><li><p><strong>图片拼图素材</strong></p><ul><li>将大图切割成小块用于拼图</li><li>自定义行列数制作特殊效果</li></ul></li></ol><h2 id="🎯-特色功能"><a href="#🎯-特色功能" class="headerlink" title="🎯 特色功能"></a>🎯 特色功能</h2><ul><li><strong>实时预览</strong>：调整参数时可以实时看到切割效果</li><li><strong>批量处理</strong>：一次性处理多张图片，提高效率</li><li><strong>自定义网格</strong>：最高支持 10x10 的网格划分</li><li><strong>文件命名</strong>：导出的切片会自动按顺序编号，方便使用</li><li><strong>暗色模式</strong>：支持浅色&#x2F;深色主题切换，减少夜间使用时的眼疲劳</li></ul><h2 id="🔗-相关链接"><a href="#🔗-相关链接" class="headerlink" title="🔗 相关链接"></a>🔗 相关链接</h2><ul><li>在线使用：<a href="https://cut.cdtools.click/">https://cut.cdtools.click</a></li><li>开源地址：<a href="https://github.com/houxiaozhao/cutimage">https://github.com/houxiaozhao/cutimage</a></li></ul>]]></content>
      
      
      <categories>
          
          <category> 在线工具 </category>
          
          <category> 图像处理 </category>
          
          <category> 社交媒体工具 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 图片处理 </tag>
            
            <tag> 在线工具 </tag>
            
            <tag> 免费工具 </tag>
            
            <tag> 批量处理 </tag>
            
            <tag> 图片切片 </tag>
            
            <tag> 九宫格切图 </tag>
            
            <tag> 图片分割 </tag>
            
            <tag> 社交媒体 </tag>
            
            <tag> 长图切割 </tag>
            
            <tag> 拼图工具 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>免费在线图片压缩工具：专业的批量图片优化与压缩平台</title>
      <link href="/2024/11/25/%E5%85%8D%E8%B4%B9%E5%9C%A8%E7%BA%BF%E5%9B%BE%E7%89%87%E5%8E%8B%E7%BC%A9%E5%B7%A5%E5%85%B7/"/>
      <url>/2024/11/25/%E5%85%8D%E8%B4%B9%E5%9C%A8%E7%BA%BF%E5%9B%BE%E7%89%87%E5%8E%8B%E7%BC%A9%E5%B7%A5%E5%85%B7/</url>
      
        <content type="html"><![CDATA[<h1 id="免费在线图片压缩工具-CDTools"><a href="#免费在线图片压缩工具-CDTools" class="headerlink" title="免费在线图片压缩工具 - CDTools"></a>免费在线图片压缩工具 - CDTools</h1><blockquote><p>一款完全免费的在线图片压缩工具，无需下载软件，支持批量处理，保护隐私安全。</p></blockquote><p>在线体验地址：<a href="https://compress.cdtools.click/">https://compress.cdtools.click/</a></p><p><img src="https://cdn.jsdelivr.net/gh/houxiaozhao/imageLibrary@master/uPic/2024/12/03/oRGcTs.png" alt="oRGcTs"></p><h2 id="主要功能"><a href="#主要功能" class="headerlink" title="主要功能"></a>主要功能</h2><h3 id="1-多种压缩预设模式"><a href="#1-多种压缩预设模式" class="headerlink" title="1. 多种压缩预设模式"></a>1. 多种压缩预设模式</h3><p>工具提供三种预设压缩模式，满足不同场景需求：</p><ul><li><p><strong>高质量模式</strong>：保持较高图片质量，适合需要清晰度的场景</p><ul><li>压缩质量：80%</li><li>保留原始尺寸</li><li>保留 EXIF 信息</li></ul></li><li><p><strong>平衡模式</strong>（推荐）：平衡压缩率和质量，适合大多数场景</p><ul><li>压缩质量：60%</li><li>最大尺寸：2048x2048</li><li>移除 EXIF 信息</li></ul></li><li><p><strong>高压缩模式</strong>：优先考虑文件大小，适合需要快速传输的场景</p><ul><li>压缩质量：40%</li><li>最大尺寸：1024x1024</li><li>移除 EXIF 信息</li></ul></li></ul><h3 id="2-自定义压缩参数"><a href="#2-自定义压缩参数" class="headerlink" title="2. 自定义压缩参数"></a>2. 自定义压缩参数</h3><p>除了预设模式外，还可以根据需求自定义压缩参数：</p><ul><li>压缩质量（1-100%）</li><li>最大宽度限制</li><li>最大高度限制</li><li>是否保留 EXIF 信息</li></ul><h3 id="3-批量处理能力"><a href="#3-批量处理能力" class="headerlink" title="3. 批量处理能力"></a>3. 批量处理能力</h3><ul><li>支持同时选择或拖拽多张图片</li><li>支持 JPG、PNG 等常见图片格式</li><li>单个文件大小限制：20MB</li><li>批量压缩自动下载</li></ul><h3 id="4-便捷的预览功能"><a href="#4-便捷的预览功能" class="headerlink" title="4. 便捷的预览功能"></a>4. 便捷的预览功能</h3><ul><li>原图&#x2F;压缩后对比预览</li><li>实时压缩进度显示</li><li>压缩比例计算</li><li>文件大小显示</li></ul><h3 id="5-其他特色"><a href="#5-其他特色" class="headerlink" title="5. 其他特色"></a>5. 其他特色</h3><ul><li>深色模式支持</li><li>无需注册登录</li><li>完全免费使用</li><li>本地压缩，保护隐私</li><li>支持离线使用</li></ul><h2 id="使用说明"><a href="#使用说明" class="headerlink" title="使用说明"></a>使用说明</h2><ol><li>打开工具网站：<a href="https://compress.cdtools.click/">https://compress.cdtools.click/</a></li><li>选择压缩模式或自定义参数</li><li>点击”选择图片”或直接拖拽图片到指定区域</li><li>等待压缩完成，文件会自动下载</li><li>可以在预览区查看压缩效果</li></ol><h2 id="注意事项"><a href="#注意事项" class="headerlink" title="注意事项"></a>注意事项</h2><ul><li>建议使用现代浏览器（Chrome、Firefox、Safari 等）以获得最佳体验</li><li>如果对图片质量要求较高，建议使用”高质量”预设或适当调高压缩质量参数</li></ul>]]></content>
      
      
      <categories>
          
          <category> 在线工具 </category>
          
          <category> 图像处理 </category>
          
          <category> 效率工具 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 图片处理 </tag>
            
            <tag> 在线工具 </tag>
            
            <tag> 免费工具 </tag>
            
            <tag> 图片压缩 </tag>
            
            <tag> 批量处理 </tag>
            
            <tag> 图像优化 </tag>
            
            <tag> 无损压缩 </tag>
            
            <tag> 网站优化 </tag>
            
            <tag> 图片转换 </tag>
            
            <tag> 图像质量 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Cron表达式在线工具：专业的定时任务表达式生成与解析平台</title>
      <link href="/2024/11/22/Cron%E8%A1%A8%E8%BE%BE%E5%BC%8F%E5%9C%A8%E7%BA%BF%E5%B7%A5%E5%85%B7/"/>
      <url>/2024/11/22/Cron%E8%A1%A8%E8%BE%BE%E5%BC%8F%E5%9C%A8%E7%BA%BF%E5%B7%A5%E5%85%B7/</url>
      
        <content type="html"><![CDATA[<h1 id="Cron-表达式在线工具：轻松创建和解析定时任务"><a href="#Cron-表达式在线工具：轻松创建和解析定时任务" class="headerlink" title="Cron 表达式在线工具：轻松创建和解析定时任务"></a>Cron 表达式在线工具：轻松创建和解析定时任务</h1><blockquote><p>在线体验地址：<a href="https://cron.cdtools.click/">https://cron.cdtools.click</a></p></blockquote><p><img src="https://cdn.jsdelivr.net/gh/houxiaozhao/imageLibrary@master/uPic/2024/12/03/zdbNNT.png" alt="zdbNNT"></p><p>在日常工作中，我们经常需要设置定时任务，而 Cron 表达式就是定义这些任务执行时间的关键。但是，Cron 表达式的语法较为复杂，不同平台的格式也略有差异。为了解决这个问题，我们推出了这款在线 Cron 表达式工具，帮助您轻松创建和理解 Cron 表达式。</p><h2 id="核心功能"><a href="#核心功能" class="headerlink" title="核心功能"></a>核心功能</h2><h3 id="1-多格式支持"><a href="#1-多格式支持" class="headerlink" title="1. 多格式支持"></a>1. 多格式支持</h3><p>工具支持目前主流的三种 Cron 格式：</p><ul><li>Crontab 格式（Linux 系统默认格式）</li><li>Quartz 格式（Java Quartz 调度器使用的格式）</li><li>Spring 格式（Spring Framework 中使用的格式）</li></ul><h3 id="2-可视化配置"><a href="#2-可视化配置" class="headerlink" title="2. 可视化配置"></a>2. 可视化配置</h3><p>无需记忆复杂的语法规则，通过直观的界面即可配置：</p><ul><li>分钟选择（0-59）</li><li>小时选择（0-23）</li><li>日期选择（1-31）</li><li>月份选择（1-12）</li><li>星期选择（0-7）</li></ul><h3 id="3-人性化解释"><a href="#3-人性化解释" class="headerlink" title="3. 人性化解释"></a>3. 人性化解释</h3><p>工具会自动将 Cron 表达式转换为人类易读的文字说明，让您一目了然表达式的含义。例如：</p><ul><li>“每周一至周五的上午 9 点执行”</li><li>“每月 1 日和 15 日的凌晨 0 点执行”</li></ul><h3 id="4-执行时间预测"><a href="#4-执行时间预测" class="headerlink" title="4. 执行时间预测"></a>4. 执行时间预测</h3><p>为了帮助您验证表达式是否符合预期，工具会自动计算并显示：</p><ul><li>下次执行时间</li><li>未来多次执行时间点列表</li></ul><h3 id="5-便捷操作"><a href="#5-便捷操作" class="headerlink" title="5. 便捷操作"></a>5. 便捷操作</h3><ul><li>一键复制：快速复制生成的 Cron 表达式</li><li>语言切换：支持中英文双语界面</li><li>响应式设计：完美适配移动端和桌面端</li></ul><h2 id="使用场景"><a href="#使用场景" class="headerlink" title="使用场景"></a>使用场景</h2><ol><li><p><strong>定时备份</strong></p><ul><li>设置每日凌晨自动备份数据库</li><li>配置周末定期备份文件</li></ul></li><li><p><strong>系统维护</strong></p><ul><li>设置服务器定时重启时间</li><li>配置日志定期清理任务</li></ul></li><li><p><strong>定时通知</strong></p><ul><li>工作日每天早上的例会提醒</li><li>每月固定日期的报告提醒</li></ul></li><li><p><strong>数据统计</strong></p><ul><li>每小时的数据统计任务</li><li>每月月底的报表生成任务</li></ul></li></ol><h2 id="使用小贴士"><a href="#使用小贴士" class="headerlink" title="使用小贴士"></a>使用小贴士</h2><ol><li>使用前建议先选择合适的 Cron 格式（Crontab&#x2F;Quartz&#x2F;Spring）</li><li>可以通过可视化界面或直接编辑表达式两种方式来创建</li><li>生成表达式后，建议查看执行时间预测，确保符合预期</li><li>不确定表达式含义时，可以参考人性化解释</li></ol><h2 id="开源地址"><a href="#开源地址" class="headerlink" title="开源地址"></a>开源地址</h2><ul><li>GitHub: <a href="https://github.com/houxiaozhao/cron">https://github.com/houxiaozhao/cron</a></li></ul>]]></content>
      
      
      <categories>
          
          <category> 开发工具 </category>
          
          <category> 系统运维 </category>
          
          <category> 在线工具 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 在线工具 </tag>
            
            <tag> Cron表达式 </tag>
            
            <tag> 定时任务 </tag>
            
            <tag> Linux工具 </tag>
            
            <tag> Quartz调度 </tag>
            
            <tag> Spring定时 </tag>
            
            <tag> 任务调度 </tag>
            
            <tag> 系统运维 </tag>
            
            <tag> 开发辅助 </tag>
            
            <tag> 时间管理 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>在线学生证照片生成器：专业的证件照制作与编辑工具</title>
      <link href="/2024/11/18/%E5%AD%A6%E7%94%9F%E8%AF%81%E7%85%A7%E7%89%87%E7%94%9F%E6%88%90%E5%99%A8/"/>
      <url>/2024/11/18/%E5%AD%A6%E7%94%9F%E8%AF%81%E7%85%A7%E7%89%87%E7%94%9F%E6%88%90%E5%99%A8/</url>
      
        <content type="html"><![CDATA[<h1 id="学生证照片生成器"><a href="#学生证照片生成器" class="headerlink" title="学生证照片生成器"></a>学生证照片生成器</h1><blockquote><p>在线体验：<a href="https://studentid.cdtools.click/">https://studentid.cdtools.click</a><br><img src="https://cdn.jsdelivr.net/gh/houxiaozhao/imageLibrary@master/uPic/2024/12/03/keeBNS.png" alt="keeBNS"></p></blockquote><p>一款简单易用的在线学生证照片生成工具，支持自定义学生信息、照片上传、实时预览和高清导出。无需安装任何软件，打开网页即可使用。</p><h2 id="✨-主要功能"><a href="#✨-主要功能" class="headerlink" title="✨ 主要功能"></a>✨ 主要功能</h2><h3 id="1-多样化的卡片模板"><a href="#1-多样化的卡片模板" class="headerlink" title="1. 多样化的卡片模板"></a>1. 多样化的卡片模板</h3><p>提供三种精美的卡片模板供选择：</p><ul><li>经典模板：传统简约风格</li><li>科技感模板：现代动感设计</li><li>简约风格：清新淡雅布局</li></ul><h3 id="2-完全自定义的信息填写"><a href="#2-完全自定义的信息填写" class="headerlink" title="2. 完全自定义的信息填写"></a>2. 完全自定义的信息填写</h3><p>支持自定义以下信息：</p><ul><li>姓名</li><li>学号</li><li>学校名称</li><li>院系</li><li>专业</li><li>有效期</li><li>个人照片</li><li>学校校徽（可选）</li></ul><h3 id="3-丰富的背景选择"><a href="#3-丰富的背景选择" class="headerlink" title="3. 丰富的背景选择"></a>3. 丰富的背景选择</h3><p>内置多种背景供选择：</p><ul><li>木纹背景</li><li>大理石背景</li><li>白色背景</li><li>深色木纹背景</li><li>支持上传自定义背景图</li></ul><h3 id="4-实时预览"><a href="#4-实时预览" class="headerlink" title="4. 实时预览"></a>4. 实时预览</h3><ul><li>支持 3D 旋转预览</li><li>实时渲染效果</li><li>所见即所得的编辑体验</li></ul><h2 id="📝-使用说明"><a href="#📝-使用说明" class="headerlink" title="📝 使用说明"></a>📝 使用说明</h2><ol><li><p><strong>选择模板</strong></p><ul><li>打开网页后，首先在顶部选择喜欢的卡片模板</li><li>可以随时切换不同模板查看效果</li></ul></li><li><p><strong>填写信息</strong></p><ul><li>在左侧表单中填写个人信息</li><li>所有带星号(*)的字段为必填项</li><li>填写完一项后会自动更新预览效果</li></ul></li><li><p><strong>上传照片</strong></p><ul><li>点击”照片”栏的上传按钮</li><li>选择本地照片文件（支持 jpg、png 格式）</li><li>推荐使用正面免冠照片</li><li>照片会自动调整至合适大小</li></ul></li><li><p><strong>上传校徽（可选）</strong></p><ul><li>如需添加学校校徽，点击”校徽”栏上传</li><li>建议使用透明背景的 PNG 格式校徽</li><li>校徽会以水印形式显示在卡片上</li></ul></li><li><p><strong>选择背景</strong></p><ul><li>在背景选项中选择喜欢的背景样式</li><li>如选择”自定义背景”，可上传本地图片</li><li>背景会自动调整以适配卡片大小</li></ul></li><li><p><strong>预览与下载</strong></p><ul><li>右侧预览区可以 360 度旋转查看效果</li><li>确认效果满意后，点击”下载图片”</li><li>图片将以 PNG 格式保存到本地</li></ul></li></ol><h2 id="🌍-多语言支持"><a href="#🌍-多语言支持" class="headerlink" title="🌍 多语言支持"></a>🌍 多语言支持</h2><ul><li>支持中文界面</li><li>Support English interface</li><li>点击右上角语言按钮切换</li></ul><h2 id="开源地址"><a href="#开源地址" class="headerlink" title="开源地址"></a>开源地址</h2><ul><li>GitHub: <a href="https://github.com/houxiaozhao/studentid">https://github.com/houxiaozhao/studentid</a></li></ul><hr><p>如果您觉得这个工具对您有帮助，欢迎分享给更多的人！</p>]]></content>
      
      
      <categories>
          
          <category> 在线工具 </category>
          
          <category> 图像处理 </category>
          
          <category> 教育工具 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 图片处理 </tag>
            
            <tag> 在线工具 </tag>
            
            <tag> 学生证照片 </tag>
            
            <tag> 证件照制作 </tag>
            
            <tag> 照片编辑 </tag>
            
            <tag> 学生证明 </tag>
            
            <tag> 证件模板 </tag>
            
            <tag> 自定义模板 </tag>
            
            <tag> 高清导出 </tag>
            
            <tag> 实时预览 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>图片转Excel像素艺术：专业的在线表格艺术创作工具</title>
      <link href="/2024/11/15/%E5%9B%BE%E7%89%87%E8%BD%ACExcel%E8%89%BA%E6%9C%AF%E8%BD%BB%E6%9D%BE%E5%88%9B%E5%BB%BA%E5%83%8F%E7%B4%A0%E9%A3%8E%E6%A0%BC%E8%A1%A8%E6%A0%BC%E8%89%BA%E6%9C%AF/"/>
      <url>/2024/11/15/%E5%9B%BE%E7%89%87%E8%BD%ACExcel%E8%89%BA%E6%9C%AF%E8%BD%BB%E6%9D%BE%E5%88%9B%E5%BB%BA%E5%83%8F%E7%B4%A0%E9%A3%8E%E6%A0%BC%E8%A1%A8%E6%A0%BC%E8%89%BA%E6%9C%AF/</url>
      
        <content type="html"><![CDATA[<h1 id="图片转-Excel-艺术：轻松创建像素风格表格艺术"><a href="#图片转-Excel-艺术：轻松创建像素风格表格艺术" class="headerlink" title="图片转 Excel 艺术：轻松创建像素风格表格艺术"></a>图片转 Excel 艺术：轻松创建像素风格表格艺术</h1><p>在线体验地址：<a href="https://img2excel.cdtools.click/">https://img2excel.cdtools.click</a></p><blockquote><p>一款免费的在线工具，可以将任意图片转换成 Excel 像素艺术作品，支持多种图片调整参数，让你轻松创作独特的表格艺术。</p></blockquote><h2 id="功能特色"><a href="#功能特色" class="headerlink" title="功能特色"></a>功能特色</h2><h3 id="1-简单易用的操作界面"><a href="#1-简单易用的操作界面" class="headerlink" title="1. 简单易用的操作界面"></a>1. 简单易用的操作界面</h3><p><img src="https://cdn.jsdelivr.net/gh/houxiaozhao/imageLibrary@master/uPic/2024/12/03/DwUtgW.png" alt="DwUtgW"><br><img src="https://cdn.jsdelivr.net/gh/houxiaozhao/imageLibrary@master/uPic/2024/12/03/90HuBn.png" alt="90HuBn"></p><ul><li>清晰的拖拽上传区域</li><li>实时预览功能</li><li>直观的参数调整面板</li></ul><h3 id="2-强大的图片调整功能"><a href="#2-强大的图片调整功能" class="headerlink" title="2. 强大的图片调整功能"></a>2. 强大的图片调整功能</h3><p><img src="https://cdn.jsdelivr.net/gh/houxiaozhao/imageLibrary@master/uPic/2024/12/03/xydc98.png" alt="xydc98"></p><ul><li><strong>亮度调整</strong>：-100 到 100 的范围调节，让图片更明亮或更暗淡</li><li><strong>对比度</strong>：-100 到 100 的范围调节，增强或减弱图片的层次感</li><li><strong>饱和度</strong>：-100 到 100 的范围调节，调整色彩的鲜艳程度</li><li><strong>色调</strong>：-180 到 180 度的范围调节，改变图片的整体色相</li></ul><h3 id="3-灵活的-Excel-输出设置"><a href="#3-灵活的-Excel-输出设置" class="headerlink" title="3. 灵活的 Excel 输出设置"></a>3. 灵活的 Excel 输出设置</h3><p><img src="https://cdn.jsdelivr.net/gh/houxiaozhao/imageLibrary@master/uPic/2024/12/03/3UPOMU.png" alt="3UPOMU"></p><ul><li><strong>像素密度控制</strong>：最大像素数可在 10-200 之间自由设置</li><li><strong>单元格样式定制</strong>：<ul><li>自定义单元格大小</li><li>多种边框样式选择</li><li>边框颜色自定义</li><li>工作表背景色设置</li><li>Excel 打开时的缩放比例调整</li></ul></li></ul><h2 id="使用指南"><a href="#使用指南" class="headerlink" title="使用指南"></a>使用指南</h2><h3 id="第一步：上传图片"><a href="#第一步：上传图片" class="headerlink" title="第一步：上传图片"></a>第一步：上传图片</h3><ol><li>打开工具网页</li><li>点击上传区域或直接拖拽图片到指定区域</li><li>图片上传后会立即显示预览效果</li></ol><h3 id="第二步：调整参数"><a href="#第二步：调整参数" class="headerlink" title="第二步：调整参数"></a>第二步：调整参数</h3><ol><li><p><strong>图片效果调整</strong></p><ul><li>使用滑块调整亮度使图片更通透</li><li>适当增加对比度提升层次感</li><li>调整饱和度改变色彩表现</li><li>用色调创造特殊的艺术效果</li></ul></li><li><p><strong>Excel 输出设置</strong></p><ul><li>设定合适的像素数（建议 50-100 之间）</li><li>选择你喜欢的边框样式</li><li>调整单元格大小获得最佳显示效果</li></ul></li></ol><h3 id="第三步：生成作品"><a href="#第三步：生成作品" class="headerlink" title="第三步：生成作品"></a>第三步：生成作品</h3><ol><li>点击”生成 Excel 文件”按钮</li><li>等待文件生成（大图可能需要较长时间）</li><li>文件会自动下载到你的电脑</li></ol><h2 id="使用技巧"><a href="#使用技巧" class="headerlink" title="使用技巧"></a>使用技巧</h2><ol><li><p><strong>选择合适的图片</strong></p><ul><li>建议使用对比度较强的图片</li><li>简单的图案或标志效果更好</li><li>避免细节过多的复杂图片</li></ul></li><li><p><strong>参数调整建议</strong></p><ul><li>先调整最大像素数确定整体大小</li><li>对比度建议适当提高</li><li>可以用色调创造特殊的艺术效果</li></ul></li><li><p><strong>Excel 文件处理</strong></p><ul><li>生成的文件可以用 Excel 直接打开</li><li>可以进一步在 Excel 中修改调整</li><li>建议将文件另存为较新版本的 Excel 格式</li></ul></li></ol><h2 id="注意事项"><a href="#注意事项" class="headerlink" title="注意事项"></a>注意事项</h2><ul><li>像素数越大，生成时间越长，文件也越大</li><li>建议从小像素数开始尝试，找到最适合的设置</li><li>某些特殊的边框样式在旧版 Excel 中可能显示异常</li></ul><hr><p>有了这个工具，你可以轻松将喜欢的图片转换成独特的 Excel 艺术作品。无论是制作个性化的表格，还是创作像素风格的艺术品，它都能帮你实现。快来试试吧！</p>]]></content>
      
      
      <categories>
          
          <category> 创意工具 </category>
          
          <category> 图像处理 </category>
          
          <category> Excel应用 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 在线工具 </tag>
            
            <tag> 图片转换 </tag>
            
            <tag> 图像处理 </tag>
            
            <tag> Excel艺术 </tag>
            
            <tag> 像素艺术 </tag>
            
            <tag> 表格设计 </tag>
            
            <tag> 创意设计 </tag>
            
            <tag> 艺术创作 </tag>
            
            <tag> 数据可视化 </tag>
            
            <tag> 办公软件应用 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CloudflareIP优选工具轻松找到最快的CDN节点</title>
      <link href="/2024/11/14/CloudflareIP%E4%BC%98%E9%80%89%E5%B7%A5%E5%85%B7%E8%BD%BB%E6%9D%BE%E6%89%BE%E5%88%B0%E6%9C%80%E5%BF%AB%E7%9A%84CDN%E8%8A%82%E7%82%B9/"/>
      <url>/2024/11/14/CloudflareIP%E4%BC%98%E9%80%89%E5%B7%A5%E5%85%B7%E8%BD%BB%E6%9D%BE%E6%89%BE%E5%88%B0%E6%9C%80%E5%BF%AB%E7%9A%84CDN%E8%8A%82%E7%82%B9/</url>
      
        <content type="html"><![CDATA[<h1 id="Cloudflare-IP-优选工具：轻松找到最快的-CDN-节点"><a href="#Cloudflare-IP-优选工具：轻松找到最快的-CDN-节点" class="headerlink" title="Cloudflare IP 优选工具：轻松找到最快的 CDN 节点"></a>Cloudflare IP 优选工具：轻松找到最快的 CDN 节点</h1><blockquote><p>在线体验地址：<a href="https://cf-ip.cdtools.click/">https://cf-ip.cdtools.click</a></p></blockquote><p><img src="https://cdn.jsdelivr.net/gh/houxiaozhao/imageLibrary@master/uPic/2024/12/03/zdYU2v.png" alt="zdYU2v"><br><img src="https://cdn.jsdelivr.net/gh/houxiaozhao/imageLibrary@master/uPic/2024/12/03/ZOZqBh.png" alt="ZOZqBh"></p><h2 id="功能介绍"><a href="#功能介绍" class="headerlink" title="功能介绍"></a>功能介绍</h2><p>Cloudflare IP 优选工具是一个专门用于测试和筛选 Cloudflare CDN 节点的在线服务。它能够帮助用户找到最适合自己的 Cloudflare IP 地址，从而获得更好的网络访问体验。</p><h3 id="核心功能"><a href="#核心功能" class="headerlink" title="核心功能"></a>核心功能</h3><ol><li><p><strong>全自动 IP 测速</strong></p><ul><li>自动测试多个 Cloudflare CDN 节点</li><li>每小时自动更新测试结果</li><li>按照延迟时间从低到高排序展示</li></ul></li><li><p><strong>全面的性能指标</strong></p><ul><li>IP 地址信息</li><li>数据包发送和接收统计</li><li>丢包率分析</li><li>网络延迟数据</li><li>实际下载速度测试</li></ul></li><li><p><strong>便捷的数据展示</strong></p><ul><li>清晰的表格形式展示测试结果</li><li>直观的性能指标对比</li><li>简洁的界面设计</li></ul></li></ol><h2 id="使用说明"><a href="#使用说明" class="headerlink" title="使用说明"></a>使用说明</h2><ol><li><p>打开工具网站 <a href="https://cf-ip.cdtools.click/">https://cf-ip.cdtools.click</a></p></li><li><p>查看最新的测速结果表格，其中包含：</p><ul><li>IP 地址列：显示具体的 Cloudflare CDN 节点 IP</li><li>已发送&#x2F;已接收列：展示测试过程中的数据包统计</li><li>丢包率列：显示节点的稳定性指标</li><li>平均延迟列：展示网络访问的响应速度</li><li>下载速度列：显示实际的数据传输速率（MB&#x2F;s）</li></ul></li><li><p>根据自己的需求选择合适的 IP：</p><ul><li>追求低延迟：选择平均延迟最低的 IP</li><li>重视稳定性：选择丢包率低的 IP</li><li>需要大文件传输：关注下载速度较高的 IP</li></ul></li></ol><h2 id="特色优势"><a href="#特色优势" class="headerlink" title="特色优势"></a>特色优势</h2><ul><li>🚀 全自动化测试，无需手动操作</li><li>📊 多维度性能数据展示</li><li>🔄 每小时更新，确保数据时效性</li><li>📱 支持移动设备访问</li><li>🎯 直观的数据排序，方便选择</li></ul><h2 id="开源地址"><a href="#开源地址" class="headerlink" title="开源地址"></a>开源地址</h2><p>本项目基于 <a href="https://github.com/XIU2/CloudflareSpeedTest">XIU2&#x2F;CloudflareSpeedTest</a> 开发。</p>]]></content>
      
      
      <categories>
          
          <category> 网络优化 </category>
          
          <category> CDN加速 </category>
          
          <category> 性能测试 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Cloudflare </tag>
            
            <tag> CDN </tag>
            
            <tag> IP优选 </tag>
            
            <tag> 网络优化 </tag>
            
            <tag> 性能测试 </tag>
            
            <tag> 网站加速 </tag>
            
            <tag> 延迟测试 </tag>
            
            <tag> 自动化工具 </tag>
            
            <tag> 网络监控 </tag>
            
            <tag> 速度优化 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>WGS-84至CGCS2000坐标转换器</title>
      <link href="/2024/11/12/WGS-84%E8%87%B3CGCS2000%E5%9D%90%E6%A0%87%E8%BD%AC%E6%8D%A2%E5%99%A8/"/>
      <url>/2024/11/12/WGS-84%E8%87%B3CGCS2000%E5%9D%90%E6%A0%87%E8%BD%AC%E6%8D%A2%E5%99%A8/</url>
      
        <content type="html"><![CDATA[<h1 id="WGS-84-与-CGCS2000-在线坐标转换工具"><a href="#WGS-84-与-CGCS2000-在线坐标转换工具" class="headerlink" title="WGS-84 与 CGCS2000 在线坐标转换工具"></a>WGS-84 与 CGCS2000 在线坐标转换工具</h1><h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h2><p>这是一个在线的坐标转换工具，可以实现 WGS-84 与 CGCS2000 坐标系统之间的相互转换。该工具支持批量转换，提供了友好的用户界面，并且完全免费使用。</p><p>在线使用地址：<a href="https://cgcs2000.cdtools.click/">https://cgcs2000.cdtools.click</a><br><img src="https://cdn.jsdelivr.net/gh/houxiaozhao/imageLibrary@master/uPic/2024/12/03/0ru9Eu.png" alt="0ru9Eu"></p><h2 id="功能特点"><a href="#功能特点" class="headerlink" title="功能特点"></a>功能特点</h2><ol><li><p><strong>双向转换</strong></p><ul><li>WGS-84 转 CGCS2000</li><li>CGCS2000 转 WGS-84</li></ul></li><li><p><strong>自动分带</strong></p><ul><li>根据输入的经度自动计算 3 度带号</li><li>支持从 75°E 到 135°E 的范围（25-45 带）</li></ul></li><li><p><strong>灵活的输入格式</strong></p><ul><li>支持多种分隔符：<ul><li>逗号 (,)</li><li>空格 ( )</li><li>分号 (;)</li><li>制表符 (Tab)</li></ul></li><li>支持批量转换，每行一组坐标</li></ul></li><li><p><strong>高精度转换</strong></p><ul><li>采用 proj4.js 库进行投影转换</li><li>输出精度保留到小数点后 6 位</li></ul></li></ol><h2 id="使用说明"><a href="#使用说明" class="headerlink" title="使用说明"></a>使用说明</h2><h3 id="1-WGS-84-转-CGCS2000"><a href="#1-WGS-84-转-CGCS2000" class="headerlink" title="1. WGS-84 转 CGCS2000"></a>1. WGS-84 转 CGCS2000</h3><ol><li><p>在左侧文本框中输入 WGS-84 坐标</p><ul><li>格式：经度,纬度</li><li>每行一组坐标</li><li>示例：<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">116.123456,39.654321</span><br><span class="line">117.987654,40.123456</span><br></pre></td></tr></table></figure></li></ul></li><li><p>选择合适的分隔符</p><ul><li>默认使用逗号分隔</li><li>可根据数据格式选择其他分隔符</li></ul></li><li><p>点击”转换”按钮</p><ul><li>系统会自动根据经度确定 3 度带号</li><li>转换结果将显示在右侧文本框中</li></ul></li></ol><h3 id="2-CGCS2000-转-WGS-84"><a href="#2-CGCS2000-转-WGS-84" class="headerlink" title="2. CGCS2000 转 WGS-84"></a>2. CGCS2000 转 WGS-84</h3><ol><li><p>在右侧文本框中输入 CGCS2000 坐标</p><ul><li>格式：X 坐标,Y 坐标</li><li>每行一组坐标</li></ul></li><li><p>选择对应的 CGCS2000 投影带号</p><ul><li>从下拉菜单中选择正确的 3 度带</li></ul></li><li><p>点击”转换”按钮</p><ul><li>转换结果将显示在左侧文本框中</li></ul></li></ol><h2 id="技术实现"><a href="#技术实现" class="headerlink" title="技术实现"></a>技术实现</h2><ol><li><p><strong>坐标系统定义</strong></p><ul><li>WGS-84：使用 EPSG:4326</li><li>CGCS2000：使用 EPSG:4534-4554（3 度带）</li></ul></li><li><p><strong>投影参数</strong></p><ul><li>采用高斯克吕格投影</li><li>中央经线：每 3 度一带</li><li>投影原点：赤道（纬度 0 度）</li><li>东偏：500000 米</li></ul></li><li><p><strong>核心算法</strong></p><ul><li>使用 proj4.js 库进行坐标转换</li><li>自动计算带号：<code>Math.floor((lng + 1.5) / 3)</code></li><li>支持双向转换功能</li></ul></li></ol><h2 id="使用限制"><a href="#使用限制" class="headerlink" title="使用限制"></a>使用限制</h2><ol><li><p><strong>坐标范围</strong></p><ul><li>经度范围：75°E - 135°E</li><li>超出范围的坐标将给出提示</li></ul></li><li><p><strong>数据格式</strong></p><ul><li>输入数据必须是有效的数值</li><li>每行必须包含两个坐标值</li></ul></li></ol><h2 id="最佳实践"><a href="#最佳实践" class="headerlink" title="最佳实践"></a>最佳实践</h2><ol><li><p><strong>数据准备</strong></p><ul><li>确保坐标数据格式正确</li><li>检查分隔符是否统一</li></ul></li><li><p><strong>批量转换</strong></p><ul><li>建议每次转换不超过 1000 组坐标</li><li>大量数据建议分批处理</li></ul></li><li><p><strong>结果验证</strong></p><ul><li>建议对重要坐标进行抽样检查</li><li>可以使用反向转换验证精度</li></ul></li></ol><h2 id="技术优势"><a href="#技术优势" class="headerlink" title="技术优势"></a>技术优势</h2><ol><li><p><strong>轻量级实现</strong></p><ul><li>纯前端实现，无需服务器</li><li>响应速度快，可离线使用</li></ul></li><li><p><strong>用户友好</strong></p><ul><li>简洁的界面设计</li><li>直观的操作流程</li><li>实时的错误提示</li></ul></li><li><p><strong>高可靠性</strong></p><ul><li>采用成熟的 proj4.js 库</li><li>严格的错误处理机制</li></ul></li></ol><h2 id="结语"><a href="#结语" class="headerlink" title="结语"></a>结语</h2><p>这个坐标转换工具为测绘、地理信息系统等领域的专业人士提供了一个便捷的在线解决方案。通过简单的界面操作，即可完成复杂的坐标系统转换工作。工具的开源特性也使得它可以被集成到其他系统中，为更多的应用场景提供服务。</p><hr><p>本文详细介绍了 WGS-84 与 CGCS2000 坐标转换工具的功能特点、使用方法和技术实现。如果您在使用过程中遇到任何问题，欢迎通过 GitHub 提交问题或建议。</p>]]></content>
      
      
      <categories>
          
          <category> 地理信息系统 </category>
          
          <category> 坐标转换 </category>
          
          <category> 测绘工具 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 在线工具 </tag>
            
            <tag> GIS工具 </tag>
            
            <tag> WGS-84 </tag>
            
            <tag> CGCS2000 </tag>
            
            <tag> 坐标转换 </tag>
            
            <tag> 测绘软件 </tag>
            
            <tag> 地理信息 </tag>
            
            <tag> 投影转换 </tag>
            
            <tag> proj4.js </tag>
            
            <tag> 高斯克吕格投影 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>OpenEuler系统配置指南：Docker安装与GPU环境搭建</title>
      <link href="/2024/10/24/openeuler%E7%B3%BB%E7%BB%9F%E5%AE%89%E8%A3%85%E9%85%8D%E7%BD%AE-docker%E5%AE%89%E8%A3%85-docker%E6%98%BE%E5%8D%A1%E7%8E%AF%E5%A2%83%E5%AE%89%E8%A3%85/"/>
      <url>/2024/10/24/openeuler%E7%B3%BB%E7%BB%9F%E5%AE%89%E8%A3%85%E9%85%8D%E7%BD%AE-docker%E5%AE%89%E8%A3%85-docker%E6%98%BE%E5%8D%A1%E7%8E%AF%E5%A2%83%E5%AE%89%E8%A3%85/</url>
      
        <content type="html"><![CDATA[<h1 id="系统安装"><a href="#系统安装" class="headerlink" title="系统安装"></a>系统安装</h1><h2 id="制作启动盘https-www-iplaysoft-com-ventoy-html"><a href="#制作启动盘https-www-iplaysoft-com-ventoy-html" class="headerlink" title="制作启动盘https://www.iplaysoft.com/ventoy.html"></a>制作启动盘<a href="https://www.iplaysoft.com/ventoy.html">https://www.iplaysoft.com/ventoy.html</a></h2><h2 id="安装系统"><a href="#安装系统" class="headerlink" title="安装系统"></a>安装系统</h2><p>1.启动待安装的电脑&#x2F;服务器。修改启动选项，进入 U 盘启动 2.选择要安装的系统。选择通用安装 3.然后从<a href="https://docs.openeuler.org/zh/docs/22.03_LTS_SP3/docs/Installation/%E5%AE%89%E8%A3%85%E6%8C%87%E5%AF%BC.html">https://docs.openeuler.org/zh/docs/22.03_LTS_SP3/docs/Installation/%E5%AE%89%E8%A3%85%E6%8C%87%E5%AF%BC.html</a> 的“安装引导界面”开始来进行安装配置</p><h1 id="配置网络"><a href="#配置网络" class="headerlink" title="配置网络"></a>配置网络</h1><blockquote><p>参考 <a href="https://docs.openeuler.org/zh/docs/22.03_LTS_SP3/docs/Administration/%E9%85%8D%E7%BD%AE%E7%BD%91%E7%BB%9C.html">https://docs.openeuler.org/zh/docs/22.03_LTS_SP3/docs/Administration/%E9%85%8D%E7%BD%AE%E7%BD%91%E7%BB%9C.html</a></p></blockquote><p>1.查看可用设备<br>nmcli dev status</p><p>2.配置动态 IP<br>nmcli connection add type ethernet con-name 连接名称 ifname 接口名称</p><p>3.激活配置<br>nmcli con up 连接名称</p><h1 id="配置软件源"><a href="#配置软件源" class="headerlink" title="配置软件源"></a>配置软件源</h1><p>1.编辑 vi &#x2F;etc&#x2F;yum.repos.d&#x2F;openEuler.repo</p><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 不通版本配置不同版本的源</span></span><br><span class="line"></span><br><span class="line"><span class="section">[centos-extras]</span></span><br><span class="line"><span class="attr">name</span>=Centos extras - <span class="variable">$basearch</span></span><br><span class="line"><span class="attr">baseurl</span>=https://mirrors.tuna.tsinghua.edu.cn/centos-vault/centos/<span class="number">8</span>/extras/x<span class="number">86_64</span>/os/</span><br><span class="line"><span class="attr">enabled</span>=<span class="number">1</span></span><br><span class="line"><span class="attr">gpgcheck</span>=<span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="section">[OS]</span></span><br><span class="line"><span class="attr">name</span>=OS</span><br><span class="line"><span class="attr">baseurl</span>=http://mirrors.tuna.tsinghua.edu.cn/openeuler/openEuler-<span class="number">20.03</span>-LTS-SP3/OS/<span class="variable">$basearch</span>/</span><br><span class="line"><span class="attr">enabled</span>=<span class="number">1</span></span><br><span class="line"><span class="attr">gpgcheck</span>=<span class="number">1</span></span><br><span class="line"><span class="attr">gpgkey</span>=http://mirrors.tuna.tsinghua.edu.cn/openeuler/openEuler-<span class="number">20.03</span>-LTS-SP3/OS/<span class="variable">$basearch</span>/RPM-GPG-KEY-openEuler</span><br><span class="line"></span><br><span class="line"><span class="section">[everything]</span></span><br><span class="line"><span class="attr">name</span>=everything</span><br><span class="line"><span class="attr">baseurl</span>=http://mirrors.tuna.tsinghua.edu.cn/openeuler/openEuler-<span class="number">20.03</span>-LTS-SP3/everything/<span class="variable">$basearch</span>/</span><br><span class="line"><span class="attr">enabled</span>=<span class="number">1</span></span><br><span class="line"><span class="attr">gpgcheck</span>=<span class="number">1</span></span><br><span class="line"><span class="attr">gpgkey</span>=http://mirrors.tuna.tsinghua.edu.cn/openeuler/openEuler-<span class="number">20.03</span>-LTS-SP3/everything/<span class="variable">$basearch</span>/RPM-GPG-KEY-openEuler</span><br><span class="line"></span><br><span class="line"><span class="section">[EPOL]</span></span><br><span class="line"><span class="attr">name</span>=EPOL</span><br><span class="line"><span class="attr">baseurl</span>=http://mirrors.tuna.tsinghua.edu.cn/openeuler/openEuler-<span class="number">20.03</span>-LTS-SP3/EPOL/main/<span class="variable">$basearch</span>/</span><br><span class="line"><span class="attr">enabled</span>=<span class="number">1</span></span><br><span class="line"><span class="attr">gpgcheck</span>=<span class="number">1</span></span><br><span class="line"><span class="attr">gpgkey</span>=http://mirrors.tuna.tsinghua.edu.cn/openeuler/openEuler-<span class="number">20.03</span>-LTS-SP3/OS/<span class="variable">$basearch</span>/RPM-GPG-KEY-openEuler</span><br><span class="line"></span><br><span class="line"><span class="section">[debuginfo]</span></span><br><span class="line"><span class="attr">name</span>=debuginfo</span><br><span class="line"><span class="attr">baseurl</span>=http://mirrors.tuna.tsinghua.edu.cn/openeuler/openEuler-<span class="number">20.03</span>-LTS-SP3/debuginfo/<span class="variable">$basearch</span>/</span><br><span class="line"><span class="attr">enabled</span>=<span class="number">1</span></span><br><span class="line"><span class="attr">gpgcheck</span>=<span class="number">1</span></span><br><span class="line"><span class="attr">gpgkey</span>=http://mirrors.tuna.tsinghua.edu.cn/openeuler/openEuler-<span class="number">20.03</span>-LTS-SP3/debuginfo/<span class="variable">$basearch</span>/RPM-GPG-KEY-openEuler</span><br><span class="line"></span><br><span class="line"><span class="section">[source]</span></span><br><span class="line"><span class="attr">name</span>=source</span><br><span class="line"><span class="attr">baseurl</span>=http://mirrors.tuna.tsinghua.edu.cn/openeuler/openEuler-<span class="number">20.03</span>-LTS-SP3/source/</span><br><span class="line"><span class="attr">enabled</span>=<span class="number">1</span></span><br><span class="line"><span class="attr">gpgcheck</span>=<span class="number">1</span></span><br><span class="line"><span class="attr">gpgkey</span>=http://mirrors.tuna.tsinghua.edu.cn/openeuler/openEuler-<span class="number">20.03</span>-LTS-SP3/source/RPM-GPG-KEY-openEuler</span><br><span class="line"></span><br><span class="line"><span class="section">[update]</span></span><br><span class="line"><span class="attr">name</span>=update</span><br><span class="line"><span class="attr">baseurl</span>=http://mirrors.tuna.tsinghua.edu.cn/openeuler/openEuler-<span class="number">20.03</span>-LTS-SP3/update/<span class="variable">$basearch</span>/</span><br><span class="line"><span class="attr">enabled</span>=<span class="number">1</span></span><br><span class="line"><span class="attr">gpgcheck</span>=<span class="number">1</span></span><br><span class="line"><span class="attr">gpgkey</span>=http://mirrors.tuna.tsinghua.edu.cn/openeuler/openEuler-<span class="number">20.03</span>-LTS-SP3/OS/<span class="variable">$basearch</span>/RPM-GPG-KEY-openEuler</span><br><span class="line"></span><br><span class="line"><span class="section">[update-source]</span></span><br><span class="line"><span class="attr">name</span>=update-source</span><br><span class="line"><span class="attr">baseurl</span>=http://mirrors.tuna.tsinghua.edu.cn/openeuler/openEuler-<span class="number">20.03</span>-LTS-SP3/update/source/</span><br><span class="line"><span class="attr">enabled</span>=<span class="number">1</span></span><br><span class="line"><span class="attr">gpgcheck</span>=<span class="number">1</span></span><br><span class="line"><span class="attr">gpgkey</span>=http://mirrors.tuna.tsinghua.edu.cn/openeuler/openEuler-<span class="number">20.03</span>-LTS-SP3/source/RPM-GPG-KEY-openEuler</span><br></pre></td></tr></table></figure><p>2.更新本地软件列表</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dnf list all</span><br></pre></td></tr></table></figure><h1 id="安装-SSH-Server"><a href="#安装-SSH-Server" class="headerlink" title="安装 SSH Server"></a>安装 SSH Server</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">dnf install openssh-server</span><br><span class="line">systemctl <span class="built_in">enable</span> sshd</span><br><span class="line">systemctl start sshd</span><br><span class="line"><span class="comment"># 修改配置</span></span><br><span class="line">vi /etc/ssh/sshd_config</span><br><span class="line"><span class="comment"># 以下配置取消注释，设为 yes</span></span><br><span class="line"><span class="comment"># AllowAgentForwarding yes</span></span><br><span class="line"><span class="comment"># AllowTcpForwarding yes</span></span><br><span class="line"><span class="comment"># GatewayPorts yes</span></span><br><span class="line"><span class="comment"># 重启 sshd</span></span><br><span class="line">systemctl restart sshd</span><br></pre></td></tr></table></figure><h1 id="安装-docker"><a href="#安装-docker" class="headerlink" title="安装 docker"></a>安装 docker</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 关闭防火墙</span></span><br><span class="line">systemctl stop firewalld &amp;&amp; systemctl <span class="built_in">disable</span> firewalld</span><br><span class="line"><span class="comment"># 禁用 SELinux</span></span><br><span class="line">sed -i <span class="string">&#x27;s/^SELINUX=enforcing/SELINUX=disabled/&#x27;</span> /etc/selinux/config</span><br><span class="line"><span class="comment"># 配置软件源,内容在下一部分</span></span><br><span class="line">vi /etc/yum.repos.d/docker-ce.repo</span><br><span class="line"><span class="comment"># 安装一些软件</span></span><br><span class="line">dnf install dnf-plugins-core slirp4netns fuse-overlayfs container-selinux -y</span><br><span class="line"></span><br><span class="line"><span class="comment"># 如果提示</span></span><br><span class="line"><span class="comment">#  Error: Transaction test error:</span></span><br><span class="line"><span class="comment">#  file /usr/lib64/libasm.so.1 from install of elfutils-libs-0.190-3.oe2403.x86_64 conflicts with file from package elfutils-0.185-18.oe2203sp4.x86_64</span></span><br><span class="line"><span class="comment">#  file /usr/lib64/libdw.so.1 from install of elfutils-libs-0.190-3.oe2403.x86_64 conflicts with file from package elfutils-0.185-18.oe2203sp4.x86_64</span></span><br><span class="line"><span class="comment"># 运行这个 sudo yum swap elfutils-0.185-18.oe2203sp4.x86_64 elfutils-libs-0.190-3.oe2403.x86_64</span></span><br><span class="line"><span class="comment"># 安装docker</span></span><br><span class="line">yum install docker-ce docker-ce-cli containerd.io docker-buildx-plugin docker-compose-plugin -y</span><br><span class="line"><span class="comment"># 安装nvidia-container-toolkit 如果遇到网络问题 可以手动编辑/etc/yum.repos.d/nvidia-container-toolkit.repo</span></span><br><span class="line">curl -s -L https://nvidia.github.io/libnvidia-container/stable/rpm/nvidia-container-toolkit.repo |   <span class="built_in">sudo</span> <span class="built_in">tee</span> /etc/yum.repos.d/nvidia-container-toolkit.repo</span><br><span class="line"><span class="comment"># 如果下载错误，需要使用代理，请替换为自己的ip</span></span><br><span class="line"><span class="comment"># export https_proxy=http://192.168.31.127:7890 http_proxy=http://192.168.31.127:7890 all_proxy=socks5://192.168.31.127:7890</span></span><br><span class="line">dnf install nvidia-container-toolkit nvidia-docker2 -y</span><br><span class="line"><span class="comment"># 修改配置,内容在下边</span></span><br><span class="line">vi /etc/docker/daemon.json</span><br><span class="line"><span class="comment"># 重启docker</span></span><br><span class="line">systemctl daemon-reload</span><br><span class="line">systemctl restart docker</span><br></pre></td></tr></table></figure><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># /etc/yum.repos.d/docker-ce.repo</span></span><br><span class="line"><span class="comment"># 不通版本配置不同版本的源</span></span><br><span class="line"><span class="section">[docker-ce-stable]</span></span><br><span class="line"><span class="attr">name</span>=Docker CE Stable - <span class="variable">$basearch</span></span><br><span class="line"><span class="attr">baseurl</span>=https://mirrors.tuna.tsinghua.edu.cn/docker-ce/linux/centos/<span class="number">8</span>/<span class="variable">$basearch</span>/stable</span><br><span class="line"><span class="attr">enabled</span>=<span class="number">1</span></span><br><span class="line"><span class="attr">gpgcheck</span>=<span class="number">1</span></span><br><span class="line"><span class="attr">gpgkey</span>=https://mirrors.tuna.tsinghua.edu.cn/docker-ce/linux/centos/gpg</span><br><span class="line"></span><br><span class="line"><span class="section">[docker-ce-stable-debuginfo]</span></span><br><span class="line"><span class="attr">name</span>=Docker CE Stable - Debuginfo <span class="variable">$basearch</span></span><br><span class="line"><span class="attr">baseurl</span>=https://mirrors.tuna.tsinghua.edu.cn/docker-ce/linux/centos/<span class="number">8</span>/debug-<span class="variable">$basearch</span>/stable</span><br><span class="line"><span class="attr">enabled</span>=<span class="number">0</span></span><br><span class="line"><span class="attr">gpgcheck</span>=<span class="number">1</span></span><br><span class="line"><span class="attr">gpgkey</span>=https://mirrors.tuna.tsinghua.edu.cn/docker-ce/linux/centos/gpg</span><br><span class="line"></span><br><span class="line"><span class="section">[docker-ce-stable-source]</span></span><br><span class="line"><span class="attr">name</span>=Docker CE Stable - Sources</span><br><span class="line"><span class="attr">baseurl</span>=https://mirrors.tuna.tsinghua.edu.cn/docker-ce/linux/centos/<span class="number">8</span>/source/stable</span><br><span class="line"><span class="attr">enabled</span>=<span class="number">0</span></span><br><span class="line"><span class="attr">gpgcheck</span>=<span class="number">1</span></span><br><span class="line"><span class="attr">gpgkey</span>=https://mirrors.tuna.tsinghua.edu.cn/docker-ce/linux/centos/gpg</span><br><span class="line"></span><br><span class="line"><span class="section">[docker-ce-test]</span></span><br><span class="line"><span class="attr">name</span>=Docker CE Test - <span class="variable">$basearch</span></span><br><span class="line"><span class="attr">baseurl</span>=https://mirrors.tuna.tsinghua.edu.cn/docker-ce/linux/centos/<span class="number">8</span>/<span class="variable">$basearch</span>/test</span><br><span class="line"><span class="attr">enabled</span>=<span class="number">0</span></span><br><span class="line"><span class="attr">gpgcheck</span>=<span class="number">1</span></span><br><span class="line"><span class="attr">gpgkey</span>=https://mirrors.tuna.tsinghua.edu.cn/docker-ce/linux/centos/gpg</span><br><span class="line"></span><br><span class="line"><span class="section">[docker-ce-test-debuginfo]</span></span><br><span class="line"><span class="attr">name</span>=Docker CE Test - Debuginfo <span class="variable">$basearch</span></span><br><span class="line"><span class="attr">baseurl</span>=https://mirrors.tuna.tsinghua.edu.cn/docker-ce/linux/centos/<span class="number">8</span>/debug-<span class="variable">$basearch</span>/test</span><br><span class="line"><span class="attr">enabled</span>=<span class="number">0</span></span><br><span class="line"><span class="attr">gpgcheck</span>=<span class="number">1</span></span><br><span class="line"><span class="attr">gpgkey</span>=https://mirrors.tuna.tsinghua.edu.cn/docker-ce/linux/centos/gpg</span><br><span class="line"></span><br><span class="line"><span class="section">[docker-ce-test-source]</span></span><br><span class="line"><span class="attr">name</span>=Docker CE Test - Sources</span><br><span class="line"><span class="attr">baseurl</span>=https://mirrors.tuna.tsinghua.edu.cn/docker-ce/linux/centos/<span class="number">8</span>/source/test</span><br><span class="line"><span class="attr">enabled</span>=<span class="number">0</span></span><br><span class="line"><span class="attr">gpgcheck</span>=<span class="number">1</span></span><br><span class="line"><span class="attr">gpgkey</span>=https://mirrors.tuna.tsinghua.edu.cn/docker-ce/linux/centos/gpg</span><br><span class="line"></span><br><span class="line"><span class="section">[docker-ce-nightly]</span></span><br><span class="line"><span class="attr">name</span>=Docker CE Nightly - <span class="variable">$basearch</span></span><br><span class="line"><span class="attr">baseurl</span>=https://mirrors.tuna.tsinghua.edu.cn/docker-ce/linux/centos/<span class="number">8</span>/<span class="variable">$basearch</span>/nightly</span><br><span class="line"><span class="attr">enabled</span>=<span class="number">0</span></span><br><span class="line"><span class="attr">gpgcheck</span>=<span class="number">1</span></span><br><span class="line"><span class="attr">gpgkey</span>=https://mirrors.tuna.tsinghua.edu.cn/docker-ce/linux/centos/gpg</span><br><span class="line"></span><br><span class="line"><span class="section">[docker-ce-nightly-debuginfo]</span></span><br><span class="line"><span class="attr">name</span>=Docker CE Nightly - Debuginfo <span class="variable">$basearch</span></span><br><span class="line"><span class="attr">baseurl</span>=https://mirrors.tuna.tsinghua.edu.cn/docker-ce/linux/centos/<span class="number">8</span>/debug-<span class="variable">$basearch</span>/nightly</span><br><span class="line"><span class="attr">enabled</span>=<span class="number">0</span></span><br><span class="line"><span class="attr">gpgcheck</span>=<span class="number">1</span></span><br><span class="line"><span class="attr">gpgkey</span>=https://mirrors.tuna.tsinghua.edu.cn/docker-ce/linux/centos/gpg</span><br><span class="line"></span><br><span class="line"><span class="section">[docker-ce-nightly-source]</span></span><br><span class="line"><span class="attr">name</span>=Docker CE Nightly - Sources</span><br><span class="line"><span class="attr">baseurl</span>=https://mirrors.tuna.tsinghua.edu.cn/docker-ce/linux/centos/<span class="number">8</span>/source/nightly</span><br><span class="line"><span class="attr">enabled</span>=<span class="number">0</span></span><br><span class="line"><span class="attr">gpgcheck</span>=<span class="number">1</span></span><br><span class="line"><span class="attr">gpgkey</span>=https://mirrors.tuna.tsinghua.edu.cn/docker-ce/linux/centos/gpg</span><br></pre></td></tr></table></figure><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"># /etc/docker/daemon.json</span><br><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;data-root&quot;</span><span class="punctuation">:</span> <span class="string">&quot;/data/docker&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;registry-mirrors&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;https://docker.1panel.dev&quot;</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;default-runtime&quot;</span><span class="punctuation">:</span> <span class="string">&quot;nvidia&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;runtimes&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;nvidia&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">      <span class="attr">&quot;path&quot;</span><span class="punctuation">:</span> <span class="string">&quot;nvidia-container-runtime&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;runtimeArgs&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="punctuation">]</span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line">  <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;log-opts&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;max-size&quot;</span><span class="punctuation">:</span> <span class="string">&quot;10m&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;max-file&quot;</span><span class="punctuation">:</span> <span class="string">&quot;3&quot;</span></span><br><span class="line">  <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;storage-driver&quot;</span><span class="punctuation">:</span> <span class="string">&quot;overlay2&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;exec-opts&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;native.cgroupdriver=systemd&quot;</span><span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># /etc/yum.repos.d/nvidia-container-toolkit.repo</span></span><br><span class="line"><span class="section">[nvidia-container-toolkit]</span></span><br><span class="line"><span class="attr">name</span>=nvidia-container-toolkit</span><br><span class="line"><span class="attr">baseurl</span>=https://nvidia.github.io/libnvidia-container/stable/rpm/<span class="variable">$basearch</span></span><br><span class="line"><span class="attr">repo_gpgcheck</span>=<span class="number">1</span></span><br><span class="line"><span class="attr">gpgcheck</span>=<span class="number">0</span></span><br><span class="line"><span class="attr">enabled</span>=<span class="number">1</span></span><br><span class="line"><span class="attr">gpgkey</span>=https://nvidia.github.io/libnvidia-container/gpgkey</span><br><span class="line"><span class="attr">sslverify</span>=<span class="number">1</span></span><br><span class="line"><span class="attr">sslcacert</span>=/etc/pki/tls/certs/ca-bundle.crt</span><br><span class="line"></span><br><span class="line"><span class="section">[nvidia-container-toolkit-experimental]</span></span><br><span class="line"><span class="attr">name</span>=nvidia-container-toolkit-experimental</span><br><span class="line"><span class="attr">baseurl</span>=https://nvidia.github.io/libnvidia-container/experimental/rpm/<span class="variable">$basearch</span></span><br><span class="line"><span class="attr">repo_gpgcheck</span>=<span class="number">1</span></span><br><span class="line"><span class="attr">gpgcheck</span>=<span class="number">0</span></span><br><span class="line"><span class="attr">enabled</span>=<span class="number">0</span></span><br><span class="line"><span class="attr">gpgkey</span>=https://nvidia.github.io/libnvidia-container/gpgkey</span><br><span class="line"><span class="attr">sslverify</span>=<span class="number">1</span></span><br><span class="line"><span class="attr">sslcacert</span>=/etc/pki/tls/certs/ca-bundle.crt</span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 操作系统 </category>
          
          <category> 容器技术 </category>
          
          <category> GPU计算 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> openEuler </tag>
            
            <tag> docker </tag>
            
            <tag> GPU </tag>
            
            <tag> system configuration </tag>
            
            <tag> container technology </tag>
            
            <tag> NVIDIA drivers </tag>
            
            <tag> Linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Node.js TCP编程 消息包的拆分与重组实践</title>
      <link href="/2024/08/26/%E5%AE%A2%E6%88%B7%E7%AB%AF%E5%B9%B6%E6%8B%86%E5%88%86%E8%BF%9E%E7%BB%AD%E6%B6%88%E6%81%AF%E5%8C%85/"/>
      <url>/2024/08/26/%E5%AE%A2%E6%88%B7%E7%AB%AF%E5%B9%B6%E6%8B%86%E5%88%86%E8%BF%9E%E7%BB%AD%E6%B6%88%E6%81%AF%E5%8C%85/</url>
      
        <content type="html"><![CDATA[<h2 id="使用-Node-js-开发-TCP-客户端并拆分连续消息包"><a href="#使用-Node-js-开发-TCP-客户端并拆分连续消息包" class="headerlink" title="使用 Node.js 开发 TCP 客户端并拆分连续消息包"></a>使用 Node.js 开发 TCP 客户端并拆分连续消息包</h2><p>在网络编程中，TCP 是一种可靠的传输协议，它确保数据的完整性和顺序性。然而，在实际开发 TCP 客户端时，我们常常会遇到一个挑战：由于 TCP 是面向流的协议，接收到的数据可能并不总是按预期的消息边界到达，尤其是在高速数据传输时，多个消息包可能会连续到达。这时，我们需要自己处理数据的拆分和重组，以确保消息的完整性。</p><h3 id="问题描述"><a href="#问题描述" class="headerlink" title="问题描述"></a>问题描述</h3><p>假设我们在开发一个 TCP 客户端，该客户端接收到的每条消息都有固定的起始标志符和结束标志符。当收到的数据流中包含多个连续的消息包时，我们需要将它们正确地拆分并处理。</p><h3 id="解决方案"><a href="#解决方案" class="headerlink" title="解决方案"></a>解决方案</h3><p>为了解决这个问题，我们可以通过以下步骤来处理连续的消息包：</p><ol><li><p><strong>维护一个缓存区</strong>：使用一个缓存区来存储接收到的数据。这样即使消息包分成了多次接收，我们也可以将它们重组在一起。</p></li><li><p><strong>检测起始标志符和结束标志符</strong>：在接收到的数据中查找起始标志符和结束标志符，并将完整的消息提取出来。</p></li><li><p><strong>处理并移除已处理的消息</strong>：一旦我们找到了完整的消息，就可以处理它，并从缓存区中移除已经处理的部分。</p></li></ol><p>下面是一个示例代码，展示了如何实现这些步骤：</p><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> net <span class="keyword">from</span> <span class="string">&quot;net&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> fse <span class="keyword">from</span> <span class="string">&quot;fs-extra&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 定义起始标志符和结束标志符</span></span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">START_FLAG</span> = <span class="title class_">Buffer</span>.<span class="title function_">from</span>([<span class="number">0xeb</span>, <span class="number">0x90</span>]);</span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">END_FLAG</span> = <span class="title class_">Buffer</span>.<span class="title function_">from</span>([<span class="number">0xeb</span>, <span class="number">0x90</span>]);</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">TcpClient</span> &#123;</span><br><span class="line">  <span class="attr">client</span>: net.<span class="property">Socket</span>;</span><br><span class="line">  <span class="attr">buffer</span>: <span class="title class_">Buffer</span>;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">client</span> = <span class="keyword">new</span> net.<span class="title class_">Socket</span>();</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">buffer</span> = <span class="title class_">Buffer</span>.<span class="title function_">alloc</span>(<span class="number">0</span>);</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">client</span>.<span class="title function_">on</span>(<span class="string">&quot;data&quot;</span>, <span class="variable language_">this</span>.<span class="property">handleResponse</span>.<span class="title function_">bind</span>(<span class="variable language_">this</span>));</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">handleResponse</span>(<span class="params"><span class="attr">data</span>: <span class="title class_">Buffer</span></span>) &#123;</span><br><span class="line">    <span class="comment">// 将接收到的数据追加到缓存区</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">buffer</span> = <span class="title class_">Buffer</span>.<span class="title function_">concat</span>([<span class="variable language_">this</span>.<span class="property">buffer</span>, data]);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> start, end;</span><br><span class="line">    <span class="comment">// 查找并处理完整的消息</span></span><br><span class="line">    <span class="keyword">while</span> ((start = <span class="variable language_">this</span>.<span class="property">buffer</span>.<span class="title function_">indexOf</span>(<span class="variable constant_">START_FLAG</span>)) !== -<span class="number">1</span> &amp;&amp; (end = <span class="variable language_">this</span>.<span class="property">buffer</span>.<span class="title function_">indexOf</span>(<span class="variable constant_">END_FLAG</span>, start + <span class="variable constant_">START_FLAG</span>.<span class="property">length</span>)) !== -<span class="number">1</span>) &#123;</span><br><span class="line">      <span class="comment">// 提取消息内容</span></span><br><span class="line">      <span class="keyword">const</span> messageBuffer = <span class="variable language_">this</span>.<span class="property">buffer</span>.<span class="title function_">slice</span>(start + <span class="variable constant_">START_FLAG</span>.<span class="property">length</span>, end);</span><br><span class="line"></span><br><span class="line">      <span class="comment">// 处理消息内容 (示例：输出消息)</span></span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;Received message:&quot;</span>, messageBuffer.<span class="title function_">toString</span>());</span><br><span class="line"></span><br><span class="line">      <span class="comment">// 移除已处理的部分</span></span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">buffer</span> = <span class="variable language_">this</span>.<span class="property">buffer</span>.<span class="title function_">slice</span>(end + <span class="variable constant_">END_FLAG</span>.<span class="property">length</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 记录原始数据以备调试</span></span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      fse.<span class="title function_">appendFileSync</span>(<span class="string">&quot;buffer.txt&quot;</span>, data.<span class="title function_">toString</span>(<span class="string">&quot;hex&quot;</span>) + <span class="string">&quot;\n&quot;</span>, <span class="string">&quot;utf8&quot;</span>);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (err) &#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&quot;Error writing to log file:&quot;</span>, err);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">connectToServer</span>(<span class="params"><span class="attr">port</span>: <span class="built_in">number</span>, <span class="attr">host</span>: <span class="built_in">string</span></span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">client</span>.<span class="title function_">connect</span>(port, host, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;Connected to server&quot;</span>);</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">client</span>.<span class="title function_">on</span>(<span class="string">&quot;error&quot;</span>, <span class="function"><span class="params">err</span> =&gt;</span> &#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&quot;Connection error:&quot;</span>, err);</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">client</span>.<span class="title function_">on</span>(<span class="string">&quot;close&quot;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;Connection closed&quot;</span>);</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 创建并连接客户端</span></span><br><span class="line"><span class="keyword">const</span> tcpClientInstance = <span class="keyword">new</span> <span class="title class_">TcpClient</span>();</span><br><span class="line">tcpClientInstance.<span class="title function_">connectToServer</span>(<span class="number">12345</span>, <span class="string">&quot;127.0.0.1&quot;</span>);</span><br></pre></td></tr></table></figure><h3 id="代码解析"><a href="#代码解析" class="headerlink" title="代码解析"></a>代码解析</h3><ul><li><p><strong>缓存区</strong>：<code>this.buffer</code> 用来缓存接收到的数据。因为在实际网络传输中，数据可能会被分段接收，因此我们需要一个缓存来存储这些片段，直到我们能拼凑出完整的消息。</p></li><li><p><strong>标志符的检测与消息提取</strong>：通过 <code>buffer.indexOf</code> 方法，我们可以找到起始标志符和结束标志符的位置。找到后，我们就能提取出完整的消息内容。</p></li><li><p><strong>处理并移除已处理的消息</strong>：一旦消息被提取出来，我们将其从缓存中移除，以便处理下一条消息。</p></li></ul><h3 id="可能的问题"><a href="#可能的问题" class="headerlink" title="可能的问题"></a>可能的问题</h3><ol><li><p><strong>解析错误</strong>:当消息中包含与标志符相同的内容。存在解析错误的可能性，这可能导致消息被切断。</p><p>要解决这个问题，可以在消息中添加长度标识符或者 crc 校验。<br>我这里使用长度标识符举例。再解析过程中添加长度的判断<br>假设的消息协议为：<br><img src="https://cdn.jsdelivr.net/gh/houxiaozhao/imageLibrary@master/uPic/2024/12/12/EhTyLe.png" alt="EhTyLe"></p></li></ol><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> net <span class="keyword">from</span> <span class="string">&quot;net&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> fse <span class="keyword">from</span> <span class="string">&quot;fs-extra&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">START_FLAG</span> = <span class="title class_">Buffer</span>.<span class="title function_">from</span>([<span class="number">0x90</span>, <span class="number">0xeb</span>]); <span class="comment">// 小端字节序</span></span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">END_FLAG</span> = <span class="title class_">Buffer</span>.<span class="title function_">from</span>([<span class="number">0x90</span>, <span class="number">0xeb</span>]); <span class="comment">// 小端字节序</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">TcpClient</span> &#123;</span><br><span class="line">  <span class="attr">client</span>: net.<span class="property">Socket</span>;</span><br><span class="line">  <span class="attr">buffer</span>: <span class="title class_">Buffer</span>;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">client</span> = <span class="keyword">new</span> net.<span class="title class_">Socket</span>();</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">buffer</span> = <span class="title class_">Buffer</span>.<span class="title function_">alloc</span>(<span class="number">0</span>);</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">client</span>.<span class="title function_">on</span>(<span class="string">&quot;data&quot;</span>, <span class="variable language_">this</span>.<span class="property">handleResponse</span>.<span class="title function_">bind</span>(<span class="variable language_">this</span>));</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">handleResponse</span>(<span class="params">data: Buffer</span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">buffer</span> = <span class="title class_">Buffer</span>.<span class="title function_">concat</span>([<span class="variable language_">this</span>.<span class="property">buffer</span>, data]);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> (<span class="literal">true</span>) &#123;</span><br><span class="line">      <span class="comment">// 找到起始标志符</span></span><br><span class="line">      <span class="keyword">const</span> start = <span class="variable language_">this</span>.<span class="property">buffer</span>.<span class="title function_">indexOf</span>(<span class="variable constant_">START_FLAG</span>);</span><br><span class="line">      <span class="keyword">if</span> (start === -<span class="number">1</span>) <span class="keyword">break</span>;</span><br><span class="line"></span><br><span class="line">      <span class="comment">// 确保有足够的长度读取固定头部部分</span></span><br><span class="line">      <span class="keyword">const</span> headerLength = <span class="variable constant_">START_FLAG</span>.<span class="property">length</span> + <span class="number">8</span> + <span class="number">8</span> + <span class="number">1</span> + <span class="number">4</span>; <span class="comment">// 固定部分长度</span></span><br><span class="line">      <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">buffer</span>.<span class="property">length</span> &lt; start + headerLength) <span class="keyword">break</span>;</span><br><span class="line"></span><br><span class="line">      <span class="comment">// 解析头部</span></span><br><span class="line">      <span class="keyword">const</span> sendSeq = <span class="variable language_">this</span>.<span class="property">buffer</span>.<span class="title function_">readBigInt64LE</span>(start + <span class="number">2</span>); <span class="comment">// 发送会话序列号</span></span><br><span class="line">      <span class="keyword">const</span> recvSeq = <span class="variable language_">this</span>.<span class="property">buffer</span>.<span class="title function_">readBigInt64LE</span>(start + <span class="number">10</span>); <span class="comment">// 接收会话序列号</span></span><br><span class="line">      <span class="keyword">const</span> sourceFlag = <span class="variable language_">this</span>.<span class="property">buffer</span>.<span class="title function_">readUInt8</span>(start + <span class="number">18</span>); <span class="comment">// 会话源标识</span></span><br><span class="line">      <span class="keyword">const</span> xmlLength = <span class="variable language_">this</span>.<span class="property">buffer</span>.<span class="title function_">readUInt32LE</span>(start + <span class="number">19</span>); <span class="comment">// XML 的字节长度</span></span><br><span class="line"></span><br><span class="line">      <span class="comment">// 确保有足够的长度读取完整消息</span></span><br><span class="line">      <span class="keyword">const</span> totalLength = headerLength + xmlLength + <span class="variable constant_">END_FLAG</span>.<span class="property">length</span>;</span><br><span class="line">      <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">buffer</span>.<span class="property">length</span> &lt; start + totalLength) <span class="keyword">break</span>;</span><br><span class="line"></span><br><span class="line">      <span class="comment">// 提取并解析 XML 内容</span></span><br><span class="line">      <span class="keyword">const</span> xmlStart = start + headerLength;</span><br><span class="line">      <span class="keyword">const</span> xmlContent = <span class="variable language_">this</span>.<span class="property">buffer</span>.<span class="title function_">slice</span>(xmlStart, xmlStart + xmlLength).<span class="title function_">toString</span>(<span class="string">&quot;utf-8&quot;</span>);</span><br><span class="line"></span><br><span class="line">      <span class="comment">// 确保结束标志符正确</span></span><br><span class="line">      <span class="keyword">const</span> endFlagStart = xmlStart + xmlLength;</span><br><span class="line">      <span class="keyword">if</span> (!<span class="variable language_">this</span>.<span class="property">buffer</span>.<span class="title function_">slice</span>(endFlagStart, endFlagStart + <span class="variable constant_">END_FLAG</span>.<span class="property">length</span>).<span class="title function_">equals</span>(<span class="variable constant_">END_FLAG</span>)) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&quot;Invalid END_FLAG detected&quot;</span>);</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      <span class="comment">// 打印解析结果</span></span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;Received Message:&quot;</span>);</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;Send Sequence:&quot;</span>, sendSeq);</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;Receive Sequence:&quot;</span>, recvSeq);</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;Source Flag:&quot;</span>, sourceFlag);</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;XML Content:&quot;</span>, xmlContent);</span><br><span class="line"></span><br><span class="line">      <span class="comment">// 移除已处理的部分</span></span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">buffer</span> = <span class="variable language_">this</span>.<span class="property">buffer</span>.<span class="title function_">slice</span>(start + totalLength);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">connectToServer</span>(<span class="params">port: number, host: string</span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">client</span>.<span class="title function_">connect</span>(port, host, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;Connected to server&quot;</span>);</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">client</span>.<span class="title function_">on</span>(<span class="string">&quot;error&quot;</span>, <span class="function"><span class="params">err</span> =&gt;</span> &#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&quot;Connection error:&quot;</span>, err);</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">client</span>.<span class="title function_">on</span>(<span class="string">&quot;close&quot;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;Connection closed&quot;</span>);</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 创建并连接客户端</span></span><br><span class="line"><span class="keyword">const</span> tcpClientInstance = <span class="keyword">new</span> <span class="title class_">TcpClient</span>();</span><br><span class="line">tcpClientInstance.<span class="title function_">connectToServer</span>(<span class="number">12345</span>, <span class="string">&quot;127.0.0.1&quot;</span>);</span><br></pre></td></tr></table></figure><h3 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h3><p>在 Node.js 中处理 TCP 数据流时，理解并处理消息边界是至关重要的。通过维护一个缓存区并检测消息的起始和结束标志符，我们可以确保即使在连续接收多个消息包的情况下，也能够正确地拆分和处理每条消息。这种方法不仅适用于 TCP 客户端，同样也可以应用于服务端数据接收的场景。</p><p>希望这篇文章能够帮助你更好地理解和处理 TCP 数据流中的消息拆分问题。如果你在实际开发中遇到了类似的挑战，可以参考本文的解决方案进行处理。Happy Coding!</p>]]></content>
      
      
      <categories>
          
          <category> 后端开发 </category>
          
          <category> 网络编程 </category>
          
          <category> Node.js </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 网络协议 </tag>
            
            <tag> TypeScript </tag>
            
            <tag> TCP编程 </tag>
            
            <tag> Node.js开发 </tag>
            
            <tag> 网络通信 </tag>
            
            <tag> 数据流处理 </tag>
            
            <tag> Buffer操作 </tag>
            
            <tag> 消息解析 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>基于RSA和AES的系统离线License验证方案实现</title>
      <link href="/2024/05/10/%E7%B3%BB%E7%BB%9F%E7%A6%BB%E7%BA%BFlicense%E9%AA%8C%E8%AF%81%E7%9A%84%E6%96%B9%E6%B3%95/"/>
      <url>/2024/05/10/%E7%B3%BB%E7%BB%9F%E7%A6%BB%E7%BA%BFlicense%E9%AA%8C%E8%AF%81%E7%9A%84%E6%96%B9%E6%B3%95/</url>
      
        <content type="html"><![CDATA[<blockquote><p>为了解决系统私有化部署，完全离线的情况下，如何验证 license 的问题。 需要考虑以下几个方面：</p></blockquote><blockquote><ol><li>系统需要支持离线验证，即在没有网络连接的情况下也能进行 license 验证。</li><li>需要保证 license 验证的准确性，防止被篡改或伪造。</li><li>需要考虑 license 的过期时间、使用次数等限制条件，并确保在离线情况下也能进行验证。</li><li>需要确保系统绑定在一台设备上，防止 license 被盗用。</li></ol></blockquote><h2 id="1-实现原理"><a href="#1-实现原理" class="headerlink" title="1. 实现原理"></a>1. 实现原理</h2><p>使用私钥签名，公钥验签的方式进行验证。在系统部署时，生成一个密钥对，使用私钥对信息签名。同时将公钥提供给用户，用于验证签名。用户在购买 license 时，使用私钥对 license 进行签名，并将签名后的 license 发送给用户。用户在安装 license 时，使用公钥对 license 进行验签，验证其有效性。<br>签名的过程</p><ol><li>对自定义信息+随机字符串(密钥)进行加密</li><li>使用私钥对加密后的信息进行签名</li><li>将密钥+加密信息长度+加密信息+签名作为 license</li></ol><h2 id="2-具体实现-Nodejs-代码"><a href="#2-具体实现-Nodejs-代码" class="headerlink" title="2. 具体实现 Nodejs 代码"></a>2. 具体实现 Nodejs 代码</h2><h3 id="2-1-生成密钥对"><a href="#2-1-生成密钥对" class="headerlink" title="2.1 生成密钥对"></a>2.1 生成密钥对</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title class_">NodeRSA</span> = <span class="built_in">require</span>(<span class="string">&quot;node-rsa&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> key = <span class="keyword">new</span> <span class="title class_">NodeRSA</span>(&#123; <span class="attr">b</span>: <span class="number">1024</span> &#125;);</span><br><span class="line"><span class="keyword">const</span> publicKey = key.<span class="title function_">exportKey</span>(<span class="string">&quot;public&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> privateKey = key.<span class="title function_">exportKey</span>(<span class="string">&quot;private&quot;</span>);</span><br></pre></td></tr></table></figure><h3 id="2-2-生成-license"><a href="#2-2-生成-license" class="headerlink" title="2.2 生成 license"></a>2.2 生成 license</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> randomString = <span class="built_in">require</span>(<span class="string">&quot;random-string&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> <span class="title class_">Utf8</span> = <span class="built_in">require</span>(<span class="string">&quot;crypto-js/enc-utf8&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">AES</span> = <span class="built_in">require</span>(<span class="string">&quot;crypto-js/aes&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">ECB</span> = <span class="built_in">require</span>(<span class="string">&quot;crypto-js/mode-ecb&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> <span class="title class_">Pkcs7</span> = <span class="built_in">require</span>(<span class="string">&quot;crypto-js/pad-pkcs7&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> authorization = &#123;</span><br><span class="line">  <span class="attr">appid</span>: argv.<span class="property">appid</span>,</span><br><span class="line">  <span class="attr">issuedTime</span>: <span class="built_in">parseInt</span>(<span class="title class_">Date</span>.<span class="title function_">now</span>() / <span class="number">1000</span>), <span class="comment">// 授权时间，如果需要也可以添加过期时间</span></span><br><span class="line">  <span class="attr">hardware</span>: argv.<span class="property">hardware</span>, <span class="comment">//部署机器的唯一识别码，提前获取。需要在部署的系统中获取然后验证</span></span><br><span class="line">  <span class="attr">customerInfo</span>: argv.<span class="property">info</span>, <span class="comment">// 其他信息</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">const</span> aescfg = &#123; <span class="attr">mode</span>: <span class="variable constant_">ECB</span>, <span class="attr">padding</span>: <span class="title class_">Pkcs7</span> &#125;;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">getLicense</span>(<span class="params">authorization, privateKey</span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> aesKey = <span class="title function_">randomString</span>(&#123; <span class="attr">length</span>: <span class="number">16</span> &#125;); <span class="comment">// 生成16位的随机字符串作为AES加密的密钥</span></span><br><span class="line">  <span class="keyword">const</span> encData = <span class="variable constant_">AES</span>.<span class="title function_">encrypt</span>(<span class="title class_">Utf8</span>.<span class="title function_">parse</span>(<span class="title class_">JSON</span>.<span class="title function_">stringify</span>(authorization)), <span class="title class_">Utf8</span>.<span class="title function_">parse</span>(aesKey), aescfg).<span class="title function_">toString</span>(); <span class="comment">// 使用AES加密算法对授权信息进行加密</span></span><br><span class="line">  <span class="keyword">const</span> encDataLength = encData.<span class="property">length</span>.<span class="title function_">toString</span>(<span class="number">16</span>);</span><br><span class="line">  <span class="keyword">const</span> key = <span class="keyword">new</span> <span class="title class_">NodeRSA</span>(privateKey, <span class="string">&quot;pkcs1-private-pem&quot;</span>);</span><br><span class="line">  <span class="keyword">const</span> sign = key.<span class="title function_">sign</span>(encData, <span class="string">&quot;base64&quot;</span>, <span class="string">&quot;base64&quot;</span>); <span class="comment">// 使用私钥对加密后的授权信息进行签名</span></span><br><span class="line">  <span class="keyword">const</span> license = aesKey + encDataLength + encData + sign; <span class="comment">// 签名后的license</span></span><br><span class="line">  <span class="keyword">return</span> license;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="2-3-验证-license"><a href="#2-3-验证-license" class="headerlink" title="2.3 验证 license"></a>2.3 验证 license</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">checkLicense</span>(<span class="params">license, publicKey</span>) &#123;</span><br><span class="line">  <span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> aesKey = <span class="title class_">Utf8</span>.<span class="title function_">parse</span>(license.<span class="title function_">substring</span>(<span class="number">0</span>, <span class="number">16</span>));</span><br><span class="line">    <span class="keyword">const</span> encDataLength = <span class="built_in">parseInt</span>(license.<span class="title function_">substring</span>(<span class="number">16</span>, <span class="number">18</span>), <span class="number">16</span>);</span><br><span class="line">    <span class="keyword">const</span> encData = license.<span class="title function_">substring</span>(<span class="number">18</span>, <span class="number">18</span> + encDataLength);</span><br><span class="line">    <span class="keyword">const</span> sign = license.<span class="title function_">substring</span>(<span class="number">18</span> + encDataLength);</span><br><span class="line">    <span class="keyword">const</span> key = <span class="keyword">new</span> <span class="title class_">NodeRSA</span>(publicKey, <span class="string">&quot;pkcs8-public-pem&quot;</span>);</span><br><span class="line">    <span class="keyword">if</span> (!key.<span class="title function_">verify</span>(encData, sign, <span class="string">&quot;base64&quot;</span>, <span class="string">&quot;base64&quot;</span>)) &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">const</span> data = <span class="title class_">JSON</span>.<span class="title function_">parse</span>(<span class="variable constant_">AES</span>.<span class="title function_">decrypt</span>(encData, aesKey, aescfg).<span class="title function_">toString</span>(<span class="title class_">Utf8</span>));</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;data&quot;</span>, data);</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">  &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="源代码"><a href="#源代码" class="headerlink" title="源代码"></a>源代码</h3><p><a href="https://github.com/houxiaozhao/licenseAuthorization">https://github.com/houxiaozhao/licenseAuthorization</a></p>]]></content>
      
      
      <categories>
          
          <category> 系统开发 </category>
          
          <category> 安全认证 </category>
          
          <category> Node.js开发 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Node.js </tag>
            
            <tag> 加密算法 </tag>
            
            <tag> License验证 </tag>
            
            <tag> 系统安全 </tag>
            
            <tag> RSA加密 </tag>
            
            <tag> AES加密 </tag>
            
            <tag> 私有化部署 </tag>
            
            <tag> 离线验证 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>uniapp 的 Android 端获取照片的MD5</title>
      <link href="/2023/09/26/uniapp%E8%8E%B7%E5%8F%96%E7%85%A7%E7%89%87%E7%9A%84MD5/"/>
      <url>/2023/09/26/uniapp%E8%8E%B7%E5%8F%96%E7%85%A7%E7%89%87%E7%9A%84MD5/</url>
      
        <content type="html"><![CDATA[<p>使用<code>spark-md5</code>这个包计算文件的 md5 值，但是在 Uniapp 安卓端没有 FileReader 这个方法。</p><p>可以利用 plus.io.FileReader 读取照片 base64 内容，然后再计算 md5</p><h2 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 获取照片 md5</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">getMD5</span>(<span class="params">path</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">    plus.<span class="property">io</span>.<span class="title function_">resolveLocalFileSystemURL</span>(path, <span class="function"><span class="params">entry</span> =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">var</span> fileReader = <span class="keyword">new</span> plus.<span class="property">io</span>.<span class="title class_">FileReader</span>();</span><br><span class="line">      fileReader.<span class="title function_">readAsDataURL</span>(entry);</span><br><span class="line">      fileReader.<span class="property">onloadend</span> = <span class="keyword">function</span> (<span class="params">evt</span>) &#123;</span><br><span class="line">        <span class="comment">// base64图片，比如：data:image/jpeg;base64,/9j/4AAQSkZ...</span></span><br><span class="line">        <span class="keyword">var</span> base64 = evt.<span class="property">target</span>.<span class="property">result</span>;</span><br><span class="line">        <span class="comment">//抽取DataURL中的数据部分，从Base64格式转换为二进制格式</span></span><br><span class="line">        <span class="keyword">var</span> bin = <span class="title function_">atob</span>(base64.<span class="title function_">split</span>(<span class="string">&quot;,&quot;</span>)[<span class="number">1</span>]); <span class="comment">//atob解码</span></span><br><span class="line">        <span class="comment">// 利用 Spark MD5 计算MD5值</span></span><br><span class="line">        <span class="keyword">var</span> sparkMD5 = <span class="keyword">new</span> <span class="title class_">SparkMD5</span>();</span><br><span class="line">        sparkMD5.<span class="title function_">appendBinary</span>(bin); <span class="comment">//载入数据</span></span><br><span class="line">        <span class="keyword">var</span> <span class="title class_">MD5</span> = sparkMD5.<span class="title function_">end</span>();</span><br><span class="line">        <span class="title function_">resolve</span>(<span class="title class_">MD5</span>);</span><br><span class="line">      &#125;;</span><br><span class="line">      fileReader.<span class="property">onerror</span> = <span class="function"><span class="params">err</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="title function_">reject</span>(err);</span><br><span class="line">      &#125;;</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="使用方法"><a href="#使用方法" class="headerlink" title="使用方法"></a>使用方法</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> &#123; tempFiles &#125; = <span class="keyword">await</span> uni.<span class="title function_">chooseImage</span>(&#123;</span><br><span class="line">  <span class="attr">sizeType</span>: [<span class="string">&quot;compressed&quot;</span>],</span><br><span class="line">  <span class="attr">sourceType</span>: [<span class="string">&quot;camera&quot;</span>],</span><br><span class="line">&#125;);</span><br><span class="line"><span class="keyword">const</span> md5 = <span class="keyword">await</span> <span class="variable language_">this</span>.<span class="title function_">getMD5</span>(tempFiles[<span class="number">0</span>].<span class="property">path</span>);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;md5&quot;</span>, md5);</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 移动应用开发 </category>
          
          <category> 跨平台开发 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> JavaScript </tag>
            
            <tag> 跨平台开发 </tag>
            
            <tag> 文件处理 </tag>
            
            <tag> uni-app </tag>
            
            <tag> Android开发 </tag>
            
            <tag> MD5计算 </tag>
            
            <tag> Base64 </tag>
            
            <tag> 移动端开发 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Strapi文件上传指南：从控制器实现服务器端上传</title>
      <link href="/2023/07/06/strapi%E4%B8%8A%E4%BC%A0%E6%96%87%E4%BB%B6%E4%BB%8Econtroll%E4%B8%AD/"/>
      <url>/2023/07/06/strapi%E4%B8%8A%E4%BC%A0%E6%96%87%E4%BB%B6%E4%BB%8Econtroll%E4%B8%AD/</url>
      
        <content type="html"><![CDATA[<p>官网中关于上传文件的介绍只介绍了如何在前端上传文件，但是在后端上传文件的需求也是很常见的，比如在 controller 中上传文件。</p><h3 id="上传文件"><a href="#上传文件" class="headerlink" title="上传文件"></a>上传文件</h3><p>在 controller 或 service 中上传文件，需要使用 strapi 的 service 中的 upload 方法，具体使用方法如下：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> fse <span class="keyword">from</span> <span class="string">&quot;fs-extra&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> path <span class="keyword">from</span> <span class="string">&quot;path&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> os <span class="keyword">from</span> <span class="string">&quot;os&quot;</span>;</span><br><span class="line"><span class="comment">//需要把文件放到临时文件夹中</span></span><br><span class="line"><span class="keyword">const</span> tmpWorkingDirectory = <span class="keyword">await</span> fse.<span class="title function_">mkdtemp</span>(path.<span class="title function_">join</span>(os.<span class="title function_">tmpdir</span>(), <span class="string">&quot;strapi-upload-&quot;</span>));</span><br><span class="line"><span class="keyword">const</span> fileName = <span class="title class_">Date</span>.<span class="title function_">now</span>() + <span class="string">&quot;.jpg&quot;</span>; <span class="comment">// 根据实际情况修改文件名</span></span><br><span class="line"><span class="keyword">const</span> tmpFilePath = path.<span class="title function_">join</span>(tmpWorkingDirectory, fileName); <span class="comment">// 根据实际情况修改文件名</span></span><br><span class="line"><span class="keyword">await</span> fse.<span class="title function_">writeFile</span>(tmpFilePath, data); <span class="comment">//data 为文件的二进制数据</span></span><br><span class="line"><span class="keyword">const</span> files = <span class="keyword">await</span> strapi</span><br><span class="line">  .<span class="title function_">plugin</span>(<span class="string">&quot;upload&quot;</span>)</span><br><span class="line">  .<span class="title function_">service</span>(<span class="string">&quot;upload&quot;</span>)</span><br><span class="line">  .<span class="title function_">upload</span>(&#123;</span><br><span class="line">    <span class="attr">data</span>: &#123; <span class="attr">fileInfo</span>: &#123; <span class="attr">name</span>: fileName, <span class="attr">folder</span>: <span class="literal">null</span> &#125; &#125;,</span><br><span class="line">    <span class="attr">files</span>: &#123;</span><br><span class="line">      <span class="comment">// 这个位置不需要传入 File 对象。</span></span><br><span class="line">      <span class="attr">path</span>: tmpFilePath,</span><br><span class="line">      <span class="attr">name</span>: fileName,</span><br><span class="line">      <span class="attr">type</span>: <span class="string">&quot;image/jpeg&quot;</span>, <span class="comment">//根据实际情况修改文件类型</span></span><br><span class="line">      <span class="attr">size</span>: fse.<span class="title function_">statSync</span>(tmpFilePath).<span class="property">size</span>,</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;);</span><br></pre></td></tr></table></figure><p>这个地方最坑就是 files 参数 。</p><p>在插件的源码中此处传入的时 req 中的 files。但是如果文件不是从前端传入的，那么需要自己构造一个 File 对象。而在后端构建 File 对象还很麻烦。用了很多方法都不太行。再研究源码后，发现可以手动构建 File 对象，只需要包含几个参数即可。</p>]]></content>
      
      
      <categories>
          
          <category> 后端开发 </category>
          
          <category> 内容管理系统 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 后端 </tag>
            
            <tag> nodejs </tag>
            
            <tag> strapi </tag>
            
            <tag> file upload </tag>
            
            <tag> content management </tag>
            
            <tag> server-side </tag>
            
            <tag> controller </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Python与华为摄像头API集成：实现图片抓拍与数据解析</title>
      <link href="/2023/06/27/%E5%8D%8E%E4%B8%BA%E6%91%84%E5%83%8F%E5%A4%B4%E6%8A%93%E6%8B%8D%E5%9B%BE%E7%89%87/"/>
      <url>/2023/06/27/%E5%8D%8E%E4%B8%BA%E6%91%84%E5%83%8F%E5%A4%B4%E6%8A%93%E6%8B%8D%E5%9B%BE%E7%89%87/</url>
      
        <content type="html"><![CDATA[<p>华为摄像头提供了抓拍图片的 API，但是返回的数据是 multipart 格式的，需要进行解析。本文将介绍如何使用 Python 抓取华为摄像头的抓拍图片。</p><h2 id="获取抓拍图片"><a href="#获取抓拍图片" class="headerlink" title="获取抓拍图片"></a>获取抓拍图片</h2><p>首先，我们需要使用 HTTP Digest Authentication 认证方式，向华为摄像头的 API 发送 POST 请求，获取抓拍图片。以下是示例代码：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"></span><br><span class="line">username = <span class="string">&#x27;******&#x27;</span>  <span class="comment"># 替换为实际的用户名</span></span><br><span class="line">password = <span class="string">&#x27;******&#x27;</span>  <span class="comment"># 替换为实际的密码</span></span><br><span class="line">url = <span class="string">&#x27;https://ip/SDCAPI/V1.0/Storage/Snapshot/SnapAction&#x27;</span></span><br><span class="line">uuid = <span class="string">&quot;a234feaf-7751-99fa-72b1-9d8357e6d26f&quot;</span>  <span class="comment"># 替换为实际的 UUID</span></span><br><span class="line"></span><br><span class="line">payload = json.dumps(&#123;<span class="string">&quot;UUID&quot;</span>: uuid&#125;)</span><br><span class="line">headers = &#123;</span><br><span class="line">    <span class="string">&#x27;Content-Type&#x27;</span>: <span class="string">&#x27;application/json&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">response = requests.post(url, auth=requests.auth.HTTPDigestAuth(username, password), headers=headers, data=payload, verify=<span class="literal">False</span>)</span><br></pre></td></tr></table></figure><p>其中，<code>url</code> 是华为摄像头的 API 地址，<code>uuid</code> 是需要抓拍的摄像头的 UUID。<code>requests.post</code> 函数发送 POST 请求，并使用 HTTP Digest Authentication 认证方式。</p><h2 id="解析返回的数据"><a href="#解析返回的数据" class="headerlink" title="解析返回的数据"></a>解析返回的数据</h2><p>华为摄像头返回的数据是 multipart 格式的，需要进行解析，提取图片数据。以下是示例代码：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> io</span><br><span class="line"></span><br><span class="line">username = <span class="string">&#x27;******&#x27;</span>  <span class="comment"># 替换为实际的用户名</span></span><br><span class="line">password = <span class="string">&#x27;******&#x27;</span>  <span class="comment"># 替换为实际的密码</span></span><br><span class="line">url = <span class="string">&#x27;https://ip/SDCAPI/V1.0/Storage/Snapshot/SnapAction&#x27;</span></span><br><span class="line">uuid = <span class="string">&quot;a234feaf-7751-99fa-72b1-9d8357e6d26f&quot;</span>  <span class="comment"># 替换为实际的 UUID</span></span><br><span class="line"></span><br><span class="line">payload = json.dumps(&#123;<span class="string">&quot;UUID&quot;</span>: uuid&#125;)</span><br><span class="line">headers = &#123;</span><br><span class="line">    <span class="string">&#x27;Content-Type&#x27;</span>: <span class="string">&#x27;application/json&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">response = requests.post(url, auth=requests.auth.HTTPDigestAuth(username, password), headers=headers, data=payload, verify=<span class="literal">False</span>)</span><br><span class="line"></span><br><span class="line">response_content = response.content</span><br><span class="line">image_data = re.findall(<span class="string">b&#x27;charset=UTF-8\r\n\r\n(.*?)\r\n--&#x27;</span>, response_content, re.DOTALL)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> image_data:</span><br><span class="line">    image_file = io.BytesIO(image_data[<span class="number">0</span>])</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;image.jpg&#x27;</span>, <span class="string">&#x27;wb&#x27;</span>) <span class="keyword">as</span> file:</span><br><span class="line">        file.write(image_file.read())</span><br></pre></td></tr></table></figure><p>使用 <code>re.findall</code> 函数和正则表达式，提取图片部分的数据。最后，将图片数据写入文件中。</p><p>至此，我们已经完成了如何使用 Python 抓取华为摄像头的抓拍图片的介绍。</p>]]></content>
      
      
      <categories>
          
          <category> Python开发 </category>
          
          <category> 视频监控 </category>
          
          <category> API集成 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Python </tag>
            
            <tag> API开发 </tag>
            
            <tag> 华为摄像头 </tag>
            
            <tag> HTTP认证 </tag>
            
            <tag> 图像处理 </tag>
            
            <tag> Requests库 </tag>
            
            <tag> 数据解析 </tag>
            
            <tag> 监控系统 </tag>
            
            <tag> 视频监控 </tag>
            
            <tag> 系统集成 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>基于Node.js实现Minio对象存储的图片自动压缩服务</title>
      <link href="/2023/02/03/Minio%E5%AF%B9%E8%B1%A1%E5%AD%98%E5%82%A8%E4%B8%AD%E5%9B%BE%E7%89%87%E5%8E%8B%E7%BC%A9/"/>
      <url>/2023/02/03/Minio%E5%AF%B9%E8%B1%A1%E5%AD%98%E5%82%A8%E4%B8%AD%E5%9B%BE%E7%89%87%E5%8E%8B%E7%BC%A9/</url>
      
        <content type="html"><![CDATA[<blockquote><p>利用 Minio 的通知功能，在有图片上传后，通知到 Nodejs 服务，压缩图片再上传</p></blockquote><h2 id="项目地址"><a href="#项目地址" class="headerlink" title="项目地址"></a>项目地址</h2><p><a href="https://github.com/houxiaozhao/minio-compresses-images">https://github.com/houxiaozhao/minio-compresses-images</a></p><h2 id="主要使用的库"><a href="#主要使用的库" class="headerlink" title="主要使用的库"></a>主要使用的库</h2><ul><li>minio - Minio 的 Nodejs 客户端</li><li>sharp - 图片压缩库</li><li>koa - Nodejs 的 web 框架</li><li>bull - Nodejs 的队列库</li></ul><h2 id="流程"><a href="#流程" class="headerlink" title="流程"></a>流程</h2><p><img src="https://cdn.jsdelivr.net/gh/houxiaozhao/imageLibrary@master/uPic/2023/02/03/a2cD9s.jpg" alt="a2cD9s"></p><p>因为 sharp 的处理图片速度比较慢，所以使用了队列，将图片压缩的任务放到队列中，然后再从队列中取出任务，进行压缩。</p><h2 id="主要压缩的代码"><a href="#主要压缩的代码" class="headerlink" title="主要压缩的代码"></a>主要压缩的代码</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> minioClient = <span class="keyword">new</span> minio.<span class="title class_">Client</span>(config.<span class="property">minio</span>);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">time</span>(job.<span class="property">id</span> + <span class="string">&quot;流处理时间&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> readable = <span class="keyword">await</span> minioClient.<span class="title function_">getObject</span>(bucket, key);</span><br><span class="line"><span class="keyword">const</span> pipeline = <span class="title function_">sharp</span>(&#123; <span class="attr">unlimited</span>: <span class="literal">true</span>, <span class="attr">sequentialRead</span>: <span class="literal">true</span> &#125;).<span class="title function_">jpeg</span>(&#123; <span class="attr">quality</span>: config.<span class="property">quality</span> &#125;);</span><br><span class="line">readable.<span class="title function_">pipe</span>(pipeline);</span><br><span class="line"><span class="keyword">await</span> minioClient.<span class="title function_">putObject</span>(bucket, config.<span class="property">cover</span> ? key : path.<span class="title function_">basename</span>(key, path.<span class="title function_">extname</span>(key)) + <span class="string">&quot;_mini&quot;</span> + path.<span class="title function_">extname</span>(key), pipeline, &#123; <span class="string">&quot;Content-Type&quot;</span>: <span class="string">&quot;image/jpeg&quot;</span>, <span class="attr">mini</span>: <span class="string">&quot;true&quot;</span> &#125;);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">timeEnd</span>(job.<span class="property">id</span> + <span class="string">&quot;流处理时间&quot;</span>);</span><br></pre></td></tr></table></figure><h2 id="优化整个流程速度的几个重要的点"><a href="#优化整个流程速度的几个重要的点" class="headerlink" title="优化整个流程速度的几个重要的点"></a>优化整个流程速度的几个重要的点</h2><ol><li>使用流的方式读取图片，然后再写入到 Minio 中，这样可以减少内存的使用，不产生临时文件</li><li>sharp 添加 sequentialRead: true，这样可以让 sharp 顺序读取图片</li><li>使用队列，将图片压缩的任务放到队列中，然后再从队列中取出任务，进行压缩，这样可以让压缩图片的任务不会阻塞其他任务</li><li>不使用 docker 部署 minio，而是直接使用 minio 的二进制文件，这样可以减少网络延迟</li><li>适当提高 bull 的并发数，这样可以让队列中的任务更快的被处理</li></ol><h2 id="Minio-部署和配置"><a href="#Minio-部署和配置" class="headerlink" title="Minio 部署和配置"></a>Minio 部署和配置</h2><h3 id="Minio-部署"><a href="#Minio-部署" class="headerlink" title="Minio 部署"></a>Minio 部署</h3><p>下载二进制文件，然后执行</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">MINIO_ROOT_USER=username MINIO_ROOT_PASSWORD=password minio server /data/minio --console-address <span class="string">&quot;:9001&quot;</span></span><br></pre></td></tr></table></figure><h3 id="使用-minio-中的-listenBucketNotification-功能监听"><a href="#使用-minio-中的-listenBucketNotification-功能监听" class="headerlink" title="使用 minio 中的 listenBucketNotification 功能监听"></a>使用 minio 中的 listenBucketNotification 功能监听</h3><p>不需要配置通知，直接使用 listenBucketNotification 功能监听</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> poller = minioClient.<span class="title function_">listenBucketNotification</span>(config.<span class="property">minio</span>.<span class="property">bucket</span>, <span class="string">&quot;&quot;</span>, <span class="string">&quot;&quot;</span>, [<span class="string">&quot;s3:ObjectCreated:Put&quot;</span>]);</span><br></pre></td></tr></table></figure><h3 id="Minio-配置通知-Notification"><a href="#Minio-配置通知-Notification" class="headerlink" title="Minio 配置通知 Notification"></a><del>Minio 配置通知 Notification</del></h3><ol><li><del>点击<code>Add Notification Target</code></del><br><img src="https://cdn.jsdelivr.net/gh/houxiaozhao/imageLibrary@master/uPic/2023/02/03/tDIPYO.png" alt="tDIPYO"></li><li><del>有很多通知类型，我们选择<code>Webhook</code></del><br><img src="https://cdn.jsdelivr.net/gh/houxiaozhao/imageLibrary@master/uPic/2023/02/03/E43e23.png" alt="E43e23"></li><li><del>填写<code>Webhook</code>的地址，这里填写的是 Nodejs 服务的地址,其他留空即可</del><br><img src="https://cdn.jsdelivr.net/gh/houxiaozhao/imageLibrary@master/uPic/2023/02/03/zlIxax.png" alt="zlIxax"></li><li><del>保存</del></li></ol><h3 id="创建和配置存储桶"><a href="#创建和配置存储桶" class="headerlink" title="创建和配置存储桶"></a>创建和配置存储桶</h3><ol><li>点击<code>Create Bucket</code><br><img src="https://cdn.jsdelivr.net/gh/houxiaozhao/imageLibrary@master/uPic/2023/02/03/gwYWn3.png" alt="gwYWn3"></li><li>起一个名字，其他不用改</li><li><del>创建成功后，点击刚创建的存储桶，然后点击<code>Event</code>,最后点击<code>Subscribe to Event</code></del><br><img src="https://cdn.jsdelivr.net/gh/houxiaozhao/imageLibrary@master/uPic/2023/02/03/k1Zbnd.png" alt="k1Zbnd"></li><li><del>RAN 里选择 webhook,其他看情况修改,最后点击<code>Save</code></del><br><img src="https://cdn.jsdelivr.net/gh/houxiaozhao/imageLibrary@master/uPic/2023/02/03/9NzU5c.png" alt="9NzU5c"></li></ol><h2 id="Nodejs-服务部署和配置"><a href="#Nodejs-服务部署和配置" class="headerlink" title="Nodejs 服务部署和配置"></a>Nodejs 服务部署和配置</h2><h3 id="安装依赖"><a href="#安装依赖" class="headerlink" title="安装依赖"></a>安装依赖</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install</span><br></pre></td></tr></table></figure><h3 id="配置"><a href="#配置" class="headerlink" title="配置"></a>配置</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// config.js</span></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = &#123;</span><br><span class="line">  <span class="attr">redis</span>: &#123;</span><br><span class="line">    <span class="attr">port</span>: <span class="number">6379</span>,</span><br><span class="line">    <span class="attr">host</span>: <span class="string">&quot;localhost&quot;</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">minio</span>: &#123;</span><br><span class="line">    <span class="attr">endPoint</span>: <span class="string">&quot;localhost&quot;</span>,</span><br><span class="line">    <span class="attr">port</span>: <span class="number">9000</span>,</span><br><span class="line">    <span class="attr">useSSL</span>: <span class="literal">false</span>,</span><br><span class="line">    <span class="attr">secretKey</span>: <span class="string">&quot;xxx&quot;</span>,</span><br><span class="line">    <span class="attr">accessKey</span>: <span class="string">&quot;xxx&quot;</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">quality</span>: <span class="number">30</span>, <span class="comment">// 图片质量</span></span><br><span class="line">  <span class="attr">cover</span>: <span class="literal">false</span>, <span class="comment">// 是否覆盖原图,默认不覆盖在原图名字后面加上_mini</span></span><br><span class="line">  <span class="attr">bull_concurrency</span>: <span class="number">1</span>, <span class="comment">// bull任务并发数</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h3 id="启动"><a href="#启动" class="headerlink" title="启动"></a>启动</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">node app.js</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 后端开发 </category>
          
          <category> 云存储 </category>
          
          <category> 性能优化 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Node.js </tag>
            
            <tag> 性能优化 </tag>
            
            <tag> Minio </tag>
            
            <tag> 图片压缩 </tag>
            
            <tag> 对象存储 </tag>
            
            <tag> Sharp </tag>
            
            <tag> Bull </tag>
            
            <tag> 队列处理 </tag>
            
            <tag> 云服务 </tag>
            
            <tag> 服务端开发 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Node.js中Buffer和Stream的高效转换：提升数据处理性能</title>
      <link href="/2023/02/02/Nodejs%E4%B8%ADBuffer%E5%92%8CStream%E4%BA%92%E8%BD%AC/"/>
      <url>/2023/02/02/Nodejs%E4%B8%ADBuffer%E5%92%8CStream%E4%BA%92%E8%BD%AC/</url>
      
        <content type="html"><![CDATA[<h3 id="Stream-to-Buffer"><a href="#Stream-to-Buffer" class="headerlink" title="Stream to Buffer"></a>Stream to Buffer</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">streamToBuffer</span>(<span class="params">stream</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">let</span> buffers = [];</span><br><span class="line">    stream.<span class="title function_">on</span>(<span class="string">&quot;error&quot;</span>, reject);</span><br><span class="line">    stream.<span class="title function_">on</span>(<span class="string">&quot;data&quot;</span>, <span class="function"><span class="params">data</span> =&gt;</span> buffers.<span class="title function_">push</span>(data));</span><br><span class="line">    stream.<span class="title function_">on</span>(<span class="string">&quot;end&quot;</span>, <span class="function">() =&gt;</span> <span class="title function_">resolve</span>(<span class="title class_">Buffer</span>.<span class="title function_">concat</span>(buffers)));</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="Buffer-to-Stream"><a href="#Buffer-to-Stream" class="headerlink" title="Buffer to Stream"></a>Buffer to Stream</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> <span class="title class_">Duplex</span> = <span class="built_in">require</span>(<span class="string">&quot;stream&quot;</span>).<span class="property">Duplex</span>;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">bufferToStream</span>(<span class="params">buffer</span>) &#123;</span><br><span class="line">  <span class="keyword">let</span> stream = <span class="keyword">new</span> <span class="title class_">Duplex</span>();</span><br><span class="line">  stream.<span class="title function_">push</span>(buffer);</span><br><span class="line">  stream.<span class="title function_">push</span>(<span class="literal">null</span>);</span><br><span class="line">  <span class="keyword">return</span> stream;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 后端开发 </category>
          
          <category> Node.js </category>
          
          <category> 性能优化 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> JavaScript </tag>
            
            <tag> Node.js </tag>
            
            <tag> 性能优化 </tag>
            
            <tag> Buffer </tag>
            
            <tag> Stream </tag>
            
            <tag> 数据处理 </tag>
            
            <tag> 内存优化 </tag>
            
            <tag> 后端开发 </tag>
            
            <tag> 文件处理 </tag>
            
            <tag> IO操作 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Hexo静态博客搭建与部署：从本地开发到云端发布</title>
      <link href="/2023/01/30/Hexo%E5%8D%9A%E5%AE%A2%E6%A1%86%E6%9E%B6%E4%BB%8B%E7%BB%8D%E5%92%8C%E4%BD%BF%E7%94%A8%E9%83%A8%E7%BD%B2/"/>
      <url>/2023/01/30/Hexo%E5%8D%9A%E5%AE%A2%E6%A1%86%E6%9E%B6%E4%BB%8B%E7%BB%8D%E5%92%8C%E4%BD%BF%E7%94%A8%E9%83%A8%E7%BD%B2/</url>
      
        <content type="html"><![CDATA[<blockquote><p>官网介绍：快速、简介且高效的博客框架</p></blockquote><blockquote><p>基于 Node.js 的静态博客框架，可以方便的生成静态网页托管在 GitHub 上</p></blockquote><h4 id="特点"><a href="#特点" class="headerlink" title="特点"></a>特点</h4><ol><li>速度很快，上百个页面在几秒内完成渲染</li><li>一键部署，可以链接 github，一键部署到 github page</li><li>插件和可扩展</li></ol><h2 id="快速开始"><a href="#快速开始" class="headerlink" title="快速开始"></a>快速开始</h2><h4 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h4><ul><li><p>安装 hexo 命令行工具</p><p>npm install hexo-cli -g</p></li><li><p>使用命令行工具初始化</p><p>hexo init blog</p></li><li><p>安装依赖</p><p>npm install</p></li><li><p>运行</p><p>hexo server</p></li></ul><p><img src="https://cdn.jsdelivr.net/gh/houxiaozhao/imageLibrary@master/uPic/2023/09/04/qE8uZj.png" alt="qE8uZj"></p><h4 id="配置网站信息"><a href="#配置网站信息" class="headerlink" title="配置网站信息"></a>配置网站信息</h4><p>打开_config.yml</p><p>可以配置网站标题、作者、语言等。</p><h4 id="新建一篇文章"><a href="#新建一篇文章" class="headerlink" title="新建一篇文章"></a>新建一篇文章</h4><p>使用命令</p><pre><code>hexo new &lt;title&gt;</code></pre><p>然后在 source&#x2F;_posts 目录下会生成一个 md 文档</p><h4 id="生成静态网页"><a href="#生成静态网页" class="headerlink" title="生成静态网页"></a>生成静态网页</h4><pre><code>hexo generate</code></pre><p>会生成在 public 目录下，直接部署该目录到服务器或其他位置即可</p><p>也可以上传到 github 上，利用 github page 做一个免费的网站</p><ol><li><p>创建一个仓库名字是<username>.github.io <img src="https://cdn.jsdelivr.net/gh/houxiaozhao/imageLibrary@master/uPic/2023/09/04/vmx7ie.png" alt="vmx7ie"></p></li><li><p>然后在 setting-&gt;pages 中设置<img src="https://cdn.jsdelivr.net/gh/houxiaozhao/imageLibrary@master/uPic/2023/09/04/uQacfl.png" alt="uQacfl"></p></li><li><p>把静态网页传到 github 上。</p></li><li><p><a href="https://houxiaozhao.github.io/"><strong>https:&#x2F;&#x2F;<username>.github.io&#x2F;</strong></a></p></li><li><p><strong>进阶：</strong></p><ol><li><strong>使用 github 的 workflow 功能自动编译生成，变以后自动更新静态页面到其他分支，然后在 pages 设置其他分支</strong></li><li><strong>因为 github 经常会不通。可以使用</strong>cloudflare<strong>进行加速。利用 cloudflare pages 功能，直接自动部署到 cloudflare 上。会给一个免费的域名可以访问</strong><username>-github-io.pages.dev <strong>​</strong><img src="https://cdn.jsdelivr.net/gh/houxiaozhao/imageLibrary@master/uPic/2023/09/04/saaCp9.png" alt="saaCp9"></li><li><strong>使用自己的域名 DNS 配置 CNAME 到免费域名</strong><img src="https://cdn.jsdelivr.net/gh/houxiaozhao/imageLibrary@master/uPic/2023/09/04/FENI8H.png" alt="FENI8H"></li></ol></li></ol><h4 id="使用主题"><a href="#使用主题" class="headerlink" title="使用主题"></a>使用主题</h4><p>在 github 上找到想要的主题(<a href="https://github.com/search?q=hexo+theme">https://github.com/search?q=hexo+theme</a>)，然后把主题下载下来，放到 themes 文件夹</p><h5 id="举个例子https-github-com-theme-next-hexo-theme-next"><a href="#举个例子https-github-com-theme-next-hexo-theme-next" class="headerlink" title="举个例子https://github.com/theme-next/hexo-theme-next"></a>举个例子<a href="https://github.com/theme-next/hexo-theme-next">https://github.com/theme-next/hexo-theme-next</a></h5><ol><li><p>安装主题</p><p>cd hexo<br>git clone <a href="https://github.com/theme-next/hexo-theme-next">https://github.com/theme-next/hexo-theme-next</a> themes&#x2F;next</p></li><li><p>配置主题    _config.yml</p><p>theme: next</p></li></ol><p><img src="https://cdn.jsdelivr.net/gh/houxiaozhao/imageLibrary@master/uPic/2023/09/04/OCcFnT.png" alt="OCcFnT"></p>]]></content>
      
      
      <categories>
          
          <category> 静态博客 </category>
          
          <category> 网站搭建 </category>
          
          <category> 技术教程 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Node.js </tag>
            
            <tag> Cloudflare </tag>
            
            <tag> Hexo </tag>
            
            <tag> 静态网站 </tag>
            
            <tag> GitHub Pages </tag>
            
            <tag> 博客搭建 </tag>
            
            <tag> 网站部署 </tag>
            
            <tag> 主题定制 </tag>
            
            <tag> 静态生成器 </tag>
            
            <tag> 开发教程 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Strapi构建灵活高效的Headless CMS系统</title>
      <link href="/2023/01/12/strapi%E4%BB%8B%E7%BB%8D/"/>
      <url>/2023/01/12/strapi%E4%BB%8B%E7%BB%8D/</url>
      
        <content type="html"><![CDATA[<blockquote><p>官网介绍：开源的 Headless CMS，100%  的 javascript  和完全可定制化</p></blockquote><blockquote><p>CMS：内容管理系统，比如 WordPress</p></blockquote><blockquote><p>Headless CMS :无头   内容管理系统。内容仅通过 API 进行访问，而不需要内置前端。</p></blockquote><p>可以用来创建网站，APP，API 等，可以用作后端系统管理内容，也可以配合 Vue、React 等前端技术结合使用。</p><p>即使不了解后端开发技术，也可以创建 API 接口</p><h4 id="特点"><a href="#特点" class="headerlink" title="特点"></a>特点</h4><ol><li><p>使用一个命令就可以生成后端 restfull api 服务，除了 rest，甚至还支持 graphQL API</p><p>yarn create strapi-app my-project –quickstart</p></li><li><p>可以在内置的后端管理界面对数据库进行管理。添加表后自动生成对应增删改查接口</p></li><li><p>内置的权限系统，全部数据都由权限系统控制</p></li><li><p>插件化，内置基本插件：内容管理器，api 文档，媒体库，角色权限等</p></li><li><p>自定义 API，可以使用 JavaScript 自定义 API</p></li><li><p>支持多种数据库<img src="https://cdn.jsdelivr.net/gh/houxiaozhao/imageLibrary@master/uPic/2023/09/04/e5AmI6.png" alt="e5AmI6"></p></li></ol><h3 id="快速开始"><a href="#快速开始" class="headerlink" title="快速开始"></a>快速开始</h3><h4 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h4><p>需要有 node 环境，一句命令即可安装,</p><pre><code>yarn create strapi-app my-project --quickstartnpx create-strapi-app@latest my-project</code></pre><p>安装完成后会自动打开网页<a href="http://localhost:1337/admin/auth/register-admin">http://localhost:1337/admin/auth/register-admin</a></p><h4 id="注册管理员用户"><a href="#注册管理员用户" class="headerlink" title="注册管理员用户"></a>注册管理员用户</h4><p><img src="https://cdn.jsdelivr.net/gh/houxiaozhao/imageLibrary@master/uPic/2023/09/04/W2OpTh.png" alt="W2OpTh"></p><h4 id="构建内容"><a href="#构建内容" class="headerlink" title="构建内容"></a>构建内容</h4><p>根据自己业务需求，构建一个数据结构，就相当于在数据库定义表结果</p><p>点击<strong>Content-Type Builder</strong>，然后<strong>Create a collection type</strong></p><h4 id="添加内容"><a href="#添加内容" class="headerlink" title="添加内容"></a>添加内容</h4><p>在<strong>Content Manager</strong>菜单中添加对应的内容</p><h4 id="设置权限"><a href="#设置权限" class="headerlink" title="设置权限"></a>设置权限</h4><p><strong>Setting-Roles</strong>菜单设置权限</p><h4 id="测试接口"><a href="#测试接口" class="headerlink" title="测试接口"></a>测试接口</h4><p><strong>Documentation 菜单可以查看接口文档，打开后可以进行接口测试</strong></p>]]></content>
      
      
      <categories>
          
          <category> 后端开发 </category>
          
          <category> 内容管理系统 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> JavaScript </tag>
            
            <tag> 后端 </tag>
            
            <tag> nodejs </tag>
            
            <tag> strapi </tag>
            
            <tag> Headless CMS </tag>
            
            <tag> API开发 </tag>
            
            <tag> 内容管理 </tag>
            
            <tag> Backend Development </tag>
            
            <tag> Content Management </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Utools效率工具：多功能插件平台使用指南</title>
      <link href="/2023/01/11/%E6%95%88%E7%8E%87%E5%B7%A5%E5%85%B7Utools%E4%BD%BF%E7%94%A8%E4%BB%8B%E7%BB%8D-%E4%B8%AA%E4%BA%BA%E5%90%91/"/>
      <url>/2023/01/11/%E6%95%88%E7%8E%87%E5%B7%A5%E5%85%B7Utools%E4%BD%BF%E7%94%A8%E4%BB%8B%E7%BB%8D-%E4%B8%AA%E4%BA%BA%E5%90%91/</url>
      
        <content type="html"><![CDATA[<blockquote><p>官网上介绍的是：新一代效率工具平台</p></blockquote><blockquote><p>自由组合插件应用，打造专属你的趁手工具集</p></blockquote><p>我就介绍一下我的使用经验</p><p>软件有很多插件，可以自由组合安装。</p><ol><li><p>剪贴板，使用频率最高的工具。其实世面上有不少的历史剪贴板的软件，但是 all in one 总是好的 ​ 提示：不要使用官方提供的剪贴板插件（收费）使用第三方的一个<img src="https://cdn.jsdelivr.net/gh/houxiaozhao/imageLibrary@master/uPic/2023/09/04/uEiHtA.png" alt="uEiHtA"> ​ 因为使用频率高，可以设置全局快捷键 ctrl+`</p></li><li><p>Ctool   包含程序开发的常用工具。内置工具非常丰富<br><img src="https://cdn.jsdelivr.net/gh/houxiaozhao/imageLibrary@master/uPic/2023/09/04/P2NWIf.png" alt="P2NWIf"><br>![image]<img src="https://cdn.jsdelivr.net/gh/houxiaozhao/imageLibrary@master/uPic/2023/09/04/sgfUkR.png" alt="sgfUkR"><br>这些工具都可以直接在 Utools 窗口进入<br><img src="https://cdn.jsdelivr.net/gh/houxiaozhao/imageLibrary@master/uPic/2023/09/04/q7siLf.png" alt="q7siLf"></p></li><li><p>翻译（易翻翻译）<br><img src="https://cdn.jsdelivr.net/gh/houxiaozhao/imageLibrary@master/uPic/2023/09/04/jtX3Ro.png" alt="jtX3Ro"><br>直接在 Utools 窗口输入内容，然后选择翻译即可。<br><img src="https://cdn.jsdelivr.net/gh/houxiaozhao/imageLibrary@master/uPic/2023/09/04/Yq2HoA.png" alt="Yq2HoA"><br>可以配置不同的翻译服务（需要去不用平台申请 key）<br><img src="https://cdn.jsdelivr.net/gh/houxiaozhao/imageLibrary@master/uPic/2023/09/04/hQ62Rh.png" alt="hQ62Rh"><br>甚至还有 Coding 模式，直接翻译成驼峰，下划线等风格的变量名<br><img src="https://cdn.jsdelivr.net/gh/houxiaozhao/imageLibrary@master/uPic/2023/09/04/JiBgGp.png" alt="JiBgGp"></p></li><li><p>其他常用的简单介绍</p><ol><li>局域网共享文件<img src="https://cdn.jsdelivr.net/gh/houxiaozhao/imageLibrary@master/uPic/2023/09/04/A9GKFC.png" alt="A9GKFC"></li><li>备忘快贴<img src="https://cdn.jsdelivr.net/gh/houxiaozhao/imageLibrary@master/uPic/2023/09/04/L5EWpy.png" alt="L5EWpy"></li><li>计算稿纸<img src="https://cdn.jsdelivr.net/gh/houxiaozhao/imageLibrary@master/uPic/2023/09/04/amJRzV.png" alt="amJRzV"></li><li>网页快开<img src="https://cdn.jsdelivr.net/gh/houxiaozhao/imageLibrary@master/uPic/2023/09/04/onJBcC.png" alt="onJBcC"></li><li>颜色助手<img src="https://cdn.jsdelivr.net/gh/houxiaozhao/imageLibrary@master/uPic/2023/09/04/UZuxD0.png" alt="UZuxD0"></li></ol></li></ol>]]></content>
      
      
      <categories>
          
          <category> 效率工具 </category>
          
          <category> 软件应用 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 效率工具 </tag>
            
            <tag> 生产力工具 </tag>
            
            <tag> Utools </tag>
            
            <tag> 开发工具 </tag>
            
            <tag> 工具插件 </tag>
            
            <tag> 软件教程 </tag>
            
            <tag> 工作效率 </tag>
            
            <tag> 程序开发 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>国密算法实践：基于SM2/SM3/SM4的前后端加密通信方案</title>
      <link href="/2022/11/09/%E5%89%8D%E5%90%8E%E7%AB%AF%E5%AF%86%E9%92%A5%E4%BC%A0%E8%BE%93%E5%92%8C%E6%95%B0%E6%8D%AE%E5%8A%A0%E5%AF%86(%E5%9B%BD%E5%AF%86SM2%E3%80%81SM3%E3%80%81SM4)%E6%B5%81%E7%A8%8B%E5%AE%9E%E8%B7%B5/"/>
      <url>/2022/11/09/%E5%89%8D%E5%90%8E%E7%AB%AF%E5%AF%86%E9%92%A5%E4%BC%A0%E8%BE%93%E5%92%8C%E6%95%B0%E6%8D%AE%E5%8A%A0%E5%AF%86(%E5%9B%BD%E5%AF%86SM2%E3%80%81SM3%E3%80%81SM4)%E6%B5%81%E7%A8%8B%E5%AE%9E%E8%B7%B5/</url>
      
        <content type="html"><![CDATA[<h2 id="加密算法介绍"><a href="#加密算法介绍" class="headerlink" title="加密算法介绍"></a><strong>加密算法介绍</strong></h2><h3 id="非对称密码算法-SM2"><a href="#非对称密码算法-SM2" class="headerlink" title="非对称密码算法 SM2"></a>非对称密码算法 SM2</h3><p>SM2 椭圆曲线公钥密码算法是我国自主设计的公钥密码算法，包括 SM2-1 椭圆曲线数字签名算法，SM2-2 椭圆曲线密钥交换协议，SM2-3 椭圆曲线公钥加密算法，分别用于实现数字签名密钥协商和数据加密等功能。</p><h3 id="对称密码算法-SM4"><a href="#对称密码算法-SM4" class="headerlink" title="对称密码算法 SM4"></a>对称密码算法 SM4</h3><p>SM3 杂凑算法是我国自主设计的密码杂凑算法，适用于商用密码应用中的数字签名和验证消息认证码的生成与验证以及随机数的生成，可满足多种密码应用的安全需求。</p><h3 id="杂凑算法-SM3"><a href="#杂凑算法-SM3" class="headerlink" title="杂凑算法 SM3"></a>杂凑算法 SM3</h3><p>SM4 分组密码算法是我国自主设计的分组对称密码算法，用于实现数据的加密&#x2F;解密运算，以保证数据和信息的机密性。</p><h2 id="密钥传输流程"><a href="#密钥传输流程" class="headerlink" title="密钥传输流程"></a>密钥传输流程</h2><p><img src="https://cdn.jsdelivr.net/gh/houxiaozhao/imageLibrary@master/uPic/2022/11/09/n4jnbc.png" alt="n4jnbc"></p><h2 id="前端到后端加密传输"><a href="#前端到后端加密传输" class="headerlink" title="前端到后端加密传输"></a><strong>前端到后端加密传输</strong></h2><h3 id="前端加密"><a href="#前端加密" class="headerlink" title="前端加密"></a><strong>前端加密</strong></h3><p>拦截前端请求，对请求中的 body 使用 SM3 计算哈希，然后把哈希值和明文数据拼接，再使用 SM2 公钥对数据进行加密传输。公式如下：<br><strong>SM2(SM3(明文)+明文)</strong></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">method</span>: payload.<span class="property">method</span>,</span><br><span class="line">    <span class="attr">url</span>: url,</span><br><span class="line">    <span class="attr">data</span>: &#123;</span><br><span class="line">    <span class="attr">data</span>: sm2.<span class="title function_">doEncrypt</span>(<span class="title function_">sm3</span>(<span class="title class_">JSON</span>.<span class="title function_">stringify</span>(payload.<span class="property">data</span>)) + <span class="title class_">JSON</span>.<span class="title function_">stringify</span>(payload.<span class="property">data</span>), pub_key, <span class="number">1</span>)&#125;,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="后端解密"><a href="#后端解密" class="headerlink" title="后端解密"></a><strong>后端解密</strong></h3><p>后端收到密文数据后先使用 SM2 私钥解密数据，分离哈希值和明文数据。计算明文数据哈希和返回包中的哈希是否一致，保证数据完整和不被篡改。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> sm3_body = sm2.<span class="title function_">doDecrypt</span>(ctx.<span class="property">request</span>.<span class="property">body</span>.<span class="property">data</span>, ctx.<span class="property">app</span>.<span class="property">config</span>.<span class="property">privateKey</span>, <span class="number">1</span>);</span><br><span class="line"><span class="keyword">const</span> body = sm3_body.<span class="title function_">substr</span>(<span class="number">64</span>);</span><br><span class="line"><span class="keyword">const</span> sm3string = sm3_body.<span class="title function_">substr</span>(<span class="number">0</span>, <span class="number">64</span>);</span><br><span class="line"><span class="keyword">const</span> sm3string2 = <span class="title function_">sm3</span>(body);</span><br><span class="line"><span class="keyword">if</span> (sm3string !== sm3string2) &#123;</span><br><span class="line">  ctx.<span class="property">body</span> = &#123; <span class="attr">errno</span>: <span class="number">401</span>, <span class="attr">errmsg</span>: <span class="string">`（<span class="subst">$&#123;ctx.request.method&#125;</span><span class="subst">$&#123;ctx.url&#125;</span>）调用接口失败`</span> &#125;;</span><br><span class="line">  <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="示例"><a href="#示例" class="headerlink" title="示例"></a>示例</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 原始包</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="string">&quot;inspectionArea&quot;</span>: <span class="string">&quot;6303401a5020b5348fdbdb8b&quot;</span>,</span><br><span class="line">    <span class="string">&quot;name&quot;</span>: <span class="string">&quot;作业名称s&quot;</span>,</span><br><span class="line">    <span class="string">&quot;recordVideo&quot;</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="string">&quot;taskType&quot;</span>: <span class="string">&quot;例行巡检&quot;</span>,</span><br><span class="line">    <span class="string">&quot;executionMode&quot;</span>: <span class="string">&quot;手动执行&quot;</span>,</span><br><span class="line">    <span class="string">&quot;flightPath&quot;</span>: <span class="string">&quot;6332be25dc7b7f4717fdd65a&quot;</span>,</span><br><span class="line">    <span class="string">&quot;executor&quot;</span>: <span class="string">&quot;6303401a5020b5348fdbdb88&quot;</span>,</span><br><span class="line">    <span class="string">&quot;content&quot;</span>: <span class="string">&quot;&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;<span class="string">&quot;inspectionArea&quot;</span>:<span class="string">&quot;6303401a5020b5348fdbdb8b&quot;</span>,<span class="string">&quot;name&quot;</span>:<span class="string">&quot;作业名称s&quot;</span>,<span class="string">&quot;recordVideo&quot;</span>:<span class="literal">true</span>,<span class="string">&quot;taskType&quot;</span>:<span class="string">&quot;例行巡检&quot;</span>,<span class="string">&quot;executionMode&quot;</span>:<span class="string">&quot;手动执行&quot;</span>,<span class="string">&quot;flightPath&quot;</span>:<span class="string">&quot;6332be25dc7b7f4717fdd65a&quot;</span>,<span class="string">&quot;executor&quot;</span>:<span class="string">&quot;6303401a5020b5348fdbdb88&quot;</span>,<span class="string">&quot;content&quot;</span>:<span class="string">&quot;&quot;</span>&#125;</span><br></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ed8380aefbcee98689027a4945bd471e18428faa3f6522f8e460a51d86cf1063;</span><br></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ed8380aefbcee98689027a4945bd471e18428faa3f6522f8e460a51d86cf1063&#123;<span class="string">&quot;inspectionArea&quot;</span>:<span class="string">&quot;6303401a5020b5348fdbdb8b&quot;</span>,<span class="string">&quot;name&quot;</span>:<span class="string">&quot;作业名称s&quot;</span>,<span class="string">&quot;recordVideo&quot;</span>:<span class="literal">true</span>,<span class="string">&quot;taskType&quot;</span>:<span class="string">&quot;例行巡检&quot;</span>,<span class="string">&quot;executionMode&quot;</span>:<span class="string">&quot;手动执行&quot;</span>,<span class="string">&quot;flightPath&quot;</span>:<span class="string">&quot;6332be25dc7b7f4717fdd65a&quot;</span>,<span class="string">&quot;executor&quot;</span>:<span class="string">&quot;6303401a5020b5348fdbdb88&quot;</span>,<span class="string">&quot;content&quot;</span>:<span class="string">&quot;&quot;</span>&#125;</span><br></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cea57760dc077f1e607de46a645b9852ae9154ff60ace3ffe4e75d5374cbecdda641c29994d8db259bd0787915addf16d651a517cb50151e03bc40365a06e94f44834afe74aff5f9542322f6da9e915b25d4ec36a64b4a6e004bc76051da6e9703d3da7674611a4124d005202cc4bf5fb0f3a07e3aaa94e2b1ed11255fdeec89ca7c6d929a71dc68d981c011f437db2447edeaef230d589709a5cde8173a41fe6a647272034dd390e5cef2269049bdd0d0d7eabf15f868c8f5edd0d6549d678053f6e3c000af86010e1cacd3556cc417bd15eb98021b64ce5706dfce7ba1b672055664c395a4b237b4deb747e562fa0bf4d0e256de11ffd04222c9d40386f0841909cea981d126104f7e3a35b9084c5dad41a44e7c46df9256f19bd487c4a349365e601cc359ee86da674dc62c16588db06272048e7692e5815ba93824190606569eca1ee0c412b525c7149db0fb45bf0698018c199fe0a892ef5d99293fcb420b0de0d6c65d3be777f08b8f6514fc9f99f669d97c657f8931207e5952639505aea4aa0d07ab497808ddb3;</span><br></pre></td></tr></table></figure><h2 id="后端到前端加密传输"><a href="#后端到前端加密传输" class="headerlink" title="后端到前端加密传输"></a><strong>后端到前端加密传输</strong></h2><h3 id="后端加密"><a href="#后端加密" class="headerlink" title="后端加密"></a><strong>后端加密</strong></h3><p>后端系统返回数据之前，对返回的明文数据 SM3 计算哈希，然后把哈希值和明文数据拼接，最后使用使用 SM4 cbc 模式加密，SM4 的 key 就是第一步前端传给后端的 key。公式如下：<br><strong>SM4(SM3(明文)+明文)</strong></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> dataStr = <span class="title class_">JSON</span>.<span class="title function_">stringify</span>(data);</span><br><span class="line"><span class="keyword">const</span> resData = sm4.<span class="title function_">encrypt</span>(<span class="title function_">sm3</span>(dataStr) + dataStr, <span class="variable language_">this</span>.<span class="property">ctx</span>.<span class="property">state</span>.<span class="property">userKey</span>, &#123; <span class="attr">mode</span>: <span class="string">&quot;cbc&quot;</span>, <span class="attr">iv</span>: <span class="variable language_">this</span>.<span class="property">ctx</span>.<span class="property">state</span>.<span class="property">iv</span> &#125;);</span><br></pre></td></tr></table></figure><h3 id="前端解密"><a href="#前端解密" class="headerlink" title="前端解密"></a><strong>前端解密</strong></h3><p>前端收到密文数据后先使用 SM4 解密，分离哈希值和明文数据。计算明文数据的哈希和返回包中的哈希是否一致，保证数据不被篡改。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> decryptData = sm4.<span class="title function_">decrypt</span>(dataAxios.<span class="property">data</span>, sm4key, &#123;</span><br><span class="line">  <span class="attr">mode</span>: <span class="string">&quot;cbc&quot;</span>,</span><br><span class="line">  <span class="attr">iv</span>: sm4iv,</span><br><span class="line">&#125;);</span><br><span class="line"><span class="keyword">const</span> sign = decryptData.<span class="title function_">substr</span>(<span class="number">0</span>, <span class="number">64</span>);</span><br><span class="line"><span class="keyword">const</span> data = decryptData.<span class="title function_">substr</span>(<span class="number">64</span>);</span><br><span class="line"><span class="keyword">if</span> (<span class="title function_">sm3</span>(data).<span class="title function_">toString</span>() !== sign) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="title class_">Promise</span>.<span class="title function_">reject</span>(<span class="string">&quot;数据校验失败&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="示例-1"><a href="#示例-1" class="headerlink" title="示例"></a><strong>示例</strong></h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">6332c2b808d6f56244f05c81</span><br></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;6332c2b808d6f56244f05c81&quot;</span>;</span><br></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">9d86a18933d22f26acf86c5fe162139ab3f5c6a997aaec7ebc47c4af98178712</span><br></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">9d86a18933d22f26acf86c5fe162139ab3f5c6a997aaec7ebc47c4af98178712<span class="string">&quot;6332c2b808d6f56244f05c81&quot;</span></span><br></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">b34453814cbf6294bb76dbdb214f99eb55c666d70cebc760a86682771c7c82994734fa66bb6b86fe955744b6d87487b7920f358162c3b0c1745ad57f68e371cc927445096b74f9d3bd046757831a8e3152d09130cbabc4e6696b9294920b1c97;</span><br></pre></td></tr></table></figure><h2 id="后续"><a href="#后续" class="headerlink" title="后续"></a><strong>后续</strong></h2><p>除了对传输过程中的数据包进行加密解密以外，还需要一些其他手段提高系统交互中的安全性。比如</p><ul><li>使用 https 部署网站系统，利用 SSL&#x2F;TLS 来加密数据包。</li><li>使用随机数、时间戳来设计请求签名机制，保证数据完整和防止重放攻击。</li><li>等等。。。</li></ul>]]></content>
      
      
      <categories>
          
          <category> 网络安全 </category>
          
          <category> 加密技术 </category>
          
          <category> 系统开发 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 国密算法 </tag>
            
            <tag> SM2加密 </tag>
            
            <tag> SM3哈希 </tag>
            
            <tag> SM4加密 </tag>
            
            <tag> 数据安全 </tag>
            
            <tag> 密钥传输 </tag>
            
            <tag> JavaScript加密 </tag>
            
            <tag> HTTPS </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>JavaScript 3D立方体碰撞检测：基于向量运算的点位判定算法</title>
      <link href="/2022/10/14/%E6%A3%80%E6%9F%A5%E7%82%B9%E6%98%AF%E5%90%A6%E5%9C%A8%E4%BB%BB%E6%84%8F%E7%AB%8B%E6%96%B9%E4%BD%93%E5%86%85/"/>
      <url>/2022/10/14/%E6%A3%80%E6%9F%A5%E7%82%B9%E6%98%AF%E5%90%A6%E5%9C%A8%E4%BB%BB%E6%84%8F%E7%AB%8B%E6%96%B9%E4%BD%93%E5%86%85/</url>
      
        <content type="html"><![CDATA[<blockquote><p>立方体由 p0,p1,p2,p3 定义<br><img src="https://cdn.jsdelivr.net/gh/houxiaozhao/imageLibrary@master/uPic/2022/10/14/iHioGf.png" alt="iHioGf"></p></blockquote><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Vector3</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params">x = <span class="number">0</span>, y = <span class="number">0</span>, z = <span class="number">0</span></span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">x</span> = x;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">y</span> = y;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">z</span> = z;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="title function_">sub</span>(<span class="params">v</span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">x</span> -= v.<span class="property">x</span>;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">y</span> -= v.<span class="property">y</span>;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">z</span> -= v.<span class="property">z</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable language_">this</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="title function_">dot</span>(<span class="params">v</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">x</span> * v.<span class="property">x</span> + <span class="variable language_">this</span>.<span class="property">y</span> * v.<span class="property">y</span> + <span class="variable language_">this</span>.<span class="property">z</span> * v.<span class="property">z</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">boxTest</span>(<span class="params">p0, p1, p2, p3, pv</span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> i = p1.<span class="title function_">sub</span>(p0);</span><br><span class="line">  <span class="keyword">const</span> j = p2.<span class="title function_">sub</span>(p0);</span><br><span class="line">  <span class="keyword">const</span> k = p3.<span class="title function_">sub</span>(p0);</span><br><span class="line">  <span class="keyword">const</span> v = pv.<span class="title function_">sub</span>(p0);</span><br><span class="line">  <span class="keyword">if</span> (v.<span class="title function_">dot</span>(i) &gt; <span class="number">0</span> &amp;&amp; v.<span class="title function_">dot</span>(i) &lt; i.<span class="title function_">dot</span>(i) &amp;&amp; v.<span class="title function_">dot</span>(j) &gt; <span class="number">0</span> &amp;&amp; v.<span class="title function_">dot</span>(j) &lt; j.<span class="title function_">dot</span>(j) &amp;&amp; v.<span class="title function_">dot</span>(k) &gt; <span class="number">0</span> &amp;&amp; v.<span class="title function_">dot</span>(k) &lt; k.<span class="title function_">dot</span>(k)) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> p0 = <span class="keyword">new</span> <span class="title class_">Vector3</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line"><span class="keyword">const</span> p1 = <span class="keyword">new</span> <span class="title class_">Vector3</span>(<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line"><span class="keyword">const</span> p2 = <span class="keyword">new</span> <span class="title class_">Vector3</span>(<span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>);</span><br><span class="line"><span class="keyword">const</span> p3 = <span class="keyword">new</span> <span class="title class_">Vector3</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">3</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> pv = <span class="keyword">new</span> <span class="title class_">Vector3</span>(<span class="number">0.5</span>, <span class="number">0.5</span>, <span class="number">0.5</span>);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title function_">boxTest</span>(p0, p1, p2, p3, pv));</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 前端开发 </category>
          
          <category> 3D图形计算 </category>
          
          <category> 数学算法 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> JavaScript </tag>
            
            <tag> 3D数学 </tag>
            
            <tag> 碰撞检测 </tag>
            
            <tag> 空间几何 </tag>
            
            <tag> 向量计算 </tag>
            
            <tag> 数学应用 </tag>
            
            <tag> Vector3 </tag>
            
            <tag> 立方体检测 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>JavaScript 3D空间计算：实现点到圆柱体的碰撞检测算法</title>
      <link href="/2022/09/07/%E6%A3%80%E6%9F%A5%E7%82%B9%E6%98%AF%E5%90%A6%E5%9C%A8%E4%BB%BB%E6%84%8F%E5%9C%86%E6%9F%B1%E4%BD%93%E5%86%85/"/>
      <url>/2022/09/07/%E6%A3%80%E6%9F%A5%E7%82%B9%E6%98%AF%E5%90%A6%E5%9C%A8%E4%BB%BB%E6%84%8F%E5%9C%86%E6%9F%B1%E4%BD%93%E5%86%85/</url>
      
        <content type="html"><![CDATA[<blockquote><p><a href="https://www.flipcode.com/archives/Fast_Point-In-Cylinder_Test.shtml">https://www.flipcode.com/archives/Fast_Point-In-Cylinder_Test.shtml</a></p></blockquote><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">cylTest</span>(<span class="params">pt1, pt2, radius, testpt</span>) &#123;</span><br><span class="line">  <span class="keyword">let</span> dx, dy, dz; <span class="comment">// vector d  from line segment point 1 to point 2</span></span><br><span class="line">  <span class="keyword">let</span> pdx, pdy, pdz; <span class="comment">// vector pd from point 1 to test point</span></span><br><span class="line">  <span class="keyword">let</span> dot, dsq;</span><br><span class="line">  <span class="keyword">let</span> length_sq = <span class="title class_">Math</span>.<span class="title function_">pow</span>(pt1.<span class="property">x</span> - pt2.<span class="property">x</span>, <span class="number">2</span>) + <span class="title class_">Math</span>.<span class="title function_">pow</span>(pt1.<span class="property">y</span> - pt2.<span class="property">y</span>, <span class="number">2</span>) + <span class="title class_">Math</span>.<span class="title function_">pow</span>(pt1.<span class="property">z</span> - pt2.<span class="property">z</span>, <span class="number">2</span>);</span><br><span class="line">  <span class="keyword">let</span> radius_sq = <span class="title class_">Math</span>.<span class="title function_">pow</span>(radius, <span class="number">2</span>);</span><br><span class="line">  dx = pt2.<span class="property">x</span> - pt1.<span class="property">x</span>; <span class="comment">// translate so pt1 is origin.  Make vector from</span></span><br><span class="line">  dy = pt2.<span class="property">y</span> - pt1.<span class="property">y</span>; <span class="comment">// pt1 to pt2.  Need for this is easily eliminated</span></span><br><span class="line">  dz = pt2.<span class="property">z</span> - pt1.<span class="property">z</span>;</span><br><span class="line"></span><br><span class="line">  pdx = testpt.<span class="property">x</span> - pt1.<span class="property">x</span>; <span class="comment">// vector from pt1 to test point.</span></span><br><span class="line">  pdy = testpt.<span class="property">y</span> - pt1.<span class="property">y</span>;</span><br><span class="line">  pdz = testpt.<span class="property">z</span> - pt1.<span class="property">z</span>;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// Dot the d and pd vectors to see if point lies behind the</span></span><br><span class="line">  <span class="comment">// cylinder cap at pt1.x, pt1.y, pt1.z</span></span><br><span class="line">  dot = pdx * dx + pdy * dy + pdz * dz;</span><br><span class="line">  <span class="comment">// If dot is less than zero the point is behind the pt1 cap.</span></span><br><span class="line">  <span class="comment">// If greater than the cylinder axis line segment length squared</span></span><br><span class="line">  <span class="comment">// then the point is outside the other end cap at pt2.</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (dot &lt; <span class="number">0.0</span> || dot &gt; length_sq) &#123;</span><br><span class="line">    <span class="keyword">return</span> -<span class="number">1.0</span>;</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="comment">// Point lies within the parallel caps, so find</span></span><br><span class="line">    <span class="comment">// distance squared from point to line, using the fact that sin^2 + cos^2 = 1</span></span><br><span class="line">    <span class="comment">// the dot = cos() * |d||pd|, and cross*cross = sin^2 * |d|^2 * |pd|^2</span></span><br><span class="line">    <span class="comment">// Carefull: &#x27;*&#x27; means mult for scalars and dotproduct for vectors</span></span><br><span class="line">    <span class="comment">// In short, where dist is pt distance to cyl axis:</span></span><br><span class="line">    <span class="comment">// dist = sin( pd to d ) * |pd|</span></span><br><span class="line">    <span class="comment">// distsq = dsq = (1 - cos^2( pd to d)) * |pd|^2</span></span><br><span class="line">    <span class="comment">// dsq = ( 1 - (pd * d)^2 / (|pd|^2 * |d|^2) ) * |pd|^2</span></span><br><span class="line">    <span class="comment">// dsq = pd * pd - dot * dot / lengthsq</span></span><br><span class="line">    <span class="comment">//  where lengthsq is d*d or |d|^2 that is passed into this function</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// distance squared to the cylinder axis:</span></span><br><span class="line"></span><br><span class="line">    dsq = pdx * pdx + pdy * pdy + pdz * pdz - (dot * dot) / length_sq;</span><br><span class="line">    <span class="keyword">if</span> (dsq &gt; radius_sq) &#123;</span><br><span class="line">      <span class="keyword">return</span> -<span class="number">1.0</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="keyword">return</span> dsq; <span class="comment">// return distance squared to axis</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 前端开发 </category>
          
          <category> 3D图形计算 </category>
          
          <category> 数学算法 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> JavaScript </tag>
            
            <tag> 性能优化 </tag>
            
            <tag> 3D数学 </tag>
            
            <tag> 图形编程 </tag>
            
            <tag> 碰撞检测 </tag>
            
            <tag> 空间几何 </tag>
            
            <tag> 向量计算 </tag>
            
            <tag> 数学应用 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>浏览器后台定时器优化：使用 Momentum.js 解决降频问题</title>
      <link href="/2022/08/17/%E8%A7%A3%E5%86%B3%E6%B5%8F%E8%A7%88%E5%99%A8%E5%9C%A8%E5%90%8E%E5%8F%B0%E6%97%B6%E5%AE%9A%E6%97%B6%E5%99%A8%E9%99%8D%E9%A2%91%E9%97%AE%E9%A2%98/"/>
      <url>/2022/08/17/%E8%A7%A3%E5%86%B3%E6%B5%8F%E8%A7%88%E5%99%A8%E5%9C%A8%E5%90%8E%E5%8F%B0%E6%97%B6%E5%AE%9A%E6%97%B6%E5%99%A8%E9%99%8D%E9%A2%91%E9%97%AE%E9%A2%98/</url>
      
        <content type="html"><![CDATA[<blockquote><p><a href="https://github.com/myonov/momentum">https://github.com/myonov/momentum</a></p></blockquote><p>引入 momentum.js,正常使用 setInterval, clearInterval, setTimeout, clearTimeout 方法</p><p><img src="https://cdn.jsdelivr.net/gh/houxiaozhao/imageLibrary@master/uPic/2022/08/17/FQzazg.png" alt="FQzazg"></p>]]></content>
      
      
      <categories>
          
          <category> 前端开发 </category>
          
          <category> 浏览器优化 </category>
          
          <category> JavaScript </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 性能优化 </tag>
            
            <tag> 前端开发 </tag>
            
            <tag> 定时器优化 </tag>
            
            <tag> JavaScript 性能 </tag>
            
            <tag> 浏览器后台 </tag>
            
            <tag> Momentum.js </tag>
            
            <tag> setInterval </tag>
            
            <tag> setTimeout </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>国密算法应用：前后端加密通信与数据签名实现</title>
      <link href="/2022/07/21/%E5%AF%86%E9%92%A5%E4%BC%A0%E8%BE%93%E5%92%8C%E7%AD%BE%E5%90%8D%E5%8A%A0%E5%AF%86%E6%B5%81%E7%A8%8B%EF%BC%88%E5%9B%BD%E5%AF%86%EF%BC%89/"/>
      <url>/2022/07/21/%E5%AF%86%E9%92%A5%E4%BC%A0%E8%BE%93%E5%92%8C%E7%AD%BE%E5%90%8D%E5%8A%A0%E5%AF%86%E6%B5%81%E7%A8%8B%EF%BC%88%E5%9B%BD%E5%AF%86%EF%BC%89/</url>
      
        <content type="html"><![CDATA[<h3 id="密钥传输流程"><a href="#密钥传输流程" class="headerlink" title="密钥传输流程"></a>密钥传输流程</h3><ol><li><p>系统内置一套公钥和私钥</p></li><li><p>打开前端时自动获取其中公钥(公钥不需要加密)</p></li><li><p>前端随机生成一个 sm4 的 key 和 iv，使用公钥对 key 和 iv 进行加密，传到后台 <strong>（已加密）</strong>，后台使用私钥解密能拿到原始 key 和 iv,<del>然后在生成一套公私钥</del>，key、iv 和<del>公钥</del>存到 redis 中。每个用户的 key、iv <del>和公私钥</del>都是不一样的，重新打开页面也会重新生成 key、iv <del>和公私钥</del>。<del>私钥使用 sm4 的 cbc 模式加密后传给前端已加密</del>。</p></li><li><p><del>前端再使用刚才随机生成的 key 和 iv 解密拿到私钥。前端使用这个私钥对请求进行签名</del>。</p></li></ol><br/><h3 id="前端向后端加密传输"><a href="#前端向后端加密传输" class="headerlink" title="前端向后端加密传输"></a>前端向后端加密传输</h3><ol><li><p><del>前端拦截请求，对请求中 body 使用 sm2 的公钥加密或使用 sm4 cbc 模式加密（目前使用的 sm2 加密）</del></p></li><li><p><del>后端收到请求后，在验签之前使用私钥把 body 数据解密，然后再验签。</del></p></li><li><p>前端拦截请求，对请求中 body 先使用 sm3 计算哈希，然后把哈希值和明文数据拼接后，使用 sm2 公钥加密或使用 sm4 cbc 模式加密（目前使用的 sm2 加密）</p></li><li><p>后端收到请求后，在验签之前使用私钥把 body 数据解密，然后验证 sm3 哈希是否正确，最好在验签。</p></li></ol><h3 id="后端向前端加密传输"><a href="#后端向前端加密传输" class="headerlink" title="后端向前端加密传输"></a>后端向前端加密传输</h3><ol><li>后端接口返回之前，对返回数据使用 sm2 公钥加密或使用 sm4 cbc 模式加密（目前使用 sm4 cbc）</li><li>使用 sm2 私钥对数据签名</li><li>前端后端返回数据后，先用 sm2 公钥验证签名，然后再对数据进行解密后使用。</li></ol><h3 id="请求签名流程"><a href="#请求签名流程" class="headerlink" title="请求签名流程"></a>请求签名流程</h3><p>使用上一步拿到的私钥进行签名</p><h4 id="前端"><a href="#前端" class="headerlink" title="前端"></a>前端</h4><ol><li>获取当前时间戳</li><li>生成随机字符串</li><li>合并请求参数、随机字符串、时间戳</li><li>对合并后的对象按照属性名称进行排序</li><li>使用 sm3 获取（方法+排序后对象）的摘要当作签名值</li><li><del>使用私钥对摘要和请求方法进行签名（sm2）</del></li><li>把时间戳、随机字符串、签名方法请求头中。</li></ol><h4 id="后端"><a href="#后端" class="headerlink" title="后端"></a>后端</h4><ol><li>判断有没有时间戳、随机字符串、签名。没有则拒绝</li><li>判断时间戳时间和当前时间，不能超过 60s</li><li>使用和前端同样的方式对参数、随机字符串、时间戳进行合并排序、计算摘要</li><li><del>使用公钥对请求方法和处理后的数据验签。</del></li></ol><br/><h3 id="排序方法"><a href="#排序方法" class="headerlink" title="排序方法"></a>排序方法</h3><p>参与排序的包括 body、query、params</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">sortObject</span>(<span class="params">obj</span>) &#123;</span><br><span class="line">  <span class="keyword">if</span> (<span class="title class_">Object</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">toString</span>.<span class="title function_">call</span>(obj) === <span class="string">&quot;[object Object]&quot;</span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> sortData = &#123;&#125;; <span class="comment">// 排序后的对象</span></span><br><span class="line">    <span class="title class_">Object</span>.<span class="title function_">keys</span>(obj)</span><br><span class="line">      .<span class="title function_">sort</span>()</span><br><span class="line">      .<span class="title function_">forEach</span>(<span class="function"><span class="params">key</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="title class_">Object</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">toString</span>.<span class="title function_">call</span>(obj[key]) === <span class="string">&quot;[object Object]&quot;</span>) &#123;</span><br><span class="line">          sortData[key] = <span class="title function_">sortObject</span>(obj[key]);</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="title class_">Array</span>.<span class="title function_">isArray</span>(obj[key])) &#123;</span><br><span class="line">          sortData[key] = obj[key].<span class="title function_">map</span>(<span class="function"><span class="params">e</span> =&gt;</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="title function_">sortObject</span>(e);</span><br><span class="line">          &#125;);</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="keyword">typeof</span> obj[key] === <span class="string">&quot;number&quot;</span>) &#123;</span><br><span class="line">          sortData[key] = obj[key].<span class="title function_">toString</span>();</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="keyword">typeof</span> obj[key] === <span class="string">&quot;string&quot;</span>) &#123;</span><br><span class="line">          sortData[key] = obj[key];</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="keyword">typeof</span> obj[key] === <span class="string">&quot;boolean&quot;</span>) &#123;</span><br><span class="line">          sortData[key] = obj[key].<span class="title function_">toString</span>();</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">          <span class="keyword">if</span> (obj[key] === <span class="literal">null</span> || obj[key] === <span class="literal">undefined</span>) &#123;</span><br><span class="line">            <span class="comment">// 忽略</span></span><br><span class="line">          &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            sortData[key] = obj[key];</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;);</span><br><span class="line">    <span class="keyword">return</span> sortData;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> (<span class="keyword">typeof</span> obj === <span class="string">&quot;boolean&quot;</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> obj.<span class="title function_">toString</span>();</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> obj;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/houxiaozhao/imageLibrary@master/uPic/2022/07/15/CosfES.png" alt="CosfES"><br><img src="https://cdn.jsdelivr.net/gh/houxiaozhao/imageLibrary@master/uPic/2022/07/15/9nCg7C.png" alt="9nCg7C"></p>]]></content>
      
      
      <categories>
          
          <category> 网络安全 </category>
          
          <category> 加密技术 </category>
          
          <category> 系统开发 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 国密算法 </tag>
            
            <tag> SM2加密 </tag>
            
            <tag> SM3哈希 </tag>
            
            <tag> SM4加密 </tag>
            
            <tag> 密钥传输 </tag>
            
            <tag> 数据签名 </tag>
            
            <tag> 加密通信 </tag>
            
            <tag> JavaScript实现 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Vuetify 自定义SVG图标</title>
      <link href="/2022/07/20/Vuetify%20%E8%87%AA%E5%AE%9A%E4%B9%89SVG%E5%9B%BE%E6%A0%87/"/>
      <url>/2022/07/20/Vuetify%20%E8%87%AA%E5%AE%9A%E4%B9%89SVG%E5%9B%BE%E6%A0%87/</url>
      
        <content type="html"><![CDATA[<h1 id="Vuetify-自定义-SVG-图标"><a href="#Vuetify-自定义-SVG-图标" class="headerlink" title="Vuetify 自定义 SVG 图标"></a>Vuetify 自定义 SVG 图标</h1><blockquote><p>Vite</p><p>Vuetify</p><p>vite-plugin-svg-icons</p></blockquote><ol><li><p>首先配置 svg 插件<a href="https://github.com/vbenjs/vite-plugin-svg-icons/blob/main/README.zh_CN.md">https://github.com/vbenjs/vite-plugin-svg-icons/blob/main/README.zh_CN.md</a></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// vite.config.js</span></span><br><span class="line"><span class="keyword">import</span> &#123; defineConfig, loadEnv &#125; <span class="keyword">from</span> <span class="string">&quot;vite&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> legacy <span class="keyword">from</span> <span class="string">&quot;@vitejs/plugin-legacy&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; createVuePlugin &#125; <span class="keyword">from</span> <span class="string">&quot;vite-plugin-vue2&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> viteCompression <span class="keyword">from</span> <span class="string">&quot;vite-plugin-compression&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> path <span class="keyword">from</span> <span class="string">&quot;path&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">WindiCSS</span> <span class="keyword">from</span> <span class="string">&quot;vite-plugin-windicss&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; createSvgIconsPlugin &#125; <span class="keyword">from</span> <span class="string">&quot;vite-plugin-svg-icons&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">VuetifyResolver</span> &#125; <span class="keyword">from</span> <span class="string">&quot;unplugin-vue-components/resolvers&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Components</span> <span class="keyword">from</span> <span class="string">&quot;unplugin-vue-components/vite&quot;</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">HOST</span> = <span class="string">&quot;0.0.0.0&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="title function_">default</span> (&#123; mode &#125;) =&gt; &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="title function_">defineConfig</span>(&#123;</span><br><span class="line">    <span class="attr">base</span>: <span class="string">&quot;./&quot;</span>,</span><br><span class="line">    <span class="attr">server</span>: &#123;</span><br><span class="line">      <span class="attr">host</span>: <span class="variable constant_">HOST</span>,</span><br><span class="line">      <span class="attr">port</span>: <span class="title function_">loadEnv</span>(mode, process.<span class="title function_">cwd</span>()).<span class="property">VITE_APP_PORT</span>,</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">resolve</span>: &#123;</span><br><span class="line">      <span class="attr">alias</span>: &#123;</span><br><span class="line">        <span class="string">&quot;@&quot;</span>: path.<span class="title function_">resolve</span>(__dirname, <span class="string">&quot;/src&quot;</span>),</span><br><span class="line">      &#125;,</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">plugins</span>: [</span><br><span class="line">      <span class="title function_">createVuePlugin</span>(<span class="comment">/* options */</span>),</span><br><span class="line">      <span class="title function_">legacy</span>(&#123;</span><br><span class="line">        <span class="attr">targets</span>: [<span class="string">&quot;ie &gt;= 11&quot;</span>],</span><br><span class="line">        <span class="attr">additionalLegacyPolyfills</span>: [<span class="string">&quot;regenerator-runtime/runtime&quot;</span>],</span><br><span class="line">      &#125;),</span><br><span class="line">      <span class="title class_">WindiCSS</span>(),</span><br><span class="line">      <span class="title function_">viteCompression</span>(),</span><br><span class="line">      <span class="comment">// 配置插件</span></span><br><span class="line">      <span class="title function_">createSvgIconsPlugin</span>(&#123;</span><br><span class="line">        <span class="attr">iconDirs</span>: [path.<span class="title function_">resolve</span>(process.<span class="title function_">cwd</span>(), <span class="string">&quot;src/assets/icons&quot;</span>)],</span><br><span class="line">        <span class="attr">symbolId</span>: <span class="string">&quot;icon-[dir]-[name]&quot;</span>,</span><br><span class="line">      &#125;),</span><br><span class="line">      <span class="title class_">Components</span>(&#123;</span><br><span class="line">        <span class="attr">resolvers</span>: [<span class="title class_">VuetifyResolver</span>()],</span><br><span class="line">      &#125;),</span><br><span class="line">    ],</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">// SvgIcon.vue</span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;svg aria-hidden=&quot;true&quot;&gt;</span><br><span class="line">    &lt;use :xlink:href=&quot;symbolId&quot; :fill=&quot;color&quot; /&gt;</span><br><span class="line">  &lt;/svg&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">export default &#123;</span><br><span class="line">  name: &quot;SvgIcon&quot;,</span><br><span class="line">  props: &#123;</span><br><span class="line">    prefix: &#123;</span><br><span class="line">      type: String,</span><br><span class="line">      default: &quot;icon&quot;,</span><br><span class="line">    &#125;,</span><br><span class="line">    name: &#123;</span><br><span class="line">      type: String,</span><br><span class="line">      required: true,</span><br><span class="line">    &#125;,</span><br><span class="line">    color: &#123;</span><br><span class="line">      type: String,</span><br><span class="line">      default: &quot;#333&quot;,</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">  computed: &#123;</span><br><span class="line">    symbolId() &#123;</span><br><span class="line">      return `#$&#123;this.prefix&#125;-$&#123;this.name&#125;`;</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure></li><li><p>配置 vuetify</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">Vue</span> <span class="keyword">from</span> <span class="string">&quot;vue&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Vuetify</span> <span class="keyword">from</span> <span class="string">&quot;vuetify/lib/framework&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;material-design-icons-iconfont/dist/material-design-icons.css&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">SvgIcon</span> <span class="keyword">from</span> <span class="string">&quot;@/components/SvgIcon.vue&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> ids <span class="keyword">from</span> <span class="string">&quot;virtual:svg-icons-names&quot;</span>; <span class="comment">// 引入全部图标名</span></span><br><span class="line"></span><br><span class="line"><span class="title class_">Vue</span>.<span class="title function_">use</span>(<span class="title class_">Vuetify</span>);</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">new</span> <span class="title class_">Vuetify</span>(&#123;</span><br><span class="line">  <span class="attr">icons</span>: &#123;</span><br><span class="line">    <span class="attr">iconfont</span>: <span class="string">&quot;md&quot;</span>, <span class="comment">// &#x27;mdi&#x27; || &#x27;mdiSvg&#x27; || &#x27;md&#x27; || &#x27;fa&#x27; || &#x27;fa4&#x27; || &#x27;faSvg&#x27;</span></span><br><span class="line">    <span class="attr">values</span>: (<span class="function">() =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">const</span> icons = &#123;&#125;; <span class="comment">//处理图标，配置到vuetify</span></span><br><span class="line">      ids.<span class="title function_">forEach</span>(<span class="function"><span class="params">id</span> =&gt;</span> &#123;</span><br><span class="line">        icons[id.<span class="title function_">substr</span>(<span class="number">5</span>)] = &#123;</span><br><span class="line">          <span class="attr">component</span>: <span class="title class_">SvgIcon</span>,</span><br><span class="line">          <span class="attr">props</span>: &#123;</span><br><span class="line">            <span class="attr">name</span>: id.<span class="title function_">substr</span>(<span class="number">5</span>),</span><br><span class="line">          &#125;,</span><br><span class="line">        &#125;;</span><br><span class="line">      &#125;);</span><br><span class="line">      <span class="keyword">return</span> icons;</span><br><span class="line">    &#125;)(),</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></li><li><p>使用图标</p><ol><li><p>把 svg 放到 assets&#x2F;icons 目录</p><p><img src="https://cdn.jsdelivr.net/gh/houxiaozhao/imageLibrary@master/uPic/2022/07/20/5tftoo.png" alt="image-20220720164727101"></p></li><li><p>icon 中使用，在名称前边加上$</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;v-btn icon&gt;</span><br><span class="line">  &lt;v-icon&gt;$dir-薯条2&lt;/v-icon&gt;</span><br><span class="line">&lt;/v-btn&gt;</span><br><span class="line">&lt;v-btn icon&gt;</span><br><span class="line">  &lt;v-icon&gt;$薯条&lt;/v-icon&gt;</span><br><span class="line">&lt;/v-btn&gt;</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;v-text-field v-model=&quot;search&quot; label=&quot;&quot; placeholder=&quot;请输入名称&quot; solo hide-details prepend-inner-icon=&quot;menu&quot; clearable style=&quot;width: 390px;&quot; append-outer-icon=&quot;$薯条&quot;&gt;</span><br><span class="line">  &lt;template v-slot:append&gt;</span><br><span class="line">&lt;v-btn icon class=&quot;ml-2&quot; small color=&quot;primary&quot;&gt;</span><br><span class="line">  &lt;v-icon&gt;$dir-薯条2&lt;/v-icon&gt;</span><br><span class="line">    &lt;/v-btn&gt;</span><br><span class="line">  &lt;/template&gt;</span><br><span class="line">  &lt;template v-slot:prepend-inner&gt;</span><br><span class="line">&lt;v-btn icon small color=&quot;primary&quot; @click=&quot;$bus.emit(&#x27;targetDrawer&#x27;)&quot;&gt;</span><br><span class="line">  &lt;v-icon&gt;menu&lt;/v-icon&gt;</span><br><span class="line">    &lt;/v-btn&gt;</span><br><span class="line">  &lt;/template&gt;</span><br><span class="line">&lt;/v-text-field&gt;</span><br></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/houxiaozhao/imageLibrary@master/uPic/2022/07/20/LB8nEk.png" alt="image-20220720165136865"></p></li></ol></li></ol>]]></content>
      
      
      
        <tags>
            
            <tag> Vue.js </tag>
            
            <tag> 前端开发 </tag>
            
            <tag> Vuetify </tag>
            
            <tag> SVG </tag>
            
            <tag> UI组件 </tag>
            
            <tag> 图标定制 </tag>
            
            <tag> Vite </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>PopClip与uTools整合：提升Mac效率工具协同体验</title>
      <link href="/2022/04/15/%E4%BD%BF%E7%94%A8PopClip%E8%B0%83%E8%B5%B7uTools-shi-yong-popclip-diao-qi-utools/"/>
      <url>/2022/04/15/%E4%BD%BF%E7%94%A8PopClip%E8%B0%83%E8%B5%B7uTools-shi-yong-popclip-diao-qi-utools/</url>
      
        <content type="html"><![CDATA[<p>在我这里 PopClip 和 uTools 都是重要的生产工具，把两者关联到一起可以进一步提高效率</p><h3 id="前提"><a href="#前提" class="headerlink" title="前提"></a>前提</h3><p>PopClip 更新到 2021.11 版本或以上，支持快速安装扩展</p><p>扩展如下</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># popclip js</span></span><br><span class="line"><span class="attr">name:</span> <span class="string">Utools</span></span><br><span class="line"><span class="attr">requirements:</span> [<span class="string">text</span>]</span><br><span class="line"><span class="attr">actions:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">title:</span> <span class="string">用Utools打开</span></span><br><span class="line">    <span class="attr">icon:</span> <span class="string">circle</span> <span class="string">filled</span> <span class="string">U</span></span><br><span class="line">    <span class="attr">javascript:</span> <span class="string">popclip.pressKey(util.constant.KEY_SPACE,</span> <span class="string">util.constant.MODIFIER_OPTION);popclip.pasteText(popclip.input.text)</span></span><br></pre></td></tr></table></figure><p>选择上边文字，然后点击<code>install Extension &quot;Utools&quot;</code><br>如果没有弹出 popclip 菜单，就把上边内容复制到其他位置再试。<br><img src="https://cdn.jsdelivr.net/gh/houxiaozhao/imageLibrary@master/uPic/2022/05/20/KyGHW6.png" alt="image"></p><p>如果打开 uTools 的快捷键不是 opt+空格，需要替换 popclip.pressKey 的内容<br>具体查看<br><a href="https://pilotmoon.github.io/PopClip-Extensions/interfaces/Util.html#constant">https://pilotmoon.github.io/PopClip-Extensions/interfaces/Util.html#constant</a></p><p>以上，就可以快速的使用 Utools 内丰富的插件了</p>]]></content>
      
      
      <categories>
          
          <category> 效率工具 </category>
          
          <category> Mac应用 </category>
          
          <category> 软件教程 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> PopClip </tag>
            
            <tag> uTools </tag>
            
            <tag> Mac效率 </tag>
            
            <tag> 工具集成 </tag>
            
            <tag> 快捷操作 </tag>
            
            <tag> 生产力工具 </tag>
            
            <tag> 工作流优化 </tag>
            
            <tag> 自动化 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>RSA加密实践：前端加密与Node.js后端解密的实现方法</title>
      <link href="/2022/03/09/rsa%E5%89%8D%E7%AB%AF%E5%8A%A0%E5%AF%86%E3%80%81node%E5%90%8E%E7%AB%AF%E8%A7%A3%E5%AF%86-rsa%E5%89%8D%E7%AB%AF%E5%8A%A0%E5%AF%86node%E5%90%8E%E7%AB%AF%E8%A7%A3%E5%AF%86/"/>
      <url>/2022/03/09/rsa%E5%89%8D%E7%AB%AF%E5%8A%A0%E5%AF%86%E3%80%81node%E5%90%8E%E7%AB%AF%E8%A7%A3%E5%AF%86-rsa%E5%89%8D%E7%AB%AF%E5%8A%A0%E5%AF%86node%E5%90%8E%E7%AB%AF%E8%A7%A3%E5%AF%86/</url>
      
        <content type="html"><![CDATA[<blockquote><p>对用户敏感数据进行加密处理，后端再解密。比如登录时的密码</p></blockquote><h2 id="由后端生成公钥"><a href="#由后端生成公钥" class="headerlink" title="由后端生成公钥"></a>由后端生成公钥</h2><p>node 使用<code>node-rsa</code></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">NodeRSA</span> = <span class="built_in">require</span>(<span class="string">&#x27;node-rsa&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">RSA</span> = <span class="keyword">new</span> <span class="title class_">NodeRSA</span>(&#123; <span class="attr">b</span>: <span class="number">512</span> &#125;);</span><br><span class="line"><span class="variable constant_">RSA</span>.<span class="title function_">setOptions</span>(&#123; <span class="attr">encryptionScheme</span>: <span class="string">&#x27;pkcs1&#x27;</span> &#125;);</span><br><span class="line"><span class="keyword">const</span> pubkey = <span class="variable constant_">RSA</span>.<span class="title function_">exportKey</span>(<span class="string">&#x27;pkcs8-public-pem&#x27;</span>); <span class="comment">// 生成公钥，发给前端用于数据加密，不导出私钥信息</span></span><br><span class="line"><span class="variable language_">this</span>.<span class="property">app</span>.<span class="property">pubkey</span> = pubkey;</span><br><span class="line"><span class="variable language_">this</span>.<span class="property">app</span>.<span class="property">RSA</span> = <span class="variable constant_">RSA</span>;<span class="comment">// 把RSA对象保存在程序内存，随时调用</span></span><br></pre></td></tr></table></figure><h2 id="前端加密"><a href="#前端加密" class="headerlink" title="前端加密"></a>前端加密</h2><p>前端使用<code>jsencrypt</code></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">JSEncrypt</span> <span class="keyword">from</span> <span class="string">&quot;jsencrypt&quot;</span>;</span><br><span class="line"><span class="keyword">const</span> encryptor = <span class="keyword">new</span> <span class="title class_">JSEncrypt</span>();</span><br><span class="line">encryptor.<span class="title function_">setPublicKey</span>(<span class="variable language_">this</span>.<span class="property">key</span>);</span><br><span class="line"><span class="keyword">const</span> password = encryptor.<span class="title function_">encrypt</span>(<span class="string">&quot;password&quot;</span>); <span class="comment">// 把password传给后端</span></span><br></pre></td></tr></table></figure><h2 id="后端解密"><a href="#后端解密" class="headerlink" title="后端解密"></a>后端解密</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> decryptedPassword = <span class="variable language_">this</span>.<span class="property">app</span>.<span class="property">RSA</span>.<span class="title function_">decrypt</span>(payload.<span class="property">password</span>, <span class="string">&quot;utf8&quot;</span>); <span class="comment">//得到解密后的数据</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Web安全 </category>
          
          <category> 加密技术 </category>
          
          <category> 全栈开发 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> JavaScript </tag>
            
            <tag> node </tag>
            
            <tag> 加密 </tag>
            
            <tag> RSA </tag>
            
            <tag> encryption </tag>
            
            <tag> decryption </tag>
            
            <tag> frontend </tag>
            
            <tag> backend </tag>
            
            <tag> cybersecurity </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>API安全防护：接口签名验证与防重放攻击实现</title>
      <link href="/2022/03/09/API%E6%8E%A5%E5%8F%A3%E7%AD%BE%E5%90%8D%E8%AE%BE%E8%AE%A1%EF%BC%8C%E9%98%B2%E6%AD%A2%E9%87%8D%E6%94%BE-api%E6%8E%A5%E5%8F%A3%E7%AD%BE%E5%90%8D%E8%AE%BE%E8%AE%A1%E9%98%B2%E6%AD%A2%E9%87%8D%E6%94%BE/"/>
      <url>/2022/03/09/API%E6%8E%A5%E5%8F%A3%E7%AD%BE%E5%90%8D%E8%AE%BE%E8%AE%A1%EF%BC%8C%E9%98%B2%E6%AD%A2%E9%87%8D%E6%94%BE-api%E6%8E%A5%E5%8F%A3%E7%AD%BE%E5%90%8D%E8%AE%BE%E8%AE%A1%E9%98%B2%E6%AD%A2%E9%87%8D%E6%94%BE/</url>
      
        <content type="html"><![CDATA[<blockquote><p>为了保证 api 接口安全，防止数据被篡改，需要设计 api 签名机制。以下为签名过程</p></blockquote><h4 id="接口签名算法"><a href="#接口签名算法" class="headerlink" title="接口签名算法"></a>接口签名算法</h4><h5 id="1-获取参数-一共-4-部分的参数"><a href="#1-获取参数-一共-4-部分的参数" class="headerlink" title="1. 获取参数 一共 4 部分的参数"></a>1. 获取参数 一共 4 部分的参数</h5><ul><li>path</li><li>query</li><li>body</li><li>时间戳 {timestamp}</li><li>随机字符串 {nocestr}</li></ul><h4 id="2-合并参数，然后排序-body-中可能嵌套多层-json-需要递归对对象属性排序，数组的顺序不变"><a href="#2-合并参数，然后排序-body-中可能嵌套多层-json-需要递归对对象属性排序，数组的顺序不变" class="headerlink" title="2. 合并参数，然后排序(body 中可能嵌套多层 json,需要递归对对象属性排序，数组的顺序不变)"></a>2. 合并参数，然后排序(body 中可能嵌套多层 json,需要递归对对象属性排序，数组的顺序不变)</h4><h4 id="3-对上一步对象转为字符串，然后-md5-加密"><a href="#3-对上一步对象转为字符串，然后-md5-加密" class="headerlink" title="3. 对上一步对象转为字符串，然后 md5 加密"></a>3. 对上一步对象转为字符串，然后 md5 加密</h4><h4 id="4-再用用户-token-为-key，对-md5-加密后的字符串用-hmacSHA512-加密得到-sign"><a href="#4-再用用户-token-为-key，对-md5-加密后的字符串用-hmacSHA512-加密得到-sign" class="headerlink" title="4. 再用用户 token 为 key，对 md5 加密后的字符串用 hmacSHA512 加密得到 sign"></a>4. 再用用户 token 为 key，对 md5 加密后的字符串用 hmacSHA512 加密得到 sign</h4><h4 id="5-http-请求-header-中添加-sign、timestamp、nocestr"><a href="#5-http-请求-header-中添加-sign、timestamp、nocestr" class="headerlink" title="5. http 请求 header 中添加 sign、timestamp、nocestr"></a>5. http 请求 header 中添加 sign、timestamp、nocestr</h4><h3 id="前端签名实现如下"><a href="#前端签名实现如下" class="headerlink" title="前端签名实现如下"></a>前端签名实现如下</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> hmacSHA512 <span class="keyword">from</span> <span class="string">&quot;crypto-js/hmac-sha512&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> md5 <span class="keyword">from</span> <span class="string">&quot;crypto-js/md5&quot;</span>;</span><br><span class="line"><span class="keyword">const</span> timestamp = +<span class="keyword">new</span> <span class="title class_">Date</span>();</span><br><span class="line"><span class="keyword">const</span> nocestr = <span class="title function_">generateNoceStr</span>();</span><br><span class="line"><span class="keyword">const</span> data = <span class="title class_">Object</span>.<span class="title function_">assign</span>(&#123;&#125;, payload.<span class="property">rawData</span>, &#123; timestamp, nocestr &#125;);</span><br><span class="line"><span class="keyword">const</span> canonical_string = payload.<span class="property">method</span> + <span class="title function_">md5</span>(<span class="title class_">JSON</span>.<span class="title function_">stringify</span>(<span class="title function_">sortObject</span>(data)));</span><br><span class="line"><span class="keyword">const</span> sign = <span class="title function_">hmacSHA512</span>(canonical_string, token).<span class="title function_">toString</span>();</span><br><span class="line">options.<span class="property">headers</span> = &#123; sign, timestamp, nocestr &#125;;</span><br></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 随机字符串生成</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">generateNoceStr</span>(<span class="params">length = <span class="number">16</span></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> chars = <span class="string">&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789&quot;</span>;</span><br><span class="line">  <span class="keyword">let</span> noceStr = <span class="string">&quot;&quot;</span>,</span><br><span class="line">    maxPos = chars.<span class="property">length</span>;</span><br><span class="line">  <span class="keyword">while</span> (length--) noceStr += chars[(<span class="title class_">Math</span>.<span class="title function_">random</span>() * maxPos) | <span class="number">0</span>];</span><br><span class="line">  <span class="keyword">return</span> noceStr;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 递归对对象属性进行排序</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">sortObject</span>(<span class="params">obj</span>) &#123;</span><br><span class="line">  <span class="keyword">if</span> (<span class="title class_">Object</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">toString</span>.<span class="title function_">call</span>(obj) === <span class="string">&quot;[object Object]&quot;</span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> sortData = &#123;&#125;; <span class="comment">// 排序后的对象</span></span><br><span class="line">    <span class="title class_">Object</span>.<span class="title function_">keys</span>(obj)</span><br><span class="line">      .<span class="title function_">sort</span>()</span><br><span class="line">      .<span class="title function_">forEach</span>(<span class="function"><span class="params">key</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="title class_">Object</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">toString</span>.<span class="title function_">call</span>(obj[key]) === <span class="string">&quot;[object Object]&quot;</span>) &#123;</span><br><span class="line">          <span class="comment">// console.log(obj[key], &#x27;对象&#x27;);</span></span><br><span class="line">          sortData[key] = <span class="title function_">sortObject</span>(obj[key]);</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="title class_">Array</span>.<span class="title function_">isArray</span>(obj[key])) &#123;</span><br><span class="line">          <span class="variable language_">console</span>.<span class="title function_">log</span>(obj[key], <span class="string">&quot;数组&quot;</span>);</span><br><span class="line">          sortData[key] = obj[key].<span class="title function_">map</span>(<span class="function"><span class="params">e</span> =&gt;</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="title function_">sortObject</span>(e);</span><br><span class="line">          &#125;);</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="keyword">typeof</span> obj[key] === <span class="string">&quot;number&quot;</span>) &#123;</span><br><span class="line">          <span class="comment">// console.log(obj[key], &#x27;数字&#x27;);</span></span><br><span class="line">          sortData[key] = obj[key].<span class="title function_">toString</span>();</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="keyword">typeof</span> obj[key] === <span class="string">&quot;string&quot;</span>) &#123;</span><br><span class="line">          <span class="comment">// console.log(obj[key], &#x27;字符串&#x27;);</span></span><br><span class="line">          sortData[key] = obj[key];</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">          <span class="comment">// console.log(obj[key], &#x27;其他&#x27;);</span></span><br><span class="line">          sortData[key] = obj[key];</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;);</span><br><span class="line">    <span class="keyword">return</span> sortData;</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> obj;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="后端验签实现如下-加在后端合适的位置，比如全局中间件"><a href="#后端验签实现如下-加在后端合适的位置，比如全局中间件" class="headerlink" title="后端验签实现如下(加在后端合适的位置，比如全局中间件)"></a>后端验签实现如下(加在后端合适的位置，比如全局中间件)</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> timestamp = ctx.<span class="property">headers</span>.<span class="property">timestamp</span>;</span><br><span class="line"><span class="keyword">const</span> nocestr = ctx.<span class="property">headers</span>.<span class="property">nocestr</span>;</span><br><span class="line"><span class="keyword">const</span> sign = ctx.<span class="property">headers</span>.<span class="property">sign</span>;</span><br><span class="line"><span class="keyword">if</span> (!timestamp) &#123;</span><br><span class="line">  ctx.<span class="property">body</span> = &#123; <span class="attr">errno</span>: <span class="number">400</span>, <span class="attr">errmsg</span>: <span class="string">&quot;验签失败,没有时间戳&quot;</span> &#125;;</span><br><span class="line">  <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (!nocestr) &#123;</span><br><span class="line">  ctx.<span class="property">body</span> = &#123; <span class="attr">errno</span>: <span class="number">400</span>, <span class="attr">errmsg</span>: <span class="string">&quot;验签失败,没有随机数&quot;</span> &#125;;</span><br><span class="line">  <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">new</span> <span class="title class_">Date</span>().<span class="title function_">getTime</span>() - <span class="title class_">Number</span>(timestamp) &gt; <span class="number">1000</span> * <span class="number">60</span>) &#123;</span><br><span class="line">  ctx.<span class="property">body</span> = &#123; <span class="attr">errno</span>: <span class="number">400</span>, <span class="attr">errmsg</span>: <span class="string">&quot;验签失败,时间超时&quot;</span> &#125;;</span><br><span class="line">  <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (!sign) &#123;</span><br><span class="line">  ctx.<span class="property">body</span> = &#123; <span class="attr">errno</span>: <span class="number">400</span>, <span class="attr">errmsg</span>: <span class="string">&quot;验签失败,没有签名&quot;</span> &#125;;</span><br><span class="line">  <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> rawData = <span class="title class_">Object</span>.<span class="title function_">assign</span>(&#123;&#125;, ctx.<span class="property">request</span>.<span class="property">body</span>, ctx.<span class="property">query</span>, ctx.<span class="property">params</span>, &#123; timestamp, nocestr &#125;);</span><br><span class="line"><span class="keyword">const</span> mySign = <span class="title function_">hmacSHA512</span>(ctx.<span class="property">request</span>.<span class="property">method</span> + <span class="title function_">md5</span>(<span class="title class_">JSON</span>.<span class="title function_">stringify</span>(<span class="title function_">sortObject</span>(rawData))).<span class="title function_">toString</span>(), headerToken).<span class="title function_">toString</span>();</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (sign !== mySign) &#123;</span><br><span class="line">  ctx.<span class="property">body</span> = &#123; <span class="attr">errno</span>: <span class="number">400</span>, <span class="attr">errmsg</span>: <span class="string">&quot;验签失败&quot;</span> &#125;;</span><br><span class="line">  <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="添加请求防止重放"><a href="#添加请求防止重放" class="headerlink" title="添加请求防止重放"></a>添加请求防止重放</h2><ul><li>原理就是把签名存到 redis 中，再次请求查一下 redis 内是否有该签名。有的话就是重放请求。</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">// 验签成功后</span><br><span class="line">if (await ctx.app.redis.get(&#x27;request:sign:&#x27; + sign)) &#123;</span><br><span class="line">   ctx.body = &#123; errno: 400, errmsg: &#x27;请求失效&#x27; &#125;;</span><br><span class="line">   return;</span><br><span class="line">&#125;</span><br><span class="line">await ctx.app.redis.set(&#x27;request:sign:&#x27; + sign, sign);</span><br><span class="line">await ctx.app.redis.expire(&#x27;request:sign:&#x27; + sign, 60);// 60秒后，就通不过时间戳判断</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> API安全 </category>
          
          <category> 后端开发 </category>
          
          <category> 系统架构 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> API签名 </tag>
            
            <tag> 安全防护 </tag>
            
            <tag> JavaScript </tag>
            
            <tag> Node.js </tag>
            
            <tag> Redis </tag>
            
            <tag> 加密算法 </tag>
            
            <tag> 防重放攻击 </tag>
            
            <tag> 中间件开发 </tag>
            
            <tag> Web安全 </tag>
            
            <tag> 接口设计 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>EMQX MQTT服务器：使用Docker Compose快速部署及Nginx反向代理配置</title>
      <link href="/2022/02/17/emqx%20docker-compose%20%E6%96%B9%E5%BC%8F%E9%83%A8%E7%BD%B2-emqxdocker-composefang-shi-bu-shu/"/>
      <url>/2022/02/17/emqx%20docker-compose%20%E6%96%B9%E5%BC%8F%E9%83%A8%E7%BD%B2-emqxdocker-composefang-shi-bu-shu/</url>
      
        <content type="html"><![CDATA[<p>docker-compose.yml</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">version:</span> <span class="string">&quot;3&quot;</span></span><br><span class="line"><span class="attr">services:</span></span><br><span class="line">  <span class="attr">mqtt:</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">emqx/emqx:4.2.14</span></span><br><span class="line">    <span class="attr">container_name:</span> <span class="string">mqtt</span></span><br><span class="line">    <span class="attr">restart:</span> <span class="string">always</span></span><br><span class="line">    <span class="attr">ports:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">&quot;1883:1883&quot;</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">&quot;8083:8083&quot;</span></span><br><span class="line">    <span class="attr">volumes:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">/etc/timezone:/etc/timezone</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">/etc/localtime:/etc/localtime</span></span><br><span class="line">    <span class="attr">environment:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">EMQX_LOADED_PLUGINS=&quot;emqx_recon,emqx_retainer,emqx_management,emqx_auth_username&quot;</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">EMQX_ALLOW_ANONYMOUS=false</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">EMQX_AUTH__USER__1__USERNAME=$&#123;MQTT_USERNAME:-username&#125;</span> <span class="comment"># 可以在.env中配置</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">EMQX_AUTH__USER__1__PASSWORD=$&#123;MQTT_PASSWORD:-password&#125;</span> <span class="comment"># 可以在.env中配置</span></span><br></pre></td></tr></table></figure><h4 id="启动"><a href="#启动" class="headerlink" title="启动"></a>启动</h4><p>docker-compose up -d</p><h4 id="nginx-代理设置"><a href="#nginx-代理设置" class="headerlink" title="nginx 代理设置"></a>nginx 代理设置</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">location /mqtt &#123;</span><br><span class="line">       proxy_pass   http://192.168.31.186:8083; # 局域网ip地址</span><br><span class="line">       proxy_read_timeout  60s;</span><br><span class="line">       proxy_set_header    Host $host;</span><br><span class="line">       proxy_set_header    X-Real_IP $remote_addr;</span><br><span class="line">       proxy_set_header    X-Forwarded-for $remote_addr;</span><br><span class="line">       proxy_http_version  1.1;</span><br><span class="line">       proxy_set_header    Upgrade $http_upgrade;</span><br><span class="line">       proxy_set_header    Connection Upgrade;</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 消息中间件 </category>
          
          <category> Docker容器化 </category>
          
          <category> 系统部署 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> EMQX </tag>
            
            <tag> Docker </tag>
            
            <tag> MQTT </tag>
            
            <tag> Docker Compose </tag>
            
            <tag> Nginx </tag>
            
            <tag> 消息队列 </tag>
            
            <tag> 物联网通信 </tag>
            
            <tag> 系统部署 </tag>
            
            <tag> 反向代理 </tag>
            
            <tag> 容器化部署 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Vue.js 动态文本中实现可点击链接 | Interactive Links in Vue Dynamic Text</title>
      <link href="/2022/02/17/vue%E4%B8%AD%E5%8A%A8%E6%80%81%E7%BB%91%E5%AE%9A%E7%9A%84%E6%96%87%E6%9C%AC%E4%B8%AD%E5%8A%A0%E5%85%A5%E8%B7%B3%E8%BD%AC%E9%93%BE%E6%8E%A5%E5%A4%84%E7%90%86%E6%96%B9%E5%BC%8F-vue-zhong-dong-tai-bang-ding-de-wen-ben-zhong-jia-ru-tiao-zhuan-lian-jie-chu-li-fang-shi/"/>
      <url>/2022/02/17/vue%E4%B8%AD%E5%8A%A8%E6%80%81%E7%BB%91%E5%AE%9A%E7%9A%84%E6%96%87%E6%9C%AC%E4%B8%AD%E5%8A%A0%E5%85%A5%E8%B7%B3%E8%BD%AC%E9%93%BE%E6%8E%A5%E5%A4%84%E7%90%86%E6%96%B9%E5%BC%8F-vue-zhong-dong-tai-bang-ding-de-wen-ben-zhong-jia-ru-tiao-zhuan-lian-jie-chu-li-fang-shi/</url>
      
        <content type="html"><![CDATA[<p>业务中有一块是通知中心，其中的通知文本中有的文字是可以点击跳转到其他页面的。但是又不想使用富文本渲染。遂采用以下实现方式</p><ul><li>v-html 渲染</li><li>a 标签标识可跳转链接</li><li>dataset 设置参数</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">v-html</span>=<span class="string">&quot;text&quot;</span> @<span class="attr">click</span>=<span class="string">&quot;click&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">&lt;/template&gt;</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="attr">name</span>: <span class="string">&quot;About&quot;</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="title function_">data</span>(<span class="params"></span>) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="keyword">return</span> &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="attr">text</span>: <span class="string">`你好，这是&lt;a data-name=&#x27;Preview&#x27; data-id=&#x27;123&#x27; data-mode=&quot;preview&quot;&gt;链接&lt;/a&gt;。这是 &lt;span class=&quot;active&quot;&gt;强调色&lt;/span&gt; 的文本`</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    &#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  &#125;,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="attr">methods</span>: &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="title function_">click</span>(<span class="params">e</span>) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="keyword">if</span> (e.<span class="property">target</span>.<span class="property">dataset</span>.<span class="property">name</span>) <span class="variable language_">this</span>.<span class="property">$router</span>.<span class="title function_">push</span>(&#123;<span class="attr">name</span>: e.<span class="property">target</span>.<span class="property">dataset</span>.<span class="property">name</span>, <span class="attr">params</span>: e.<span class="property">target</span>.<span class="property">dataset</span>&#125;)</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    &#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  &#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">&#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="language-css"></span></span></span><br><span class="line"><span class="language-css"><span class="language-xml"><span class="selector-class">.active</span> &#123;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">  <span class="attribute">color</span>: yellow;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">&#125;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-css"><span class="language-xml"><span class="selector-tag">a</span> &#123;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">  <span class="attribute">color</span>: yellow;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">  <span class="attribute">cursor</span>: pointer;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">&#125;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/houxiaozhao/imageLibrary@master/uPic/2022/05/20/0gpmgb.png" alt="image.png"></p>]]></content>
      
      
      <categories>
          
          <category> 前端开发 </category>
          
          <category> Vue.js </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Vue.js </tag>
            
            <tag> 前端开发 </tag>
            
            <tag> 动态绑定 </tag>
            
            <tag> v-html </tag>
            
            <tag> 路由跳转 </tag>
            
            <tag> Dynamic Binding </tag>
            
            <tag> Router Navigation </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Node.js 日期循环库：使用 date-recur 实现周期性任务调度</title>
      <link href="/2022/02/14/%E5%88%9B%E5%BB%BA%E5%BE%AA%E7%8E%AF%E6%97%A5%E6%9C%9F%E7%9A%84node%E5%BA%93date-recur%E5%8F%8A%E4%BD%BF%E7%94%A8%E6%96%B9%E6%B3%95-%E5%88%9B%E5%BB%BA%E5%BE%AA%E7%8E%AF%E6%97%A5%E6%9C%9F%E7%9A%84node%E5%BA%93date-recur%E5%8F%8A%E4%BD%BF%E7%94%A8%E6%96%B9%E6%B3%95/"/>
      <url>/2022/02/14/%E5%88%9B%E5%BB%BA%E5%BE%AA%E7%8E%AF%E6%97%A5%E6%9C%9F%E7%9A%84node%E5%BA%93date-recur%E5%8F%8A%E4%BD%BF%E7%94%A8%E6%96%B9%E6%B3%95-%E5%88%9B%E5%BB%BA%E5%BE%AA%E7%8E%AF%E6%97%A5%E6%9C%9F%E7%9A%84node%E5%BA%93date-recur%E5%8F%8A%E4%BD%BF%E7%94%A8%E6%96%B9%E6%B3%95/</url>
      
        <content type="html"><![CDATA[<blockquote><p>因为在业务中周期性的任务，用到的该 node 库，记录一下备忘。<br>业务需求是创建周期性的任务。比如每天，每隔几天，每周的周几，每月的几号，每年几月几号，以这些描述生成一系列的日期。</p></blockquote><h1 id="效果"><a href="#效果" class="headerlink" title="效果"></a>效果</h1><h2 id="按天循环"><a href="#按天循环" class="headerlink" title="按天循环"></a>按天循环</h2><p><img src="https://cdn.jsdelivr.net/gh/houxiaozhao/imageLibrary@master/uPic/2022/05/20/xbk20M.png" alt="image-902ef3af9f8b417ba567573f5e587a32"></p><h2 id="按周循环"><a href="#按周循环" class="headerlink" title="按周循环"></a>按周循环</h2><p><img src="https://cdn.jsdelivr.net/gh/houxiaozhao/imageLibrary@master/uPic/2022/05/20/1LA6HN.png" alt="image.png"></p><h2 id="按月循环"><a href="#按月循环" class="headerlink" title="按月循环"></a>按月循环</h2><p><img src="https://cdn.jsdelivr.net/gh/houxiaozhao/imageLibrary@master/uPic/2022/05/20/MMHBMR.png" alt="image.png"></p><h2 id="按年循环"><a href="#按年循环" class="headerlink" title="按年循环"></a>按年循环</h2><p><img src="https://cdn.jsdelivr.net/gh/houxiaozhao/imageLibrary@master/uPic/2022/05/20/iUorMi.png" alt="image.png"></p><h1 id="介绍-date-recur"><a href="#介绍-date-recur" class="headerlink" title="介绍 date-recur"></a>介绍 date-recur</h1><p>创建一个循环日期并查询它以查看它是否落在特定日期。<br>使用方法详见<a href="https://www.npmjs.com/package/date-recur">npm date-recur</a></p><h2 id="这里举几个例子"><a href="#这里举几个例子" class="headerlink" title="这里举几个例子"></a>这里举几个例子</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> r = <span class="title function_">recur</span>(start, end); <span class="comment">//限定开始和结束日期</span></span><br><span class="line"><span class="comment">// r.setDailyInterval(1); // 每天</span></span><br><span class="line"><span class="comment">// r.setDailyInterval(2); //每两天</span></span><br><span class="line"><span class="comment">// r.setDaysOfWeek(1)//每周一</span></span><br><span class="line"><span class="comment">// r.setDaysOfWeek([1, 2]); //每周一周二</span></span><br><span class="line"><span class="comment">// r.setWeeklyInterval(2).setDaysOfWeek(1); //每隔一周周一</span></span><br><span class="line"><span class="comment">// r.setWeeklyInterval(3).setDaysOfWeek([1, 3]); //每三周周一周三</span></span><br><span class="line"><span class="comment">// r.setDaysOfMonth(1); //每月一号</span></span><br><span class="line"><span class="comment">// r.setMonthlyInterval(2).setDaysOfMonth([1, 3, 4]); //每两个月的一号</span></span><br><span class="line"><span class="comment">// r.setYearlyInterval(2).setDaysOfMonth([3, 19]).setMonthsOfYear([11]); //每两年的11月的3号和19号</span></span><br></pre></td></tr></table></figure><p>上面的只是创建了一个 recur 对象，还需要使用 matches 方法判断一个日期是否落入该 recur 对象设定的日期内。<br>接下来从 start 到 end 的时间遍历一遍，挨个判断是否落入该 recur 对象中。</p><h3 id="args-含义-1"><a href="#args-含义-1" class="headerlink" title="args 含义 [1, [], []]"></a>args 含义 [1, [], []]</h3><ul><li>第一个元素代表每隔多久，一天，两天，一个月，一周</li><li>第二个元素<ul><li>每天:为空</li><li>每周：周几</li><li>每月：几号</li><li>每年：几月</li></ul></li><li>第三个元素只有是每年时有代表：几号 ，和第二个元素结合就是几月几号</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">generateRecurDate</span>(<span class="params">start: string, end: string, measure: <span class="string">&quot;day&quot;</span> | <span class="string">&quot;week&quot;</span> | <span class="string">&quot;month&quot;</span> | <span class="string">&quot;year&quot;</span>, ...args: any[]</span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> r = <span class="title function_">recur</span>(start, end);</span><br><span class="line">  <span class="keyword">switch</span> (measure) &#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="string">&quot;day&quot;</span>:</span><br><span class="line">      r.<span class="title function_">setDailyInterval</span>(args[<span class="number">0</span>]);</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="string">&quot;week&quot;</span>:</span><br><span class="line">      r.<span class="title function_">setWeeklyInterval</span>(args[<span class="number">0</span>]).<span class="title function_">setDaysOfWeek</span>(args[<span class="number">1</span>]);</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="string">&quot;month&quot;</span>:</span><br><span class="line">      r.<span class="title function_">setMonthlyInterval</span>(args[<span class="number">0</span>]).<span class="title function_">setDaysOfMonth</span>(args[<span class="number">1</span>]);</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="string">&quot;year&quot;</span>:</span><br><span class="line">      r.<span class="title function_">setYearlyInterval</span>(args[<span class="number">0</span>]).<span class="title function_">setDaysOfMonth</span>(args[<span class="number">1</span>]).<span class="title function_">setMonthsOfYear</span>(args[<span class="number">2</span>]);</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="attr">default</span>:</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">const</span> <span class="attr">dates</span>: string[] = [];</span><br><span class="line">  <span class="title function_">match</span>(<span class="title function_">moment</span>(<span class="keyword">new</span> <span class="title class_">Date</span>(start)));</span><br><span class="line">  <span class="keyword">function</span> <span class="title function_">match</span>(<span class="params">time</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (r.<span class="title function_">matches</span>(time.<span class="title function_">toDate</span>())) &#123;</span><br><span class="line">      dates.<span class="title function_">push</span>(time.<span class="title function_">format</span>(<span class="string">&quot;YYYY-MM-DD&quot;</span>));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (time.<span class="title function_">isBetween</span>(<span class="title function_">moment</span>(<span class="keyword">new</span> <span class="title class_">Date</span>(start)), <span class="title function_">moment</span>(<span class="keyword">new</span> <span class="title class_">Date</span>(end)), <span class="string">&quot;day&quot;</span>, <span class="string">&quot;[]&quot;</span>)) &#123;</span><br><span class="line">      <span class="title function_">match</span>(time.<span class="title function_">add</span>(<span class="number">1</span>, <span class="string">&quot;day&quot;</span>));</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> dates;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>前端实现</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br></pre></td><td class="code"><pre><span class="line">&lt;el-form ref=&quot;form&quot; :model=&quot;cycleTimeForm&quot; label-width=&quot;120px&quot;&gt;</span><br><span class="line">          &lt;el-form-item label=&quot;执行时间：&quot;&gt;</span><br><span class="line">            &lt;el-time-select</span><br><span class="line">                v-model=&quot;cycleTimeForm.time&quot;</span><br><span class="line">                :picker-options=&quot;&#123;</span><br><span class="line">                  start: &#x27;07:00&#x27;,</span><br><span class="line">                  step: &#x27;00:15&#x27;,</span><br><span class="line">                  end: &#x27;18:00&#x27;</span><br><span class="line">                &#125;&quot;</span><br><span class="line">                placeholder=&quot;选择时间&quot;&gt;</span><br><span class="line">            &lt;/el-time-select&gt;</span><br><span class="line">          &lt;/el-form-item&gt;</span><br><span class="line">          &lt;el-form-item label=&quot;起止日期：&quot;&gt;</span><br><span class="line">            &lt;el-date-picker</span><br><span class="line">                v-model=&quot;cycleTimeForm.date&quot;</span><br><span class="line">                type=&quot;daterange&quot;</span><br><span class="line">                value-format=&quot;yyyy-MM-dd&quot;</span><br><span class="line">                range-separator=&quot;至&quot;</span><br><span class="line">                start-placeholder=&quot;开始日期&quot;</span><br><span class="line">                end-placeholder=&quot;结束日期&quot;&gt;</span><br><span class="line">            &lt;/el-date-picker&gt;</span><br><span class="line">          &lt;/el-form-item&gt;</span><br><span class="line">          &lt;el-form-item label=&quot;重复设置：&quot;&gt;</span><br><span class="line">            &lt;div class=&quot;flex justify-start items-center&quot;&gt;</span><br><span class="line">              &lt;div v-if=&quot;cycleTimeForm.measure === &#x27;day&#x27;&quot;&gt;</span><br><span class="line">                每</span><br><span class="line">                &lt;el-input-number</span><br><span class="line">                    v-model=&quot;cycleTimeForm.args[0]&quot;</span><br><span class="line">                    controls-position=&quot;right&quot;</span><br><span class="line">                    style=&quot;width: 80px&quot;</span><br><span class="line">                    :min=&quot;1&quot;</span><br><span class="line">                    :max=&quot;365&quot;</span><br><span class="line">                &gt;&lt;/el-input-number&gt;</span><br><span class="line">              &lt;/div&gt;</span><br><span class="line">              &lt;div v-if=&quot;cycleTimeForm.measure === &#x27;week&#x27;&quot;&gt;</span><br><span class="line">                每</span><br><span class="line">                &lt;el-input-number</span><br><span class="line">                    v-model=&quot;cycleTimeForm.args[0]&quot;</span><br><span class="line">                    controls-position=&quot;right&quot;</span><br><span class="line">                    style=&quot;width: 80px&quot;</span><br><span class="line">                    :min=&quot;1&quot;</span><br><span class="line">                    :max=&quot;52&quot;</span><br><span class="line">                &gt;&lt;/el-input-number&gt;</span><br><span class="line">              &lt;/div&gt;</span><br><span class="line">              &lt;div v-if=&quot;cycleTimeForm.measure === &#x27;month&#x27;&quot;&gt;</span><br><span class="line">                每</span><br><span class="line">                &lt;el-input-number</span><br><span class="line">                    v-model=&quot;cycleTimeForm.args[0]&quot;</span><br><span class="line">                    controls-position=&quot;right&quot;</span><br><span class="line">                    style=&quot;width: 80px&quot;</span><br><span class="line">                    :min=&quot;1&quot;</span><br><span class="line">                    :max=&quot;12&quot;</span><br><span class="line">                &gt;&lt;/el-input-number&gt;</span><br><span class="line">              &lt;/div&gt;</span><br><span class="line">              &lt;div v-if=&quot;cycleTimeForm.measure === &#x27;year&#x27;&quot;&gt;</span><br><span class="line">                每</span><br><span class="line">                &lt;el-input-number</span><br><span class="line">                    v-model=&quot;cycleTimeForm.args[0]&quot;</span><br><span class="line">                    controls-position=&quot;right&quot;</span><br><span class="line">                    style=&quot;width: 80px&quot;</span><br><span class="line">                    :min=&quot;1&quot;</span><br><span class="line">                    :max=&quot;365&quot;</span><br><span class="line">                &gt;&lt;/el-input-number&gt;</span><br><span class="line">              &lt;/div&gt;</span><br><span class="line">              &lt;el-select</span><br><span class="line">                  v-model=&quot;cycleTimeForm.measure&quot;</span><br><span class="line">                  @change=&quot;cycleTimeForm.args = [1, [], []]&quot;</span><br><span class="line">                  style=&quot;margin-right: 10px&quot;</span><br><span class="line">                  placeholder=&quot;请选择&quot;</span><br><span class="line">              &gt;</span><br><span class="line">                &lt;el-option label=&quot;天&quot; value=&quot;day&quot;&gt;&lt;/el-option&gt;</span><br><span class="line">                &lt;el-option label=&quot;周&quot; value=&quot;week&quot;&gt;&lt;/el-option&gt;</span><br><span class="line">                &lt;el-option label=&quot;月&quot; value=&quot;month&quot;&gt;&lt;/el-option&gt;</span><br><span class="line">                &lt;el-option label=&quot;年&quot; value=&quot;year&quot;&gt;&lt;/el-option&gt;</span><br><span class="line">              &lt;/el-select&gt;</span><br><span class="line">            &lt;/div&gt;</span><br><span class="line">          &lt;/el-form-item&gt;</span><br><span class="line">          &lt;el-form-item&gt;</span><br><span class="line">            &lt;el-select v-if=&quot;cycleTimeForm.measure === &#x27;week&#x27;&quot; v-model=&quot;cycleTimeForm.args[1]&quot; multiple</span><br><span class="line">                       placeholder=&quot;请选择&quot;&gt;</span><br><span class="line">              &lt;el-option label=&quot;周一&quot; :value=&quot;1&quot;&gt;&lt;/el-option&gt;</span><br><span class="line">              &lt;el-option label=&quot;周二&quot; :value=&quot;2&quot;&gt;&lt;/el-option&gt;</span><br><span class="line">              &lt;el-option label=&quot;周三&quot; :value=&quot;3&quot;&gt;&lt;/el-option&gt;</span><br><span class="line">              &lt;el-option label=&quot;周四&quot; :value=&quot;4&quot;&gt;&lt;/el-option&gt;</span><br><span class="line">              &lt;el-option label=&quot;周五&quot; :value=&quot;5&quot;&gt;&lt;/el-option&gt;</span><br><span class="line">              &lt;el-option label=&quot;周六&quot; :value=&quot;6&quot;&gt;&lt;/el-option&gt;</span><br><span class="line">              &lt;el-option label=&quot;周七&quot; :value=&quot;0&quot;&gt;&lt;/el-option&gt;</span><br><span class="line">            &lt;/el-select&gt;</span><br><span class="line">            &lt;el-select v-model=&quot;cycleTimeForm.args[1]&quot;</span><br><span class="line">                       v-if=&quot;cycleTimeForm.measure === &#x27;month&#x27;&quot; multiple</span><br><span class="line">                       placeholder=&quot;请选择&quot;&gt;</span><br><span class="line">              &lt;el-option v-for=&quot;i in 31&quot; :key=&quot;i&quot; :label=&quot;`$&#123;i&#125;号`&quot; :value=&quot;i&quot;&gt;&lt;/el-option&gt;</span><br><span class="line">            &lt;/el-select&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">            &lt;el-select v-model=&quot;cycleTimeForm.args[1]&quot;</span><br><span class="line">                       v-if=&quot;cycleTimeForm.measure === &#x27;year&#x27;&quot; multiple</span><br><span class="line">                       placeholder=&quot;请选择&quot;&gt;</span><br><span class="line">              &lt;el-option v-for=&quot;i in 12&quot; :key=&quot;i&quot; :label=&quot;`$&#123;i&#125;月`&quot; :value=&quot;i&quot;&gt;&lt;/el-option&gt;</span><br><span class="line">            &lt;/el-select&gt;</span><br><span class="line">            &lt;el-select v-model=&quot;cycleTimeForm.args[2]&quot;</span><br><span class="line">                       v-if=&quot;cycleTimeForm.measure === &#x27;year&#x27;&quot; multiple</span><br><span class="line">                       placeholder=&quot;请选择&quot;&gt;</span><br><span class="line">              &lt;el-option v-for=&quot;i in 31&quot; :key=&quot;i&quot; :label=&quot;`$&#123;i&#125;号`&quot; :value=&quot;i&quot;&gt;&lt;/el-option&gt;</span><br><span class="line">            &lt;/el-select&gt;</span><br><span class="line">          &lt;/el-form-item&gt;</span><br><span class="line">        &lt;/el-form&gt;</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">cycleTimeForm: &#123;</span><br><span class="line">        time: &#x27;&#x27;,</span><br><span class="line">        date: &#x27;&#x27;,</span><br><span class="line">        measure: &#x27;day&#x27;,</span><br><span class="line">        args: [1, [], []],</span><br><span class="line">      &#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 前端开发 </category>
          
          <category> Node.js </category>
          
          <category> 时间处理 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> JavaScript </tag>
            
            <tag> Node.js </tag>
            
            <tag> 任务调度 </tag>
            
            <tag> Vue.js </tag>
            
            <tag> 前端开发 </tag>
            
            <tag> Element UI </tag>
            
            <tag> Date-recur </tag>
            
            <tag> 日期处理 </tag>
            
            <tag> 时间选择 </tag>
            
            <tag> 周期任务 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Flask 图片处理：构建高性能实时缩略图服务</title>
      <link href="/2022/01/20/%E7%AE%80%E5%8D%95%E7%9A%84flask%E7%A8%8B%E5%BA%8F%EF%BC%8C%E5%AE%9E%E6%97%B6%E8%BF%94%E5%9B%9E%E5%9B%BE%E7%89%87%E7%BC%A9%E7%95%A5%E5%9B%BE-%E7%AE%80%E5%8D%95%E7%9A%84flask%E7%A8%8B%E5%BA%8F%E5%AE%9E%E6%97%B6%E8%BF%94%E5%9B%9E%E5%9B%BE%E7%89%87%E7%BC%A9%E7%95%A5%E5%9B%BE/"/>
      <url>/2022/01/20/%E7%AE%80%E5%8D%95%E7%9A%84flask%E7%A8%8B%E5%BA%8F%EF%BC%8C%E5%AE%9E%E6%97%B6%E8%BF%94%E5%9B%9E%E5%9B%BE%E7%89%87%E7%BC%A9%E7%95%A5%E5%9B%BE-%E7%AE%80%E5%8D%95%E7%9A%84flask%E7%A8%8B%E5%BA%8F%E5%AE%9E%E6%97%B6%E8%BF%94%E5%9B%9E%E5%9B%BE%E7%89%87%E7%BC%A9%E7%95%A5%E5%9B%BE/</url>
      
        <content type="html"><![CDATA[<blockquote><p>因为网页上图片太大，现在要生成缩略图返回。使用 python 的 Pillow 库处理图片缩略图并返回。</p></blockquote><p>以下是 flask 程序，调用方法 GET &#x2F;images&#x2F;&lt;path&gt;?resize&#x3D;&lt;width&gt;*&lt;height&gt;</p><h3 id="实现功能："><a href="#实现功能：" class="headerlink" title="实现功能："></a>实现功能：</h3><ul><li>根据参数返回不同大小的缩略图，目前只支持 jpg 图片处理</li><li>使用的正则匹配路由，支持在 images 下的多级路径</li><li>不产生中间图片，全部在内存中处理。</li></ul><p>注意：内部调用的是 thumbnail 方法。返回的图片并不是严格安装 resize 的参数进行返回。图片不会有拉伸效果。具体查看 Pillow 文档。</p><h4 id="app-py"><a href="#app-py" class="headerlink" title="app.py"></a>app.py</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> io <span class="keyword">import</span> BytesIO</span><br><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask, request, send_file</span><br><span class="line"><span class="keyword">from</span> werkzeug.routing <span class="keyword">import</span> BaseConverter</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">PathConverter</span>(<span class="title class_ inherited__">BaseConverter</span>):</span><br><span class="line">    regex = <span class="string">r&#x27;.+(\.(jpg|jpeg))&#x27;</span></span><br><span class="line">    weight = <span class="number">200</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">serve_pil_image</span>(<span class="params">pil_img</span>):</span><br><span class="line">    img_io = BytesIO()</span><br><span class="line">    pil_img.save(img_io, <span class="string">&#x27;JPEG&#x27;</span>)</span><br><span class="line">    img_io.seek(<span class="number">0</span>)</span><br><span class="line">    <span class="keyword">return</span> send_file(img_io, mimetype=<span class="string">&#x27;image/jpeg&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line">app.url_map.converters[<span class="string">&#x27;path&#x27;</span>] = PathConverter</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/images&lt;path:file_path&gt;&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">thumbnail</span>(<span class="params">file_path</span>):</span><br><span class="line">    <span class="built_in">print</span>(file_path)</span><br><span class="line">    resize = request.args.get(<span class="string">&quot;resize&quot;</span>)</span><br><span class="line">    <span class="keyword">if</span> resize:</span><br><span class="line">        w_h = resize.split(<span class="string">&#x27;*&#x27;</span>)</span><br><span class="line">        im = Image.<span class="built_in">open</span>(<span class="string">&#x27;images&#x27;</span> + file_path)</span><br><span class="line">        im.thumbnail((<span class="built_in">int</span>(w_h[<span class="number">0</span>]), <span class="built_in">int</span>(w_h[<span class="number">1</span>])))</span><br><span class="line">        <span class="keyword">return</span> serve_pil_image(im)</span><br><span class="line">    <span class="keyword">return</span> send_file(<span class="string">&#x27;images&#x27;</span> + file_path, mimetype=<span class="string">&#x27;image/jpeg&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    app.run()</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/houxiaozhao/imageLibrary@master/uPic/2022/05/20/1MU1GY.png" alt="image-729f7471edcb4b7e8a52cf8e9eac56be">其他</p><h4 id="requirements-txt"><a href="#requirements-txt" class="headerlink" title="requirements.txt"></a>requirements.txt</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">gunicorn</span><br><span class="line">gevent</span><br><span class="line">flask</span><br><span class="line">Pillow</span><br><span class="line">Werkzeug</span><br></pre></td></tr></table></figure><h4 id="gunicorn-conf-py"><a href="#gunicorn-conf-py" class="headerlink" title="gunicorn.conf.py"></a>gunicorn.conf.py</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">workers = 10  # 定义同时开启的处理请求的进程数量，根据网站流量适当调整</span><br><span class="line">worker_class = &quot;gevent&quot;  # 采用gevent库，支持异步处理请求，提高吞吐量</span><br><span class="line">bind = &quot;0.0.0.0:7676&quot;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h4 id="Dockerfile"><a href="#Dockerfile" class="headerlink" title="Dockerfile"></a>Dockerfile</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">FROM python:3.6</span><br><span class="line">WORKDIR /usr/src/app</span><br><span class="line"></span><br><span class="line">COPY requirements.txt ./</span><br><span class="line">RUN pip install -r requirements.txt -i https://pypi.tuna.tsinghua.edu.cn/simple</span><br><span class="line"></span><br><span class="line">COPY . .</span><br><span class="line">EXPOSE 7676</span><br><span class="line">CMD [&quot;gunicorn&quot;, &quot;app:app&quot;, &quot;-c&quot;, &quot;./gunicorn.conf.py&quot;]</span><br></pre></td></tr></table></figure><p>运行时把图片的文件目录映射到&#x2F;usr&#x2F;src&#x2F;app&#x2F;images</p><h3 id="更新"><a href="#更新" class="headerlink" title="更新"></a>更新</h3><p>如果需要把缩略图存在本地使用一下代码</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask, request, send_file</span><br><span class="line"><span class="keyword">from</span> werkzeug.routing <span class="keyword">import</span> BaseConverter</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">PathConverter</span>(<span class="title class_ inherited__">BaseConverter</span>):</span><br><span class="line">    regex = <span class="string">r&#x27;.+(\.(jpg|jpeg))&#x27;</span></span><br><span class="line">    weight = <span class="number">200</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line">app.url_map.converters[<span class="string">&#x27;path&#x27;</span>] = PathConverter</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/images&lt;path:file_path&gt;&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">thumbnail</span>(<span class="params">file_path</span>):</span><br><span class="line">    <span class="built_in">print</span>(file_path)</span><br><span class="line">    resize = request.args.get(<span class="string">&quot;resize&quot;</span>)</span><br><span class="line">    <span class="keyword">if</span> resize:</span><br><span class="line">        resize_filepath = <span class="string">&#x27;images&#x27;</span> + (</span><br><span class="line">            <span class="string">&#x27;.&#x27;</span>.join([file_path.split(<span class="string">&#x27;.&#x27;</span>)[<span class="number">0</span>] + <span class="string">&#x27;_resize_&#x27;</span> + resize, file_path.split(<span class="string">&#x27;.&#x27;</span>)[<span class="number">1</span>]]))</span><br><span class="line">        <span class="keyword">if</span> os.path.exists(resize_filepath):</span><br><span class="line">            <span class="keyword">return</span> send_file(resize_filepath)</span><br><span class="line">        w_h = resize.split(<span class="string">&#x27;*&#x27;</span>)</span><br><span class="line">        im = Image.<span class="built_in">open</span>(<span class="string">&#x27;images&#x27;</span> + file_path)</span><br><span class="line">        im.thumbnail((<span class="built_in">int</span>(w_h[<span class="number">0</span>]), <span class="built_in">int</span>(w_h[<span class="number">1</span>])))</span><br><span class="line">        im.save(resize_filepath, <span class="string">&#x27;JPEG&#x27;</span>)</span><br><span class="line">        <span class="keyword">return</span> send_file(resize_filepath)</span><br><span class="line">    <span class="keyword">return</span> send_file(<span class="string">&#x27;images&#x27;</span> + file_path, mimetype=<span class="string">&#x27;image/jpeg&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    app.run()</span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Python开发 </category>
          
          <category> Web服务 </category>
          
          <category> 图像处理 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 图片处理 </tag>
            
            <tag> 性能优化 </tag>
            
            <tag> Web开发 </tag>
            
            <tag> Docker </tag>
            
            <tag> Flask </tag>
            
            <tag> Python </tag>
            
            <tag> Pillow </tag>
            
            <tag> Gunicorn </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>NPS内网穿透：SSH远程连接与Web访问实践方案</title>
      <link href="/2022/01/19/%E4%BD%BF%E7%94%A8nps%E8%BF%9E%E6%8E%A5%E5%86%85%E7%BD%91ssh%E5%92%8C%E8%AE%BF%E9%97%AE%E7%BD%91%E9%A1%B5-%E4%BD%BF%E7%94%A8nps%E8%BF%9E%E6%8E%A5%E5%86%85%E7%BD%91ssh%E5%92%8C%E8%AE%BF%E9%97%AE%E7%BD%91%E9%A1%B5/"/>
      <url>/2022/01/19/%E4%BD%BF%E7%94%A8nps%E8%BF%9E%E6%8E%A5%E5%86%85%E7%BD%91ssh%E5%92%8C%E8%AE%BF%E9%97%AE%E7%BD%91%E9%A1%B5-%E4%BD%BF%E7%94%A8nps%E8%BF%9E%E6%8E%A5%E5%86%85%E7%BD%91ssh%E5%92%8C%E8%AE%BF%E9%97%AE%E7%BD%91%E9%A1%B5/</url>
      
        <content type="html"><![CDATA[<h2 id="安装-NPS"><a href="#安装-NPS" class="headerlink" title="安装 NPS"></a>安装 NPS</h2><blockquote><p>NPS 是提供服务的一个程序，需要安装在有外网 IP 的服务器上。<br><a href="https://github.com/ehang-io/nps/releases">https://github.com/ehang-io/nps/releases</a></p></blockquote><p><a href="https://ehang-io.github.io/nps/#/run?id=%e5%90%af%e5%8a%a8">点击查看安装教程</a></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sudo ./nps install</span><br><span class="line">sudo chmod +x nps</span><br><span class="line">sudo nps start</span><br></pre></td></tr></table></figure><p>编辑配置文件</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim /etc/nps/conf/nps.conf</span><br></pre></td></tr></table></figure><p>运行成功后打开 nps 后台管理界面登录<br>创建一个客户端，填个名字，其他默认，点击创建。<br><img src="https://cdn.jsdelivr.net/gh/houxiaozhao/imageLibrary@master/uPic/2022/05/20/jNwwDD.png" alt="image.png"><br>点击加号＋，展开可以看到一个客户端命令，复制。</p><h2 id="安装-NPC"><a href="#安装-NPC" class="headerlink" title="安装 NPC"></a>安装 NPC</h2><blockquote><p>NPC 客户端，安装在需要被穿透的内网环境下<br><a href="https://github.com/ehang-io/nps/releases">https://github.com/ehang-io/nps/releases</a></p></blockquote><p>客户端下载下来进入到下载的目录，把复制的客户端命令粘贴运行即可。</p><h3 id="docker-compose-运行"><a href="#docker-compose-运行" class="headerlink" title="docker-compose 运行"></a>docker-compose 运行</h3><p><strong>docker-compose.yml</strong></p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">version:</span> <span class="string">&quot;3&quot;</span></span><br><span class="line"><span class="attr">services:</span></span><br><span class="line">  <span class="attr">eapinpc:</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">$&#123;NPC_IMAGE&#125;</span></span><br><span class="line">    <span class="attr">container_name:</span> <span class="string">eapinpc</span></span><br><span class="line">    <span class="attr">restart:</span> <span class="string">always</span></span><br><span class="line">    <span class="attr">network_mode:</span> <span class="string">&quot;host&quot;</span></span><br><span class="line">    <span class="attr">command:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">-server</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">$&#123;NPC_SERVICE&#125;</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">-vkey</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">$&#123;NPC_KEY&#125;</span></span><br></pre></td></tr></table></figure><p><strong>.env</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"># NPC 的 key 部署新机器需要重新生成</span><br><span class="line">NPC_KEY=keykeykeykeykey</span><br><span class="line"># NPC服务地址</span><br><span class="line">NPC_SERVICE=ip地址:端口</span><br><span class="line">NPC_IMAGE=ffdfgdfg/npc:v0.26.10</span><br></pre></td></tr></table></figure><h2 id="配置-TCP-隧道和-SOCKS-代理"><a href="#配置-TCP-隧道和-SOCKS-代理" class="headerlink" title="配置 TCP 隧道和 SOCKS 代理"></a>配置 TCP 隧道和 SOCKS 代理</h2><h3 id="TCP-隧道"><a href="#TCP-隧道" class="headerlink" title="TCP 隧道"></a>TCP 隧道</h3><p>PNS 管理界面，点击客户端后的隧道，点击新增</p><ul><li>使用场景 TCP 隧道</li><li>服务端端口 随便写，可能需要提前打开服务器的防火墙或者配置安全组。</li><li>目标 127.0.0.1:22 需要提前在被控机器上安装 ssh-server</li></ul><h3 id="SOCKS-代理"><a href="#SOCKS-代理" class="headerlink" title="SOCKS 代理"></a>SOCKS 代理</h3><p>PNS 管理界面，点击客户端后的隧道，点击新增</p><ul><li>使用场景 SOCKS 代理</li><li>服务器端口 随便写，同上</li></ul><p>配置完成后可以看到状态<br><img src="https://cdn.jsdelivr.net/gh/houxiaozhao/imageLibrary@master/uPic/2022/05/20/5flEft.png" alt="image.png"><br>到此为止可以使用 ssh 连接到目标服务器。但是使用网页访问目标服务器上的网站还不行，需要浏览器使用代理访问内网网站。</p><h2 id="安装浏览器插件"><a href="#安装浏览器插件" class="headerlink" title="安装浏览器插件"></a>安装浏览器插件</h2><p>安装插件<em>SwitchyOmega</em></p><ol><li>创建情景模式<br><img src="https://cdn.jsdelivr.net/gh/houxiaozhao/imageLibrary@master/uPic/2022/05/20/EiKr7s.png" alt="image.png"><br>选择代理服务器</li><li>添加自动切换规则<br>点击自动切换，然后添加条件<br><img src="https://cdn.jsdelivr.net/gh/houxiaozhao/imageLibrary@master/uPic/2022/05/20/8O5Jgw.png" alt="image.png"><ul><li>条件设置为内网 ip 地址</li><li>情景模式为刚才设置的情景模式</li></ul></li><li>配置默认情景模式<br>最后在界面-&gt;切换设置-&gt;初试情景模式，选择自动切换，然后点击左下角<strong>应用选项</strong><br><img src="https://cdn.jsdelivr.net/gh/houxiaozhao/imageLibrary@master/uPic/2022/05/20/2xd8HD.png" alt="image.png"><br>现在就可以通过在浏览器打开内网 ip 来访问内网的网页了。</li></ol>]]></content>
      
      
      <categories>
          
          <category> 网络技术 </category>
          
          <category> 系统运维 </category>
          
          <category> 安全访问 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 网络安全 </tag>
            
            <tag> NPS </tag>
            
            <tag> 内网穿透 </tag>
            
            <tag> SSH远程 </tag>
            
            <tag> Web代理 </tag>
            
            <tag> Docker部署 </tag>
            
            <tag> 系统配置 </tag>
            
            <tag> 远程访问 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>vue 可编辑 div 组件</title>
      <link href="/2022/01/18/vue%20%E5%8F%AF%E7%BC%96%E8%BE%91%20div%20%E7%BB%84%E4%BB%B6-vue%E5%8F%AF%E7%BC%96%E8%BE%91div%E7%BB%84%E4%BB%B6/"/>
      <url>/2022/01/18/vue%20%E5%8F%AF%E7%BC%96%E8%BE%91%20div%20%E7%BB%84%E4%BB%B6-vue%E5%8F%AF%E7%BC%96%E8%BE%91div%E7%BB%84%E4%BB%B6/</url>
      
        <content type="html"><![CDATA[<blockquote><p><strong>contenteditable</strong>属性可以指定元素内容是否可编辑。</p></blockquote><p>vue 中使用这一属性后，编辑内容却不支持 v-model.<br>不能使用一下方法绑定</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;div contenteditable v-model=&quot;value&quot;&gt;&lt;/div&gt;</span><br></pre></td></tr></table></figure><p>提取成组件后可以使用 v-model</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;p class=&quot;editable&quot; ref=&quot;editable&quot; contenteditable :placeholder=&quot;placeholder&quot; v-on=&quot;listeners&quot;&gt;&lt;/p&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">export default &#123;</span><br><span class="line">  props: &#123;</span><br><span class="line">    value: &#123;</span><br><span class="line">      type: String,</span><br><span class="line">      default: &quot;&quot;,</span><br><span class="line">    &#125;,</span><br><span class="line">    placeholder: &#123;</span><br><span class="line">      type: String,</span><br><span class="line">      default: &quot;&quot;,</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">  computed: &#123;</span><br><span class="line">    listeners() &#123;</span><br><span class="line">      return &#123; ...this.$listeners, input: this.onInput &#125;;</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">  mounted() &#123;</span><br><span class="line">    this.$refs.editable.innerText = this.value;</span><br><span class="line">  &#125;,</span><br><span class="line">  methods: &#123;</span><br><span class="line">    onInput(e) &#123;</span><br><span class="line">      this.$emit(&quot;input&quot;, e.target.innerText);</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line">&lt;style&gt;</span><br><span class="line">.editable:empty:before &#123;</span><br><span class="line">  content: attr(placeholder);</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br><span class="line"></span><br><span class="line">使用方法 ```vue</span><br><span class="line">&lt;Editable placeholder=&quot;输入缺陷说明&quot; v-model=&quot;value&quot; /&gt;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 前端开发 </category>
          
          <category> Vue.js组件 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Vue.js </tag>
            
            <tag> 前端开发 </tag>
            
            <tag> UI组件 </tag>
            
            <tag> 组件开发 </tag>
            
            <tag> contenteditable </tag>
            
            <tag> v-model </tag>
            
            <tag> 可编辑组件 </tag>
            
            <tag> 用户交互 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Cesium 3DTileset渲染优化：屏幕空间误差参数详解</title>
      <link href="/2022/01/18/cesium%203DTileset%E6%98%BE%E7%A4%BA-cesium3dtileset-xian-shi/"/>
      <url>/2022/01/18/cesium%203DTileset%E6%98%BE%E7%A4%BA-cesium3dtileset-xian-shi/</url>
      
        <content type="html"><![CDATA[<p><strong>maximumScreenSpaceError</strong><br>用于驱动细节细化级别的最大屏幕空间错误。默认是 16<br>效果如下<br><img src="https://cdn.jsdelivr.net/gh/houxiaozhao/imageLibrary@master/uPic/2022/05/20/r3zTDc.png" alt="image.png">修改为 4 后<br><img src="https://cdn.jsdelivr.net/gh/houxiaozhao/imageLibrary@master/uPic/2022/05/20/ExWdUt.png" alt="image.png">该参数越小显示效果越好。</p>]]></content>
      
      
      <categories>
          
          <category> WebGIS开发 </category>
          
          <category> 三维可视化 </category>
          
          <category> 性能优化 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Cesium </tag>
            
            <tag> 3D Tiles </tag>
            
            <tag> WebGL </tag>
            
            <tag> 三维渲染 </tag>
            
            <tag> 性能调优 </tag>
            
            <tag> LOD优化 </tag>
            
            <tag> 空间误差 </tag>
            
            <tag> 三维模型 </tag>
            
            <tag> 空间数据 </tag>
            
            <tag> 可视化技术 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Shadowsocks服务器搭建与客户端配置教程</title>
      <link href="/2021/08/20/Shadowsocks-shadowsocks/"/>
      <url>/2021/08/20/Shadowsocks-shadowsocks/</url>
      
        <content type="html"><![CDATA[<h1 id="Shadowsocks"><a href="#Shadowsocks" class="headerlink" title="Shadowsocks"></a>Shadowsocks</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">wget --no-check-certificate -O shadowsocks-all.sh https://raw.githubusercontent.com/teddysun/shadowsocks_install/master/shadowsocks-all.sh</span><br><span class="line"><span class="built_in">chmod</span> +x shadowsocks-all.sh</span><br><span class="line"><span class="built_in">sudo</span> ./shadowsocks-all.sh 2&gt;&amp;1 | <span class="built_in">tee</span> shadowsocks-all.log</span><br></pre></td></tr></table></figure><p>最后一步输完，你应该会看到下图中内容 ── 是要你选择需要安装的 Shadowsocks 版本。这里选择 4) shadowsocks-libev</p><p><img src="https://smalin.cn/assets/img/shadowsocks.e7c80b5a.jpeg" alt="https://smalin.cn/assets/img/shadowsocks.e7c80b5a.jpeg"></p><p>选择完成后会让你输入密码，默认为一个随机密码，你可以回车选择默认，或者自定义一个密码后回车</p><p><img src="https://smalin.cn/assets/img/shadowsocks1.31adf884.jpeg" alt="https://smalin.cn/assets/img/shadowsocks1.31adf884.jpeg"></p><p>密码设置完成后会让你输入一个端口号，默认随机一个，你也可以自定义一个端口号后回车生成</p><p><img src="https://smalin.cn/assets/img/shadowsocks2.76f449e9.jpeg" alt="https://smalin.cn/assets/img/shadowsocks2.76f449e9.jpeg"></p><p>端口号设置完成后，选择一个加密方式，我一般采用 chacha20 来作为加密方式，手机上也是有这个模式的，比较方便，你也可以根据自己的喜好来选择不同的加密方式</p><p><img src="https://smalin.cn/assets/img/shadowsocks3.6fe63d36.jpeg" alt="https://smalin.cn/assets/img/shadowsocks3.6fe63d36.jpeg"></p><p>设置完成后，会提示你是否需要安装 simple-obfs。这是 ss 的一个插件工具，可以起到混淆的作用，防止 IP 和端口被嗅探到，建议选 y 安装。</p><p><img src="https://smalin.cn/assets/img/shadowsocks4.07f0839f.jpeg" alt="https://smalin.cn/assets/img/shadowsocks4.07f0839f.jpeg"></p><p>如果上一步选择了 y ，这里可以选择一种混淆方式。通常 TLS 要比 HTTP 的混淆效果更好，所以选 TLS</p><p><img src="https://smalin.cn/assets/img/shadowsocks5.e63c8cd1.jpeg" alt="https://smalin.cn/assets/img/shadowsocks5.e63c8cd1.jpeg"></p><p>之后就耐心等待安装完成吧，安装完成后会给出你设置的密码、端口、服务器信息配置等，大功告成</p><p><img src="https://smalin.cn/assets/img/shadowsocks6.387d31fa.jpeg" alt="https://smalin.cn/assets/img/shadowsocks6.387d31fa.jpeg"></p><p>记住红色的内容，也就是服务器 IP、服务器 ss 端口、你设的密码、混淆方式和加密方式。</p><h2 id="检查和配置-Shadowsocks"><a href="#检查和配置-Shadowsocks" class="headerlink" title="#检查和配置 Shadowsocks"></a><strong><a href="https://smalin.cn/views/article/Linux/shadowsocks.html#%E6%A3%80%E6%9F%A5%E5%92%8C%E9%85%8D%E7%BD%AE-shadowsocks">#</a>检查和配置 Shadowsocks</strong></h2><p>查看是否开始运行</p><p><code>/etc/init.d/shadowsocks-libev status</code></p><p>如果出现类似  <code>Shadowsocks-libev is running...</code>  的字样，说明已经开始正常运行了。</p><p>修改相关配置</p><p><code>vim /etc/shadowsocks-libev/config.json</code></p><h2 id="安装客户端-Shadowsocks"><a href="#安装客户端-Shadowsocks" class="headerlink" title="#安装客户端 Shadowsocks"></a><strong><a href="https://smalin.cn/views/article/Linux/shadowsocks.html#%E5%AE%89%E8%A3%85%E5%AE%A2%E6%88%B7%E7%AB%AF-shadowsocks">#</a>安装客户端 Shadowsocks</strong></h2><p>相比服务器端的安装，客户端的安装就简单了许多。首先，在**<a href="https://shadowsocks.org/en/download/clients.html">这个页面</a>**找到并下载自己操作系统对应的客户端。</p><p>打开客户端，在「服务器设定」里新增服务器。然后依次填入服务器 IP、服务器端口、你设的密码和加密方式。</p><p><img src="https://smalin.cn/assets/img/shadowsocks7.7885095c.jpeg" alt="https://smalin.cn/assets/img/shadowsocks7.7885095c.jpeg"></p>]]></content>
      
      
      <categories>
          
          <category> 网络工具 </category>
          
          <category> 科学上网 </category>
          
          <category> 服务器配置 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Shadowsocks </tag>
            
            <tag> VPN </tag>
            
            <tag> 代理服务器 </tag>
            
            <tag> 网络安全 </tag>
            
            <tag> 服务器部署 </tag>
            
            <tag> 科学上网工具 </tag>
            
            <tag> 跨境网络访问 </tag>
            
            <tag> Internet Freedom </tag>
            
            <tag> Encryption </tag>
            
            <tag> Privacy Protection </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>threejs 世界坐标系转其他对象本地坐标系方法</title>
      <link href="/2021/07/07/threejs%20%E4%B8%96%E7%95%8C%E5%9D%90%E6%A0%87%E7%B3%BB%E8%BD%AC%E5%85%B6%E4%BB%96%E5%AF%B9%E8%B1%A1%E6%9C%AC%E5%9C%B0%E5%9D%90%E6%A0%87%E7%B3%BB%E6%96%B9%E6%B3%95-threejs%E4%B8%96%E7%95%8C%E5%9D%90%E6%A0%87%E7%B3%BB%E8%BD%AC%E5%85%B6%E4%BB%96%E5%AF%B9%E8%B1%A1%E6%9C%AC%E5%9C%B0%E5%9D%90%E6%A0%87%E7%B3%BB%E6%96%B9%E6%B3%95/"/>
      <url>/2021/07/07/threejs%20%E4%B8%96%E7%95%8C%E5%9D%90%E6%A0%87%E7%B3%BB%E8%BD%AC%E5%85%B6%E4%BB%96%E5%AF%B9%E8%B1%A1%E6%9C%AC%E5%9C%B0%E5%9D%90%E6%A0%87%E7%B3%BB%E6%96%B9%E6%B3%95-threejs%E4%B8%96%E7%95%8C%E5%9D%90%E6%A0%87%E7%B3%BB%E8%BD%AC%E5%85%B6%E4%BB%96%E5%AF%B9%E8%B1%A1%E6%9C%AC%E5%9C%B0%E5%9D%90%E6%A0%87%E7%B3%BB%E6%96%B9%E6%B3%95/</url>
      
        <content type="html"><![CDATA[<h1 id="threejs-世界坐标系转其他对象本地坐标系方法"><a href="#threejs-世界坐标系转其他对象本地坐标系方法" class="headerlink" title="threejs 世界坐标系转其他对象本地坐标系方法"></a>threejs 世界坐标系转其他对象本地坐标系方法</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">const v=new Vector3()// 世界坐标系下的坐标</span><br><span class="line">//obj 待转的对象</span><br><span class="line">const _m1 = new Matrix4()</span><br><span class="line">const position = v.clone()</span><br><span class="line">obj.updateWorldMatrix(true,false)</span><br><span class="line">_m1.copy(e.matrixWorld).invert()</span><br><span class="line">position.applyMatrix4(_m1)</span><br><span class="line">// position为相对与obj的本地坐标系的坐标</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 3D开发 </category>
          
          <category> WebGL </category>
          
      </categories>
      
      
        <tags>
            
            <tag> JavaScript </tag>
            
            <tag> WebGL </tag>
            
            <tag> Three.js </tag>
            
            <tag> 3D开发 </tag>
            
            <tag> 坐标系转换 </tag>
            
            <tag> 矩阵变换 </tag>
            
            <tag> 3D数学 </tag>
            
            <tag> 图形编程 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Three.js高效实现点与圆柱体碰撞检测的数学原理与实践</title>
      <link href="/2021/07/07/threejs%20%E6%A3%80%E6%B5%8B%E7%82%B9%E6%98%AF%E5%90%A6%E5%9C%A8%E5%9C%86%E6%9F%B1%E4%BD%93%E5%86%85-threejs%E6%A3%80%E6%B5%8B%E7%82%B9%E6%98%AF%E5%90%A6%E5%9C%A8%E5%9C%86%E6%9F%B1%E4%BD%93%E5%86%85/"/>
      <url>/2021/07/07/threejs%20%E6%A3%80%E6%B5%8B%E7%82%B9%E6%98%AF%E5%90%A6%E5%9C%A8%E5%9C%86%E6%9F%B1%E4%BD%93%E5%86%85-threejs%E6%A3%80%E6%B5%8B%E7%82%B9%E6%98%AF%E5%90%A6%E5%9C%A8%E5%9C%86%E6%9F%B1%E4%BD%93%E5%86%85/</url>
      
        <content type="html"><![CDATA[<h1 id="threejs-检测点是否在圆柱体内"><a href="#threejs-检测点是否在圆柱体内" class="headerlink" title="threejs 检测点是否在圆柱体内"></a>threejs 检测点是否在圆柱体内</h1><blockquote><p>在 threejs 文档里没有找到相关方法</p></blockquote><p>检测思路：</p><ol><li>把全局坐标系下的点坐标转为圆柱体的相对坐标</li><li>判断点坐标(x,z)是否在(0,0)为中心圆柱的半径为半径的圆内</li><li>判断点坐标的 y 的绝对值是否大于圆柱高度的一半<br><img src="https://cdn.jsdelivr.net/gh/houxiaozhao/imageLibrary@master/uPic/2022/05/20/xtt4T3.png" alt="Untitled.png"><img src="https://cdn.jsdelivr.net/gh/houxiaozhao/imageLibrary@master/uPic/2022/05/20/ZCr5BF.png" alt="Untitled 1.png"></li></ol><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//v:待检测点</span></span><br><span class="line"><span class="comment">//obj:圆柱</span></span><br><span class="line"><span class="keyword">const</span> position = v.<span class="title function_">clone</span>();</span><br><span class="line">obj.<span class="title function_">updateWorldMatrix</span>(<span class="literal">true</span>, <span class="literal">false</span>);</span><br><span class="line"><span class="keyword">const</span> _m1 = <span class="keyword">new</span> <span class="title class_">Matrix4</span>();</span><br><span class="line">_m1.<span class="title function_">copy</span>(e.<span class="property">matrixWorld</span>).<span class="title function_">invert</span>();</span><br><span class="line">position.<span class="title function_">applyMatrix4</span>(_m1);</span><br><span class="line"><span class="comment">// console.log(position)</span></span><br><span class="line"><span class="keyword">const</span> parameters = obj.<span class="property">geometry</span>.<span class="property">parameters</span>;</span><br><span class="line"><span class="comment">// console.log(&#x27;待检测圆柱&#x27;, parameters)</span></span><br><span class="line"><span class="keyword">const</span> v2Center = <span class="keyword">new</span> <span class="title class_">Vector2</span>(position.<span class="property">x</span>, position.<span class="property">z</span>).<span class="title function_">distanceTo</span>(<span class="keyword">new</span> <span class="title class_">Vector2</span>());</span><br><span class="line"><span class="keyword">if</span> (v2Center &lt;= parameters.<span class="property">radiusTop</span> &amp;&amp; <span class="title class_">Math</span>.<span class="title function_">abs</span>(position.<span class="property">y</span>) &lt; parameters.<span class="property">height</span> / <span class="number">2</span>) &#123;</span><br><span class="line">  <span class="comment">// console.log(&#x27;在圆柱内&#x27;, e)</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 3D开发 </category>
          
          <category> WebGL </category>
          
          <category> 图形编程 </category>
          
          <category> 计算机图形学 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> JavaScript </tag>
            
            <tag> WebGL </tag>
            
            <tag> Three.js </tag>
            
            <tag> 3D开发 </tag>
            
            <tag> 3D数学 </tag>
            
            <tag> 图形编程 </tag>
            
            <tag> 碰撞检测 </tag>
            
            <tag> 空间几何 </tag>
            
            <tag> 坐标变换 </tag>
            
            <tag> Matrix4 </tag>
            
            <tag> Vector2 </tag>
            
            <tag> 圆柱体 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>OpenGL图形编程：顶点着色器与片元着色器详解</title>
      <link href="/2021/06/16/OpenGL%20-opengl/"/>
      <url>/2021/06/16/OpenGL%20-opengl/</url>
      
        <content type="html"><![CDATA[<h1 id="OpenGL"><a href="#OpenGL" class="headerlink" title="OpenGL"></a>OpenGL</h1><p><a href="http://zhangwenli.com/blog/2017/02/24/what-is-a-shader/">http://zhangwenli.com/blog/2017/02/24/what-is-a-shader/</a></p><h1 id="顶点着色器（Vertex-Shader）和片元着色器（Fragment-Shader）。"><a href="#顶点着色器（Vertex-Shader）和片元着色器（Fragment-Shader）。" class="headerlink" title="顶点着色器（Vertex Shader）和片元着色器（Fragment Shader）。"></a>顶点着色器（Vertex Shader）和片元着色器（Fragment Shader）。</h1><p>片元着色器是在顶点着色器之后被调用的，因而也可以从顶点着色器往片元着色器传递参数。</p><ol><li><p><strong>顶点着色器</strong></p><p>比如你用 OpenGL 画一个三角形，那就是创建了三个顶点。</p><p>而<strong>顶点着色器就是每个顶点调用一次的程序</strong>。</p><p>在顶点着色器中，可以访问到顶点的三维位置、颜色、法向量等信息。可以通过修改这些值，或者将其传递到片元着色器中，实现特定的渲染效果</p></li><li><p><strong>片元着色器</strong></p><p><strong>片元着色器就是每个片元调用一次的程序</strong>。</p><p>在片元着色器中，可以访问到片元在二维屏幕上的坐标、深度信息、颜色等信息。通过改变这些值，可以实现特定的渲染效果。</p></li></ol><p>同样是颜色信息，在顶点着色器中，得到的是<strong>顶点的颜色</strong>，而在片元着色器中，得到的是<strong>片元的颜色</strong>——也就是说，如果三角形的三个顶点颜色是不同的，片元的颜色就是根据这三个顶点的颜色进行<strong>插值</strong>后的，也可以通俗地理解为，是渐变的。</p><h1 id="矩阵变换"><a href="#矩阵变换" class="headerlink" title="矩阵变换"></a>矩阵变换</h1><p><img src="https://cdn.jsdelivr.net/gh/houxiaozhao/imageLibrary@master/uPic/2022/05/20/cxL6Ec.png" alt="image.png"><br><img src="https://cdn.jsdelivr.net/gh/houxiaozhao/imageLibrary@master/uPic/2022/05/20/vFl3fr.png" alt="image.png"><br>一个物体的三维坐标向量，乘以模型视图矩阵后，能够得到它在试图坐标系中的位置，也就是它相对于摄像机的坐标位置</p><h2 id="1-和角度相关的函数"><a href="#1-和角度相关的函数" class="headerlink" title="1. 和角度相关的函数"></a><strong>1. 和角度相关的函数</strong></h2><p>下面是一个和角度相关的函数，他们的用法我们度熟悉。</p><p><img src="https://cdn.jsdelivr.net/gh/houxiaozhao/imageLibrary@master/uPic/2022/05/20/EVPugD.png" alt="image-d0beb12c9f804892a781e672201b4886"><img src="/" alt="image.png"></p><h2 id="2-数学函数"><a href="#2-数学函数" class="headerlink" title="2. 数学函数"></a><strong>2. 数学函数</strong></h2><p>这类主要是对指数对数幂函数的操作<br><img src="https://cdn.jsdelivr.net/gh/houxiaozhao/imageLibrary@master/uPic/2022/05/20/Zmm29y.png" alt="image.png"></p><h2 id="3-常用函数"><a href="#3-常用函数" class="headerlink" title="3. 常用函数"></a><strong>3. 常用函数</strong></h2><p>这里是常用函数，和 js 中的内置函数很像，需要牢记。</p><p><img src="https://cdn.jsdelivr.net/gh/houxiaozhao/imageLibrary@master/uPic/2022/05/20/ktbw5h.png" alt="image.png"></p><h2 id="4-几何函数"><a href="#4-几何函数" class="headerlink" title="4. 几何函数"></a><strong>4. 几何函数</strong></h2><p>这是与长度、距离、向量等相关的函数</p><p><img src="https://cdn.jsdelivr.net/gh/houxiaozhao/imageLibrary@master/uPic/2022/05/20/UjDJNN.png" alt="image.png"></p>]]></content>
      
      
      <categories>
          
          <category> 图形编程 </category>
          
          <category> 计算机图形学 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> OpenGL </tag>
            
            <tag> 图形渲染 </tag>
            
            <tag> 着色器 </tag>
            
            <tag> 顶点着色器 </tag>
            
            <tag> 片元着色器 </tag>
            
            <tag> 3D图形 </tag>
            
            <tag> Graphics Programming </tag>
            
            <tag> Shader Development </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Cesium实体动画：基于事件驱动的Entity移动与旋转实现</title>
      <link href="/2021/05/24/cesium%20entity%20%E7%A7%BB%E5%8A%A8%E5%92%8C%E6%97%8B%E8%BD%AC%E7%9A%84%E6%96%B9%E6%B3%95-cesiumentity%E7%A7%BB%E5%8A%A8%E5%92%8C%E6%97%8B%E8%BD%AC%E7%9A%84%E6%96%B9%E6%B3%95/"/>
      <url>/2021/05/24/cesium%20entity%20%E7%A7%BB%E5%8A%A8%E5%92%8C%E6%97%8B%E8%BD%AC%E7%9A%84%E6%96%B9%E6%B3%95-cesiumentity%E7%A7%BB%E5%8A%A8%E5%92%8C%E6%97%8B%E8%BD%AC%E7%9A%84%E6%96%B9%E6%B3%95/</url>
      
        <content type="html"><![CDATA[<h1 id="cesium-entity-移动和旋转的方法"><a href="#cesium-entity-移动和旋转的方法" class="headerlink" title="cesium entity 移动和旋转的方法"></a>cesium entity 移动和旋转的方法</h1><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title class_">EventEmitter</span> = <span class="built_in">require</span>(<span class="string">&quot;events&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">class</span> <span class="title class_">Air</span> <span class="keyword">extends</span> <span class="title class_ inherited__">EventEmitter</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params">viewer, uri, id, position, orientation</span>) &#123;</span><br><span class="line">    <span class="variable language_">super</span>();</span><br><span class="line"></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">active</span> = <span class="literal">false</span>;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">air</span> = viewer.<span class="property">entities</span>.<span class="title function_">add</span>(&#123;</span><br><span class="line">      <span class="attr">id</span>: id,</span><br><span class="line">      <span class="attr">position</span>: position,</span><br><span class="line">      <span class="attr">orientation</span>: orientation,</span><br><span class="line">      <span class="attr">viewFrom</span>: <span class="keyword">new</span> <span class="title class_">Cesium</span>.<span class="title class_">Cartesian3</span>(<span class="number">0</span>, -<span class="number">30</span>, <span class="number">30</span>),</span><br><span class="line">      <span class="attr">model</span>: &#123;</span><br><span class="line">        uri,</span><br><span class="line">        <span class="attr">scale</span>: <span class="number">0.04</span>,</span><br><span class="line">      &#125;,</span><br><span class="line">    &#125;);</span><br><span class="line">    viewer.<span class="property">scene</span>.<span class="property">preRender</span>.<span class="title function_">addEventListener</span>(<span class="variable language_">this</span>.<span class="property">update</span>.<span class="title function_">bind</span>(<span class="variable language_">this</span>));</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">update</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> now = <span class="keyword">new</span> <span class="title class_">Date</span>().<span class="title function_">getTime</span>();</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">active</span>) &#123;</span><br><span class="line">      <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">startTime</span> &amp;&amp; <span class="variable language_">this</span>.<span class="property">endTime</span> &amp;&amp; <span class="variable language_">this</span>.<span class="property">startTime</span> &lt; now &amp;&amp; now &lt; <span class="variable language_">this</span>.<span class="property">endTime</span>) &#123;</span><br><span class="line">        <span class="keyword">const</span> lerp = (now - <span class="variable language_">this</span>.<span class="property">startTime</span>) / (<span class="variable language_">this</span>.<span class="property">endTime</span> - <span class="variable language_">this</span>.<span class="property">startTime</span>);</span><br><span class="line">        <span class="keyword">const</span> posotion = <span class="title class_">Cesium</span>.<span class="property">Cartesian3</span>.<span class="title function_">lerp</span>(<span class="variable language_">this</span>.<span class="property">initial</span>.<span class="property">position</span>, <span class="variable language_">this</span>.<span class="property">target</span>.<span class="property">position</span>, lerp, <span class="keyword">new</span> <span class="title class_">Cesium</span>.<span class="title class_">Cartesian3</span>());</span><br><span class="line">        <span class="keyword">const</span> orientation = <span class="title class_">Cesium</span>.<span class="property">Quaternion</span>.<span class="title function_">slerp</span>(<span class="variable language_">this</span>.<span class="property">initial</span>.<span class="property">orientation</span>, <span class="variable language_">this</span>.<span class="property">target</span>.<span class="property">orientation</span>, lerp, <span class="keyword">new</span> <span class="title class_">Cesium</span>.<span class="title class_">Quaternion</span>());</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">air</span>.<span class="property">position</span> = posotion;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">air</span>.<span class="property">orientation</span> = orientation;</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">active</span>) &#123;</span><br><span class="line">          <span class="variable language_">this</span>.<span class="property">active</span> = <span class="literal">false</span>;</span><br><span class="line">          <span class="variable language_">this</span>.<span class="title function_">emit</span>(<span class="string">&quot;end&quot;</span>);</span><br><span class="line">          <span class="keyword">if</span> (!<span class="variable language_">this</span>.<span class="property">initial</span>.<span class="property">position</span>.<span class="title function_">equals</span>(<span class="variable language_">this</span>.<span class="property">target</span>.<span class="property">position</span>)) <span class="variable language_">this</span>.<span class="title function_">emit</span>(<span class="string">&quot;moved&quot;</span>);</span><br><span class="line">          <span class="keyword">if</span> (!<span class="variable language_">this</span>.<span class="property">initial</span>.<span class="property">orientation</span>.<span class="title function_">equals</span>(<span class="variable language_">this</span>.<span class="property">target</span>.<span class="property">orientation</span>)) <span class="variable language_">this</span>.<span class="title function_">emit</span>(<span class="string">&quot;rotated&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">moveTarget</span>(<span class="params">&#123; position, orientation, speed = <span class="number">5</span> &#125;</span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">initial</span> = &#123;</span><br><span class="line">      <span class="attr">position</span>: <span class="variable language_">this</span>.<span class="property">air</span>.<span class="property">position</span>.<span class="title function_">getValue</span>(),</span><br><span class="line">      <span class="attr">orientation</span>: <span class="variable language_">this</span>.<span class="property">air</span>.<span class="property">orientation</span>.<span class="title function_">getValue</span>(),</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">target</span> = &#123;</span><br><span class="line">      <span class="attr">position</span>: position || <span class="variable language_">this</span>.<span class="property">initial</span>.<span class="property">position</span>,</span><br><span class="line">      <span class="attr">orientation</span>: orientation || <span class="variable language_">this</span>.<span class="property">initial</span>.<span class="property">orientation</span>,</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="keyword">const</span> duration = <span class="title class_">Cesium</span>.<span class="property">Cartesian3</span>.<span class="title function_">distance</span>(<span class="variable language_">this</span>.<span class="property">initial</span>.<span class="property">position</span>, <span class="variable language_">this</span>.<span class="property">target</span>.<span class="property">position</span>) / speed || <span class="number">2</span>; <span class="comment">// 如果没有移动位置，只有旋转则时间为两秒</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">startTime</span> = <span class="keyword">new</span> <span class="title class_">Date</span>().<span class="title function_">getTime</span>();</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">endTime</span> = <span class="keyword">new</span> <span class="title class_">Date</span>(<span class="variable language_">this</span>.<span class="property">startTime</span> + duration * <span class="number">1000</span>).<span class="title function_">getTime</span>();</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">active</span> = <span class="literal">true</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> WebGIS开发 </category>
          
          <category> 三维可视化 </category>
          
          <category> JavaScript编程 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> JavaScript </tag>
            
            <tag> Cesium </tag>
            
            <tag> WebGIS </tag>
            
            <tag> 三维动画 </tag>
            
            <tag> Entity操作 </tag>
            
            <tag> Cartesian3 </tag>
            
            <tag> Quaternion </tag>
            
            <tag> 事件驱动 </tag>
            
            <tag> 空间计算 </tag>
            
            <tag> 动画控制 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Cesium与Vue集成：WebGIS三维可视化开发实战案例</title>
      <link href="/2021/04/27/cesium%20%E7%9A%84%E5%87%A0%E4%B8%AA%E5%B0%8F%E4%BE%8B%E5%AD%90/"/>
      <url>/2021/04/27/cesium%20%E7%9A%84%E5%87%A0%E4%B8%AA%E5%B0%8F%E4%BE%8B%E5%AD%90/</url>
      
        <content type="html"><![CDATA[<h1 id="cesium-的几个小例子"><a href="#cesium-的几个小例子" class="headerlink" title="cesium 的几个小例子"></a>cesium 的几个小例子</h1><p><a href="https://github.com/houxiaozhao/cesium-demo">houxiaozhao&#x2F;cesium-demo</a></p><h3 id="安装"><a href="#安装" class="headerlink" title="安装"></a><strong>安装</strong></h3><p>使用前先安装 cesium</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install cesium</span><br></pre></td></tr></table></figure><p>其他依赖包括（非必要，为了方便和好看）不需要安装，已经包含在仓库内</p><ul><li>vue</li><li>echarts</li><li>element</li></ul><h3 id="使用"><a href="#使用" class="headerlink" title="使用"></a><strong>使用</strong></h3><p>anywhere 或其他静态文件服务器</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">anywhere</span><br></pre></td></tr></table></figure><h3 id="效果"><a href="#效果" class="headerlink" title="效果"></a><strong>效果</strong></h3><p><img src="https://github.com/houxiaozhao/cesium-demo/raw/master/img/3.gif" alt="https://github.com/houxiaozhao/cesium-demo/raw/master/img/3.gif"></p><p><img src="https://github.com/houxiaozhao/cesium-demo/raw/master/img/2.gif" alt="https://github.com/houxiaozhao/cesium-demo/raw/master/img/2.gif"></p><p><img src="https://github.com/houxiaozhao/cesium-demo/raw/master/img/1.gif" alt="https://github.com/houxiaozhao/cesium-demo/raw/master/img/1.gif"></p>]]></content>
      
      
      <categories>
          
          <category> WebGIS开发 </category>
          
          <category> 前端开发 </category>
          
          <category> 三维可视化 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Vue.js </tag>
            
            <tag> Cesium </tag>
            
            <tag> WebGIS </tag>
            
            <tag> 三维地图 </tag>
            
            <tag> 可视化开发 </tag>
            
            <tag> Element UI </tag>
            
            <tag> ECharts </tag>
            
            <tag> npm包管理 </tag>
            
            <tag> 前端集成 </tag>
            
            <tag> 地图交互 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Egg.js 与 Swagger 集成：构建自动化 API 文档系统</title>
      <link href="/2021/04/14/%E6%8E%A5%E5%8F%A3%E6%96%87%E6%A1%A3eggjs%E5%92%8Cswagger%E9%85%8D%E5%90%88-%E6%8E%A5%E5%8F%A3%E6%96%87%E6%A1%A3eggjs%E5%92%8Cswagger%E9%85%8D%E5%90%88/"/>
      <url>/2021/04/14/%E6%8E%A5%E5%8F%A3%E6%96%87%E6%A1%A3eggjs%E5%92%8Cswagger%E9%85%8D%E5%90%88-%E6%8E%A5%E5%8F%A3%E6%96%87%E6%A1%A3eggjs%E5%92%8Cswagger%E9%85%8D%E5%90%88/</url>
      
        <content type="html"><![CDATA[<h1 id="接口文档-eggjs-和-swagger-配合"><a href="#接口文档-eggjs-和-swagger-配合" class="headerlink" title="接口文档 eggjs 和 swagger 配合"></a>接口文档 eggjs 和 swagger 配合</h1><blockquote><p>好运盈后台接口文档管理采用 Swagger 自动化生成发布。使用 egg-swagger 插件配合 egg 开发框架使用 <a href="https://github.com/Yanshijie-EL/egg-swagger-doc">https://github.com/Yanshijie-EL/egg-swagger-doc</a></p></blockquote><h3 id="Swagger-介绍"><a href="#Swagger-介绍" class="headerlink" title="Swagger 介绍"></a>Swagger 介绍</h3><p>Swagger 是一款 RESTFUL 接口的文档在线自动生成+功能测试功能软件。Swagger 是一个规范和完整的框架,用于生成、描述、调用和可视化 RESTful 风格的 Web 服务。目标是使客户端和文件系统作为服务器以同样的速度来更新文件的方法,参数和模型紧密集成到服务器。</p><h3 id="使用方法"><a href="#使用方法" class="headerlink" title="使用方法"></a>使用方法</h3><ol><li><p>安装 egg-swagger-doc</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i egg-swagger-doc --save</span><br></pre></td></tr></table></figure></li><li><p>在 app&#x2F;文件夹下新建 contract 文件夹</p></li><li><p>添加配置</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">config.swaggerdoc = &#123;    dirScanner: &#x27;./app/controller&#x27;,    apiInfo: &#123;      title: &#x27;好运盈&#x27;,      description: &#x27;好运盈接口文档&#x27;,      version: &#x27;1.0.1&#x27;,    &#125;,    schemes: [ &#x27;http&#x27;, &#x27;https&#x27; ],    consumes: [ &#x27;application/json&#x27; ],    produces: [ &#x27;application/json&#x27; ],    enableSecurity: false,    // enableValidate: true,    routerMap: false,    enable: true,  &#125;;</span><br></pre></td></tr></table></figure></li><li><p>在 controller 类添加注释</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/** * @controller sys_user_auth 系统用户认证接口 */</span><br></pre></td></tr></table></figure></li><li><p>在 controller 方法添加注释,具体参数含义参考插件文档</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/**  * @summary 更新  * @description 更新信息  * @router put /sys_user/partner/:id  * @request path string id id  * @request body createPartner *body  * @request header string *Authorization token  * @response 200 baseResponse 已更新id  */</span><br></pre></td></tr></table></figure><p>其中<code>createPartner</code> 需要在 contract 文件夹新建文件并定义，文件名随意,最后导出即可</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">module.exports = &#123;  createPartner: &#123;    user: &#123; type: &#x27;string&#x27;, required: true, example: &#x27;123123123123&#x27;, description: &#x27;用户id&#x27; &#125;,    teams: &#123; type: &#x27;array&#x27;, itemType: &#x27;string&#x27;, description: &#x27;团队id数组&#x27; &#125;,  &#125;&#125;;</span><br></pre></td></tr></table></figure></li><li><p>程序启动后，插件自动扫描 controller 下的文件，并新增两个路由页面<code>/swagger-doc</code> <code>/swagger-ui.html</code>其中<code>/swagger-ui.html</code>即生成文档页面，<code>/swagger-doc</code>生成标准 swagger 文档格式</p></li></ol><h3 id="更新-swagger-文档到-yapi-平台"><a href="#更新-swagger-文档到-yapi-平台" class="headerlink" title="更新 swagger 文档到 yapi 平台"></a>更新 swagger 文档到 yapi 平台</h3><ol><li><p>安装<code>yarn add yapi-cli -D</code></p></li><li><p>新建配置文件</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">//yapi-import.json&#123;    &quot;type&quot;: &quot;swagger&quot;,    &quot;token&quot;: &quot;xxxxxx&quot;,    &quot;file&quot;: &quot;http://127.0.0.1:8100/swagger-doc&quot;,    &quot;merge&quot;: &quot;good&quot;,    &quot;server&quot;: &quot;http://111.111.111.111:3000/&quot;&#125;// type 是数据数据方式，目前官方只支持 swagger// token 是项目token，在 项目设置 -&gt; token 设置获取// file 是 swagger 接口文档文件，可使用绝对路径或 url// merge 导入旧的接口策略，默认使用智能模式，一共有 &quot;normal&quot;(普通模式) , &quot;good&quot;(智能合并), &quot;merge&quot;(完全覆盖) 三种模式// server 是yapi服务器地址</span><br></pre></td></tr></table></figure></li><li><p>package.json 添加 script</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&quot;yapi&quot;:&quot;yapi import&quot;</span><br></pre></td></tr></table></figure></li><li><p>执行<code>npm run yapi</code></p></li></ol><h3 id="自动生成-js-调用代码"><a href="#自动生成-js-调用代码" class="headerlink" title="自动生成 js 调用代码"></a>自动生成 js 调用代码</h3><p><a href="https://github.com/hellosean1025/yapi-gen-js-code">https://github.com/hellosean1025/yapi-gen-js-code</a></p>]]></content>
      
      
      <categories>
          
          <category> 后端开发 </category>
          
          <category> API文档 </category>
          
          <category> Node.js </category>
          
      </categories>
      
      
        <tags>
            
            <tag> JavaScript </tag>
            
            <tag> Node.js </tag>
            
            <tag> 自动化工具 </tag>
            
            <tag> Egg.js </tag>
            
            <tag> 后端开发 </tag>
            
            <tag> RESTful API </tag>
            
            <tag> Swagger </tag>
            
            <tag> API文档 </tag>
            
            <tag> YApi </tag>
            
            <tag> 接口管理 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Node.js 错误处理实用指南：Promise与Async/Await最佳实践</title>
      <link href="/2021/04/07/Node%20js%E9%94%99%E8%AF%AF%E5%A4%84%E7%90%86%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5%20-nodejs%E9%94%99%E8%AF%AF%E5%A4%84%E7%90%86%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5/"/>
      <url>/2021/04/07/Node%20js%E9%94%99%E8%AF%AF%E5%A4%84%E7%90%86%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5%20-nodejs%E9%94%99%E8%AF%AF%E5%A4%84%E7%90%86%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5/</url>
      
        <content type="html"><![CDATA[<h1 id="Node-js-错误处理最佳实践"><a href="#Node-js-错误处理最佳实践" class="headerlink" title="Node.js 错误处理最佳实践"></a>Node.js 错误处理最佳实践</h1><h2 id="使用-Promise-捕获错误"><a href="#使用-Promise-捕获错误" class="headerlink" title="使用 Promise 捕获错误"></a>使用 Promise 捕获错误</h2><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> func = <span class="keyword">function</span> (<span class="params">n</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="title function_">resolve</span>(n * n);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;;</span><br><span class="line"><span class="title function_">func</span>(<span class="number">2</span>)</span><br><span class="line">  .<span class="title function_">then</span>(<span class="function"><span class="params">res</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(res);</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_">func</span>(res);</span><br><span class="line">  &#125;)</span><br><span class="line">  .<span class="title function_">then</span>(<span class="function"><span class="params">res</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(res);</span><br><span class="line">    <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">Error</span>(<span class="string">&quot;Error&quot;</span>);</span><br><span class="line">  &#125;)</span><br><span class="line">  .<span class="title function_">then</span>(<span class="function"><span class="params">res</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(res);</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_">func</span>(res);</span><br><span class="line">  &#125;)</span><br><span class="line">  .<span class="title function_">catch</span>(<span class="function"><span class="params">err</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(err);</span><br><span class="line">  &#125;)</span><br><span class="line">  .<span class="title function_">finally</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;结束&quot;</span>);</span><br><span class="line">  &#125;);</span><br></pre></td></tr></table></figure><h2 id="使用-async-x2F-await-捕获错误"><a href="#使用-async-x2F-await-捕获错误" class="headerlink" title="使用 async&#x2F;await 捕获错误"></a>使用 async&#x2F;await 捕获错误</h2><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> func = <span class="keyword">function</span> (<span class="params">n</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="title function_">resolve</span>(n * n);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">asyncTask</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> valueA = <span class="keyword">await</span> <span class="title function_">func</span>(<span class="number">2</span>);</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(valueA);</span><br><span class="line">    <span class="keyword">const</span> valueB = <span class="keyword">await</span> <span class="title function_">func</span>(valueA);</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(valueB);</span><br><span class="line">    <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">Error</span>(<span class="string">&quot;Error&quot;</span>);</span><br><span class="line">    <span class="keyword">const</span> valueC = <span class="keyword">await</span> <span class="title function_">func</span>(valueB);</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(valueC);</span><br><span class="line">    <span class="keyword">return</span> valueC;</span><br><span class="line">  &#125; <span class="keyword">catch</span> (err) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(err);</span><br><span class="line">  &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;结束&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_">asyncTask</span>();</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 后端开发 </category>
          
          <category> Node.js </category>
          
          <category> 错误处理 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> JavaScript </tag>
            
            <tag> Node.js </tag>
            
            <tag> 性能优化 </tag>
            
            <tag> 服务端开发 </tag>
            
            <tag> Promise </tag>
            
            <tag> Async/Await </tag>
            
            <tag> 错误处理 </tag>
            
            <tag> 异步编程 </tag>
            
            <tag> 异常处理 </tag>
            
            <tag> 代码质量 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>NestJS 企业级应用开发：基于 MongoDB 和 JWT 的 RESTful API 模板</title>
      <link href="/2021/03/04/%E5%9F%BA%E4%BA%8E%20nestjs%20mongoose%20jwt%20%E7%9A%84%20restful%20%E6%A8%A1%E6%9D%BF%E7%A8%8B%E5%BA%8F%20%E7%94%A8%E4%BA%8E%E5%BF%AB%E9%80%9F%E6%90%AD%E5%BB%BA%E6%9C%8D%E5%8A%A1%E7%AB%AF%E7%A8%8B%E5%BA%8F/"/>
      <url>/2021/03/04/%E5%9F%BA%E4%BA%8E%20nestjs%20mongoose%20jwt%20%E7%9A%84%20restful%20%E6%A8%A1%E6%9D%BF%E7%A8%8B%E5%BA%8F%20%E7%94%A8%E4%BA%8E%E5%BF%AB%E9%80%9F%E6%90%AD%E5%BB%BA%E6%9C%8D%E5%8A%A1%E7%AB%AF%E7%A8%8B%E5%BA%8F/</url>
      
        <content type="html"><![CDATA[<h1 id="基于-nestjs-mongoose-jwt-的-restful-模板程序-用于快速搭建服务端程序"><a href="#基于-nestjs-mongoose-jwt-的-restful-模板程序-用于快速搭建服务端程序" class="headerlink" title="基于 nestjs mongoose jwt 的 restful 模板程序 用于快速搭建服务端程序"></a>基于 nestjs mongoose jwt 的 restful 模板程序 用于快速搭建服务端程序</h1><p><a href="https://github.com/houxiaozhao/template">houxiaozhao&#x2F;template</a></p><h2 id="涉及技术框架"><a href="#涉及技术框架" class="headerlink" title="涉及技术框架"></a><strong>涉及技术框架</strong></h2><ul><li>nestjs 服务框架</li><li>mongoose 操作数据库的库<ul><li>typegoose 使用类定义数据模型</li><li>nestjs-typegoose</li><li>mongoose-paginate 分页插件</li></ul></li><li>jwt 生成验证 token</li><li>swagger 文档生成</li></ul><h2 id="配置文件"><a href="#配置文件" class="headerlink" title="配置文件"></a><strong>配置文件</strong></h2><p>nestjs-config 管理配置文件</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">/env/</span><br><span class="line">/src/config/</span><br></pre></td></tr></table></figure><h2 id="Redis-缓存基本用法"><a href="#Redis-缓存基本用法" class="headerlink" title="Redis 缓存基本用法"></a><strong>Redis 缓存基本用法</strong></h2><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// controller</span></span><br><span class="line">@<span class="title class_">HttpCache</span>(<span class="variable constant_">ARTICLE</span>, <span class="number">60</span>)</span><br><span class="line">@<span class="title class_">UseInterceptors</span>(<span class="title class_">HttpCacheInterceptor</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// module</span></span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">CacheModule</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;src/common/processors/cache/cache.module&#x27;</span>;</span><br><span class="line">@<span class="title class_">Module</span>(&#123;</span><br><span class="line">  <span class="attr">imports</span>: [<span class="title class_">CacheModule</span>]</span><br><span class="line">&#125;)</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="功能"><a href="#功能" class="headerlink" title="功能"></a><strong>功能</strong></h2><ul><li><input checked="" disabled="" type="checkbox"> 用户登陆注册</li><li><input checked="" disabled="" type="checkbox"> jwt 验证</li><li><input checked="" disabled="" type="checkbox"> 增删改查，分页查询</li><li><input checked="" disabled="" type="checkbox"> 统一异常处理（使用业务状态码）</li><li><input checked="" disabled="" type="checkbox"> 统一返回结构</li><li><input checked="" disabled="" type="checkbox"> 自定义 user 装饰器 src&#x2F;common&#x2F;decorator&#x2F;user.decorator</li><li><input checked="" disabled="" type="checkbox"> mongo objectid 示例管道</li><li><input checked="" disabled="" type="checkbox"> 跨域处理</li><li><input checked="" disabled="" type="checkbox"> 文件上传示例(转存到云服务)</li><li><input checked="" disabled="" type="checkbox"> redis 缓存</li><li><input disabled="" type="checkbox"> 异常发送邮件提醒</li><li><input checked="" disabled="" type="checkbox"> 权限角色管理</li><li><input checked="" disabled="" type="checkbox"> 自动生成代码</li></ul><h2 id="Installation"><a href="#Installation" class="headerlink" title="Installation"></a><strong>Installation</strong></h2><p><code>$ npm install</code></p><h2 id="Running-the-app"><a href="#Running-the-app" class="headerlink" title="Running the app"></a><strong>Running the app</strong></h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># development</span></span><br><span class="line">$ npm run start</span><br><span class="line"></span><br><span class="line"><span class="comment"># watch mode</span></span><br><span class="line">$ npm run start:dev</span><br><span class="line"></span><br><span class="line"><span class="comment"># production mode</span></span><br><span class="line">$ npm run start:prod</span><br></pre></td></tr></table></figure><h2 id="Test"><a href="#Test" class="headerlink" title="Test"></a><strong>Test</strong></h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># unit tests</span></span><br><span class="line">$ npm run <span class="built_in">test</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># e2e tests</span></span><br><span class="line">$ npm run <span class="built_in">test</span>:e2e</span><br><span class="line"></span><br><span class="line"><span class="comment"># test coverage</span></span><br><span class="line">$ npm run <span class="built_in">test</span>:cov</span><br></pre></td></tr></table></figure><h2 id="文档地址"><a href="#文档地址" class="headerlink" title="文档地址"></a><strong>文档地址</strong></h2><p><a href="http://127.0.0.1:3001/doc">http://127.0.0.1:3001/doc</a></p><h2 id="异常处理"><a href="#异常处理" class="headerlink" title="异常处理"></a><strong>异常处理</strong></h2><p>异常过滤器</p><ul><li>src\common\filters\http-exception.filter.ts</li></ul><p>自定义 api 异常</p><ul><li>src\common\exceptions\api.exception.ts</li></ul><p>拦截器</p><ul><li>src\common\interceptor\exception.interceptor.ts</li><li>src\common\interceptor\transform.interceptor.ts</li></ul><h3 id="异常使用方式"><a href="#异常使用方式" class="headerlink" title="异常使用方式"></a><strong>异常使用方式</strong></h3><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">ApiException</span>(<span class="string">&quot;ID无效&quot;</span>, <span class="title class_">ApiErrorCode</span>.<span class="property">ID_INVALID</span>, <span class="title class_">HttpStatus</span>.<span class="property">BAD_REQUEST</span>);</span><br><span class="line"><span class="comment">// &#123;</span></span><br><span class="line"><span class="comment">//   &quot;status&quot;: 400,</span></span><br><span class="line"><span class="comment">//   &quot;timestamp&quot;: &quot;2020-10-26T01:20:18.452Z&quot;,</span></span><br><span class="line"><span class="comment">//   &quot;path&quot;: &quot;/article/5f93df3b03ac4483c069b0092&quot;,</span></span><br><span class="line"><span class="comment">//   &quot;errorCode&quot;: 10001,</span></span><br><span class="line"><span class="comment">//   &quot;message&quot;: &quot;ID无效&quot;</span></span><br><span class="line"><span class="comment">// &#125;</span></span><br><span class="line"><span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">HttpException</span>(</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">message</span>: <span class="string">&quot;请求参数id 必传&quot;</span>,</span><br><span class="line">    <span class="attr">errorCode</span>: <span class="string">&quot;10000&quot;</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="title class_">HttpStatus</span>.<span class="property">BAD_REQUEST</span></span><br><span class="line">);</span><br></pre></td></tr></table></figure><h3 id="接口文档-（yapi）"><a href="#接口文档-（yapi）" class="headerlink" title="接口文档 （yapi）"></a><strong>接口文档 （yapi）</strong></h3><p>使用 yapi import 工具 导入 swagger 文档到 yapi 中 配置<code>yapi-import.json</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm run yapi</span><br></pre></td></tr></table></figure><h3 id="api-代码生成-yapi-gen-js-code"><a href="#api-代码生成-yapi-gen-js-code" class="headerlink" title="api 代码生成(yapi-gen-js-code)"></a><strong>api 代码生成(yapi-gen-js-code)</strong></h3><p>使用 yapi-gen-js-code 进行 yapi 的代码生成 进行了一些调整修改，以适配当前前端代码 使用配置<code>yapi-import.json</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm run gapi</span><br></pre></td></tr></table></figure><p>生成的代码只需要把需要的部分复制到前端相应的文件中</p><h3 id="权限角色思路"><a href="#权限角色思路" class="headerlink" title="权限角色思路"></a><strong>权限角色思路</strong></h3><p>使用<code>putApi2DB.js</code>把 ypi 上的接口全都插入到数据库中。单独修改里面的配置</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">node .\putApi2DB.js</span><br></pre></td></tr></table></figure><h3 id="Getting-started"><a href="#Getting-started" class="headerlink" title="Getting started"></a><strong>Getting started</strong></h3><p>需要先创建公司，分配公司管理员权限（务必把角色和用户管理权限分配给管理员，否则公司管理员无法自行管理用户角色）。使用 db.js 已配置</p><ol><li>先把 db.js 导入到数据库 后台管理用户名密码 houxiaozhao&#x2F;houxiaozhao</li><li>测试公司用户名密码 18300000000&#x2F;18300000000</li></ol><h3 id="rest-接口使用方式"><a href="#rest-接口使用方式" class="headerlink" title="rest 接口使用方式"></a><strong>rest 接口使用方式</strong></h3><ol><li><p>CRUD 生成器</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nest g resource modules/device --no-spec</span><br></pre></td></tr></table></figure></li><li><p>Model Service Controller DTO 修改</p></li><li><p>yapi(可选)</p><ul><li>接口文档同步到 yapi</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm run yapi</span><br></pre></td></tr></table></figure><ul><li>生成前端代码</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm run gapi</span><br></pre></td></tr></table></figure></li><li><p>把 api 接口加到数据库中（可选）</p><ul><li>添加 api（设置为需要验证）</li><li>设置权限</li><li>设置角色</li><li>添加菜单</li><li>添加按钮（可选，权限设置）</li></ul></li><li><p>登录管理后台，创建 api，创建菜单，创建设备管理权限</p></li><li><p>登录用户前端，角色管理，创建设备管理角色，为用户分配设备管理角色，然后刷新即可显示出设备管理菜单（现在点击菜单显示 404）</p></li><li><p>切换到前端代码 web</p><ul><li><p>创建页面设备管理页面(device&#x2F;index.vue)</p></li><li><p>创建路由（和第 5 步创建菜单的路径一致）</p></li><li><p>复制 views&#x2F;demo&#x2F;page1&#x2F;index.vue 的代码到 device&#x2F;index.vue,修改 name 和路由一致</p></li><li><p>在&#x2F;src&#x2F;api&#x2F;modules 文件夹创建 device.api.js</p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="title function_">default</span> (&#123; service, request, serviceForMock, requestForMock, mock, faker, tools &#125;) =&gt; (&#123;</span><br><span class="line">  <span class="comment">// 自动生成代码</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></li><li><p>复制自动生成的关于设备管理代码到&#x2F;src&#x2F;api&#x2F;modules&#x2F;device.api.js</p></li><li><p>修改&#x2F;device&#x2F;index.vue 里的增删改查函数名称</p></li><li><p>根据需要修改字段</p><ul><li>addDataForm</li><li>editDataForm</li><li>addRules</li><li>editRules</li><li>addData 函数定义添加字段</li><li>editData 函数定义编辑字段</li><li>表格显示字段</li><li>添加表单</li><li>编辑表单</li></ul></li><li><p>如果配置了按钮权限（能不能添加、编辑、删除等），需要使用<code>buttonid</code>指令 xxx 为数据库按钮的 id</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">v-buttonid=&quot;&#x27;xxx&#x27;&quot;</span><br></pre></td></tr></table></figure></li></ul></li></ol>]]></content>
      
      
      <categories>
          
          <category> 后端开发 </category>
          
          <category> Node.js </category>
          
          <category> 企业应用 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> RESTful API </tag>
            
            <tag> NestJS </tag>
            
            <tag> MongoDB </tag>
            
            <tag> JWT认证 </tag>
            
            <tag> TypeScript </tag>
            
            <tag> Swagger </tag>
            
            <tag> Redis缓存 </tag>
            
            <tag> 权限管理 </tag>
            
            <tag> 代码生成 </tag>
            
            <tag> 微服务 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>RESTful风格的Vue.js前端表格CRUD模板实现</title>
      <link href="/2020/05/15/restful%E9%A3%8E%E6%A0%BC%E5%89%8D%E7%AB%AF%E8%A1%A8%E6%A0%BC%E5%A2%9E%E5%88%A0%E6%94%B9%E6%9F%A5%E6%A8%A1%E6%9D%BF-restful%E9%A3%8E%E6%A0%BC%E5%89%8D%E7%AB%AF%E8%A1%A8%E6%A0%BC%E5%A2%9E%E5%88%A0%E6%94%B9%E6%9F%A5%E6%A8%A1%E6%9D%BF/"/>
      <url>/2020/05/15/restful%E9%A3%8E%E6%A0%BC%E5%89%8D%E7%AB%AF%E8%A1%A8%E6%A0%BC%E5%A2%9E%E5%88%A0%E6%94%B9%E6%9F%A5%E6%A8%A1%E6%9D%BF-restful%E9%A3%8E%E6%A0%BC%E5%89%8D%E7%AB%AF%E8%A1%A8%E6%A0%BC%E5%A2%9E%E5%88%A0%E6%94%B9%E6%9F%A5%E6%A8%A1%E6%9D%BF/</url>
      
        <content type="html"><![CDATA[<h1 id="restful-风格前端表格增删改查模板"><a href="#restful-风格前端表格增删改查模板" class="headerlink" title="restful 风格前端表格增删改查模板"></a>restful 风格前端表格增删改查模板</h1><h2 id="restful-风格前端表格增删改查模板-1"><a href="#restful-风格前端表格增删改查模板-1" class="headerlink" title="restful 风格前端表格增删改查模板"></a>restful 风格前端表格增删改查模板</h2><blockquote><p>基于 vue d2-admin element-ui 配合上篇文章 js 代码生成器,只需要简单的修改即可实现快速页面开发。</p></blockquote><h3 id="vue-模板"><a href="#vue-模板" class="headerlink" title="vue 模板"></a>vue 模板</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;d2-container&gt;</span><br><span class="line">    &lt;template slot=&quot;header&quot;&gt;</span><br><span class="line">      &lt;div class=&quot;flex justify-between align-center&quot;&gt;</span><br><span class="line">        &lt;div&gt;</span><br><span class="line">          &lt;el-input v-model=&quot;search&quot; clearable size=&quot;mini&quot; placeholder=&quot;输入名称搜索&quot;&gt;</span><br><span class="line">            &lt;el-button slot=&quot;append&quot; icon=&quot;el-icon-search&quot; @click=&quot;getData&quot;&gt;&lt;/el-button&gt;</span><br><span class="line">          &lt;/el-input&gt;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">        &lt;div&gt;</span><br><span class="line">          &lt;el-button style=&quot;margin-bottom: 5px&quot; size=&quot;mini&quot; @click=&quot;getData&quot;&gt;刷新&lt;/el-button&gt;</span><br><span class="line">          &lt;el-button style=&quot;margin-bottom: 5px&quot; size=&quot;mini&quot; @click=&quot;addDataDialog=true&quot;&gt;新增&lt;/el-button&gt;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">    &lt;/template&gt;</span><br><span class="line">    &lt;div style=&quot;margin: 15px 0&quot;&gt;</span><br><span class="line">      &lt;el-table :data=&quot;data.data&quot; style=&quot;width: 100%&quot; size=&quot;mini&quot; stripe v-loading=&quot;loading&quot; @sort-change=&quot;(&#123; column, prop, order &#125;)=&gt;&#123;pagination.order = order === &#x27;ascending&#x27; ? prop : (order === &#x27;descending&#x27; ? &#x27;-&#x27; + prop : &#x27;&#x27;);getData()&#125;&quot;&gt;</span><br><span class="line">        &lt;el-table-column prop=&quot;name&quot; label=&quot;名称&quot;&gt;&lt;/el-table-column&gt;</span><br><span class="line">        &lt;el-table-column label=&quot;创建时间&quot;&gt;</span><br><span class="line">          &lt;template slot-scope=&quot;scope&quot;&gt;</span><br><span class="line">            &#123;&#123;new Date(scope.row.createdAt)|date_format&#125;&#125;</span><br><span class="line">          &lt;/template&gt;</span><br><span class="line">        &lt;/el-table-column&gt;</span><br><span class="line">        &lt;el-table-column label=&quot;编辑&quot; width=&quot;200&quot;&gt;</span><br><span class="line">          &lt;template slot-scope=&quot;scope&quot;&gt;</span><br><span class="line">            &lt;el-button size=&quot;mini&quot; icon=&quot;el-icon-edit&quot; @click=&quot;()=&gt;&#123;editDataForm=JSON.parse(JSON.stringify(scope.row));editDataDialog=true&#125;&quot;&gt;编辑&lt;/el-button&gt;</span><br><span class="line">            &lt;el-button type=&quot;danger&quot; size=&quot;mini&quot; icon=&quot;el-icon-delete&quot; @click=&quot;removeData(scope.row)&quot;&gt;删除&lt;/el-button&gt;</span><br><span class="line">          &lt;/template&gt;</span><br><span class="line">        &lt;/el-table-column&gt;</span><br><span class="line">      &lt;/el-table&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">    &lt;el-pagination</span><br><span class="line">      style=&quot;margin: 15px 0&quot;</span><br><span class="line">      background</span><br><span class="line">      layout=&quot;-&gt;,sizes,prev, pager, next, jumper&quot;</span><br><span class="line">      :page-size=&quot;pagination.pageSize&quot;</span><br><span class="line">      :current-page=&quot;pagination.currentPage&quot;</span><br><span class="line">      :total=&quot;pagination.total&quot;</span><br><span class="line">      @size-change=&quot;(e)=&gt;&#123;pagination.pageSize=e;getData()&#125;&quot;</span><br><span class="line">      @current-change=&quot;(e)=&gt;&#123;pagination.currentPage=e;getData()&#125;&quot;</span><br><span class="line">    &gt;</span><br><span class="line">    &lt;/el-pagination&gt;</span><br><span class="line">    &lt;el-dialog</span><br><span class="line">      title=&quot;添加&quot;</span><br><span class="line">      :visible.sync=&quot;addDataDialog&quot;</span><br><span class="line">      width=&quot;50%&quot;&gt;</span><br><span class="line">      &lt;el-form ref=&quot;addDataForm&quot; :model=&quot;addDataForm&quot; :rules=&quot;addRules&quot; label-width=&quot;80px&quot; size=&quot;mini&quot;&gt;</span><br><span class="line">        &lt;el-form-item label=&quot;名称&quot; prop=&quot;name&quot;&gt;</span><br><span class="line">          &lt;el-input v-model=&quot;addDataForm.name&quot;&gt;&lt;/el-input&gt;</span><br><span class="line">        &lt;/el-form-item&gt;</span><br><span class="line">      &lt;/el-form&gt;</span><br><span class="line">      &lt;span slot=&quot;footer&quot; class=&quot;dialog-footer&quot;&gt;</span><br><span class="line">        &lt;el-button @click=&quot;addDataDialog = false&quot;&gt;取 消&lt;/el-button&gt;</span><br><span class="line">        &lt;el-button type=&quot;primary&quot; @click=&quot;addData&quot;&gt;确 定&lt;/el-button&gt;</span><br><span class="line">      &lt;/span&gt;</span><br><span class="line">    &lt;/el-dialog&gt;</span><br><span class="line">    &lt;el-dialog</span><br><span class="line">      title=&quot;编辑&quot;</span><br><span class="line">      :visible.sync=&quot;editDataDialog&quot;</span><br><span class="line">      width=&quot;50%&quot;&gt;</span><br><span class="line">      &lt;el-form ref=&quot;editDataForm&quot; :model=&quot;editDataForm&quot; :rules=&quot;editRules&quot; label-width=&quot;80px&quot; size=&quot;mini&quot;&gt;</span><br><span class="line">        &lt;el-form-item label=&quot;名称&quot; prop=&quot;name&quot;&gt;</span><br><span class="line">          &lt;el-input v-model=&quot;editDataForm.name&quot;&gt;&lt;/el-input&gt;</span><br><span class="line">        &lt;/el-form-item&gt;</span><br><span class="line">      &lt;/el-form&gt;</span><br><span class="line">      &lt;span slot=&quot;footer&quot; class=&quot;dialog-footer&quot;&gt;</span><br><span class="line">        &lt;el-button @click=&quot;editDataDialog = false&quot;&gt;取 消&lt;/el-button&gt;</span><br><span class="line">        &lt;el-button type=&quot;primary&quot; @click=&quot;editData&quot;&gt;确 定&lt;/el-button&gt;</span><br><span class="line">      &lt;/span&gt;</span><br><span class="line">    &lt;/el-dialog&gt;</span><br><span class="line">  &lt;/d2-container&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">import &#123; get_sys_user_mp as getData, post_sys_user_mp as createData, put_mp_id as updateData, delete_mp_id as removeData &#125; from &#x27;@/api/sys_user&#x27;</span><br><span class="line">export default &#123;</span><br><span class="line">  name: &#x27;demo&#x27;,</span><br><span class="line">  data () &#123;</span><br><span class="line">    return &#123;</span><br><span class="line">      search: &#x27;&#x27;,</span><br><span class="line">      loading: false,</span><br><span class="line">      pagination: &#123;</span><br><span class="line">        currentPage: 1,</span><br><span class="line">        pageSize: 10,</span><br><span class="line">        total: 0,</span><br><span class="line">        order: &#x27;&#x27;</span><br><span class="line">      &#125;,</span><br><span class="line">      data: &#123;</span><br><span class="line">        data: []</span><br><span class="line">      &#125;,</span><br><span class="line">      addDataDialog: false,</span><br><span class="line">      addDataForm: &#123;</span><br><span class="line">        name: &#x27;&#x27;</span><br><span class="line">      &#125;,</span><br><span class="line">      editDataDialog: false,</span><br><span class="line">      editDataForm: &#123;</span><br><span class="line">        name: &#x27;&#x27;</span><br><span class="line">      &#125;,</span><br><span class="line">      addRules: &#123;</span><br><span class="line">        name: [&#123; required: true, message: &#x27;请输入名称&#x27;, trigger: &#x27;blur&#x27; &#125;]</span><br><span class="line">      &#125;,</span><br><span class="line">      editRules: &#123;</span><br><span class="line">        name: [&#123; required: true, message: &#x27;请输入名称&#x27;, trigger: &#x27;blur&#x27; &#125;]</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  mounted () &#123;</span><br><span class="line">    this.getData()</span><br><span class="line">  &#125;,</span><br><span class="line">  methods: &#123;</span><br><span class="line">    getData () &#123;</span><br><span class="line">      this.loading = true</span><br><span class="line">      getData(&#123;</span><br><span class="line">        currentPage: this.pagination.currentPage,</span><br><span class="line">        pageSize: this.pagination.pageSize,</span><br><span class="line">        search: this.search,</span><br><span class="line">        order: this.pagination.order</span><br><span class="line">      &#125;).then(res =&gt; &#123;</span><br><span class="line">        if (res.errno === 0) &#123;</span><br><span class="line">          this.data = res.data</span><br><span class="line">          this.pagination.total = res.data.count</span><br><span class="line">        &#125; else &#123;</span><br><span class="line">          this.$message.warning(&#x27;获取失败&#x27;)</span><br><span class="line">        &#125;</span><br><span class="line">        this.loading = false</span><br><span class="line">      &#125;).catch((err) =&gt; &#123;</span><br><span class="line">        console.log(err)</span><br><span class="line">        this.loading = false</span><br><span class="line">      &#125;)</span><br><span class="line">    &#125;,</span><br><span class="line">    removeData (data) &#123;</span><br><span class="line">      this.$confirm(&#x27;此操作将永久删除该数据, 是否继续?&#x27;, &#x27;提示&#x27;, &#123;</span><br><span class="line">        confirmButtonText: &#x27;确定&#x27;,</span><br><span class="line">        cancelButtonText: &#x27;取消&#x27;,</span><br><span class="line">        type: &#x27;warning&#x27;</span><br><span class="line">      &#125;).then(() =&gt; &#123;</span><br><span class="line">        removeData(&#123; id: data._id &#125;).then(res =&gt; &#123;</span><br><span class="line">          if (res.errno === 0) &#123;</span><br><span class="line">            this.getData()</span><br><span class="line">          &#125; else &#123;</span><br><span class="line">            this.$message.warning(&#x27;删除失败&#x27;)</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;).catch(() =&gt; &#123;</span><br><span class="line">          this.$message.warning(&#x27;删除失败&#x27;)</span><br><span class="line">        &#125;)</span><br><span class="line">      &#125;).catch(() =&gt; &#123;</span><br><span class="line">        this.$message(&#123;</span><br><span class="line">          type: &#x27;info&#x27;,</span><br><span class="line">          message: &#x27;已取消删除&#x27;</span><br><span class="line">        &#125;)</span><br><span class="line">      &#125;)</span><br><span class="line">    &#125;,</span><br><span class="line">    addData () &#123;</span><br><span class="line">      this.$refs.addDataForm.validate((valid) =&gt; &#123;</span><br><span class="line">        if (valid) &#123;</span><br><span class="line">          createData(&#123;</span><br><span class="line">            name: this.addDataForm.name</span><br><span class="line">          &#125;).then(res =&gt; &#123;</span><br><span class="line">            if (res.errno === 0) &#123;</span><br><span class="line">              this.getData()</span><br><span class="line">              this.$message.success(&#x27;添加成功&#x27;)</span><br><span class="line">              this.addDataDialog = false</span><br><span class="line">            &#125; else &#123;</span><br><span class="line">              this.$message.warning(&#x27;添加失败&#x27;)</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;).catch(() =&gt; &#123;</span><br><span class="line">            this.$message.warning(&#x27;添加失败&#x27;)</span><br><span class="line">          &#125;)</span><br><span class="line">        &#125; else &#123;</span><br><span class="line">          this.$message.warning(&#x27;填写完整&#x27;)</span><br><span class="line">          return false</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;)</span><br><span class="line">    &#125;,</span><br><span class="line">    editData () &#123;</span><br><span class="line">      this.$refs.editDataForm.validate((valid) =&gt; &#123;</span><br><span class="line">        if (valid) &#123;</span><br><span class="line">          updateData(&#123;</span><br><span class="line">            id: this.editDataForm._id,</span><br><span class="line">            name: this.editDataForm.name</span><br><span class="line">          &#125;).then(res =&gt; &#123;</span><br><span class="line">            if (res.errno === 0) &#123;</span><br><span class="line">              this.getData()</span><br><span class="line">              this.editDataDialog = false</span><br><span class="line">              this.$message.success(&#x27;修改成功&#x27;)</span><br><span class="line">            &#125; else &#123;</span><br><span class="line">              this.$message.warning(&#x27;修改失败&#x27;)</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;).catch(() =&gt; &#123;</span><br><span class="line">            this.$message.warning(&#x27;修改失败&#x27;)</span><br><span class="line">          &#125;)</span><br><span class="line">        &#125; else &#123;</span><br><span class="line">          this.$message.warning(&#x27;填写完整&#x27;)</span><br><span class="line">          return false</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure><h3 id="获取分页数据接口参数格式"><a href="#获取分页数据接口参数格式" class="headerlink" title="获取分页数据接口参数格式"></a>获取分页数据接口参数格式</h3><ul><li><p>Query:</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span> <span class="attr">&quot;currentPage&quot;</span><span class="punctuation">:</span> <span class="number">1</span><span class="punctuation">,</span> <span class="attr">&quot;pageSize&quot;</span><span class="punctuation">:</span> <span class="number">10</span><span class="punctuation">,</span> <span class="attr">&quot;search&quot;</span><span class="punctuation">:</span> <span class="string">&quot;&quot;</span><span class="punctuation">,</span> <span class="attr">&quot;order&quot;</span><span class="punctuation">:</span> <span class="string">&quot;&quot;</span> <span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure></li><li><p>返回数据</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span> <span class="attr">&quot;errno&quot;</span><span class="punctuation">:</span> <span class="number">0</span><span class="punctuation">,</span> <span class="attr">&quot;errmsg&quot;</span><span class="punctuation">:</span> <span class="string">&quot;&quot;</span><span class="punctuation">,</span> <span class="attr">&quot;data&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span> <span class="attr">&quot;pageSize&quot;</span><span class="punctuation">:</span> <span class="number">10</span><span class="punctuation">,</span> <span class="attr">&quot;currentPage&quot;</span><span class="punctuation">:</span> <span class="number">1</span><span class="punctuation">,</span> <span class="attr">&quot;count&quot;</span><span class="punctuation">:</span> <span class="number">4</span><span class="punctuation">,</span> <span class="attr">&quot;totalPages&quot;</span><span class="punctuation">:</span> <span class="number">1</span><span class="punctuation">,</span> <span class="attr">&quot;data&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="punctuation">]</span> <span class="punctuation">&#125;</span> <span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure></li></ul>]]></content>
      
      
      <categories>
          
          <category> 前端开发 </category>
          
          <category> Vue.js </category>
          
          <category> UI组件 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Vue.js </tag>
            
            <tag> Element UI </tag>
            
            <tag> 前端 </tag>
            
            <tag> RESTful </tag>
            
            <tag> CRUD </tag>
            
            <tag> 表格组件 </tag>
            
            <tag> d2-admin </tag>
            
            <tag> 代码生成器 </tag>
            
            <tag> Frontend Development </tag>
            
            <tag> UI Components </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>使用Postman模拟QQ登录：步骤与技巧</title>
      <link href="/2019/10/16/postman%E6%A8%A1%E6%8B%9Fqq%E7%99%BB%E5%BD%95/"/>
      <url>/2019/10/16/postman%E6%A8%A1%E6%8B%9Fqq%E7%99%BB%E5%BD%95/</url>
      
        <content type="html"><![CDATA[<ol><li><p>登录 pc 端的 QQ 客户端 使用 chrome 浏览器，打开 qq 空间，使用快速登陆方式。安装 postman 扩展 获取当前电脑登录用户信息 在 Network 总找到<a href="https://localhost.ptlogin2.qq.com:4301/pt_get_uins%E5%BC%80%E5%A4%B4%E7%9A%84%E5%9C%B0%E5%9D%80%E3%80%82">https://localhost.ptlogin2.qq.com:4301/pt_get_uins开头的地址。</a><br><img src="https://cdn.jsdelivr.net/gh/houxiaozhao/imageLibrary@master/uPic/2023/06/13/aa80WA.png" alt="aa80WA"></p></li><li><p>请求本地 4301 服务，获取信息。 在 postman 中模拟这一请求<br><img src="https://cdn.jsdelivr.net/gh/houxiaozhao/imageLibrary@master/uPic/2023/06/13/R9DImx.png" alt="R9DImx"></p></li><li><p>然后会保存大概 20 个 cookies，这些 cookies 好像有用。 这一部，好像没什么用~~~</p></li><li><p>获取用户头像信息<br>network 中<a href="https://ssl.ptlogin2.qq.com/getface?%E5%BC%80%E5%A4%B4%E7%9A%84%E5%9C%B0%E5%9D%80">https://ssl.ptlogin2.qq.com/getface?开头的地址</a><br><img src="https://cdn.jsdelivr.net/gh/houxiaozhao/imageLibrary@master/uPic/2023/06/13/u5ue2k.png" alt="u5ue2k"><br><img src="https://cdn.jsdelivr.net/gh/houxiaozhao/imageLibrary@master/uPic/2023/06/13/3eQORw.png" alt="3eQORw"></p></li><li><p>获取 clientkey 在选中 network 中的 Preserve Log 清空所有请求 点击需要登录的用户头像，进行登录 |<br>找到第一个请求，或者是 pt_get_st<br> <img src="https://cdn.jsdelivr.net/gh/houxiaozhao/imageLibrary@master/uPic/2023/06/13/xOkAJP.png" alt="xOkAJP"><br>在 postman 中模拟这一请求<br> <img src="https://cdn.jsdelivr.net/gh/houxiaozhao/imageLibrary@master/uPic/2023/06/13/Yyqayv.png" alt="Yyqayv"><br>可以看的 cookies 中多了两个，其中就有 clientkey |<br><img src="https://cdn.jsdelivr.net/gh/houxiaozhao/imageLibrary@master/uPic/2023/06/13/2lqvEt.png" alt="2lqvEt"></p></li><li><p>跳转到已登陆状态 在 network 中 jump 开头的地址。<br> <img src="https://cdn.jsdelivr.net/gh/houxiaozhao/imageLibrary@master/uPic/2023/06/13/YokTM4.png" alt="YokTM4"><br>可以看的在响应头中 set 了很多的 cookie<br>在 postman 中模拟这一操作<br> <img src="https://cdn.jsdelivr.net/gh/houxiaozhao/imageLibrary@master/uPic/2023/06/13/zmJx9b.png" alt="zmJx9b"><br>返回了一个地址，并且 cookies 添加了很多个。 复制下来这个地址。在 postman 中 get 一下<br><img src="https://cdn.jsdelivr.net/gh/houxiaozhao/imageLibrary@master/uPic/2023/06/13/VfVOH5.png" alt="VfVOH5"><br>激动人心的时候来了 可以看到登录成功字样。登录成功其实就是一种状态，在浏览器中保存着 token 等信息。</p></li><li><p>最后一步，postman 中直接打开其他人空间<br><img src="https://cdn.jsdelivr.net/gh/houxiaozhao/imageLibrary@master/uPic/2023/06/13/wrI6S0.png" alt="wrI6S0"><br>这时候就已经进入到其他人的空间，可以看到空间内容。</p></li><li><p>总的来说，整个流程就是在 postman 中模拟浏览器行为。进行登录。其中还有很多重要的参数没有搞明白。</p></li></ol>]]></content>
      
      
      <categories>
          
          <category> 网络安全 </category>
          
          <category> 软件测试 </category>
          
          <category> Web开发 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> postman </tag>
            
            <tag> qq </tag>
            
            <tag> API测试 </tag>
            
            <tag> 网络协议 </tag>
            
            <tag> 安全测试 </tag>
            
            <tag> 模拟登录 </tag>
            
            <tag> network analysis </tag>
            
            <tag> cookies management </tag>
            
            <tag> HTTP requests </tag>
            
            <tag> authentication simulation </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Wugeek物联网创业之路：从技术探索到行业应用的发展历程</title>
      <link href="/2019/08/14/wugeek%E5%9B%A2%E9%98%9F%E5%88%9B%E4%B8%9A%E8%B7%AF%E5%BE%84/"/>
      <url>/2019/08/14/wugeek%E5%9B%A2%E9%98%9F%E5%88%9B%E4%B8%9A%E8%B7%AF%E5%BE%84/</url>
      
        <content type="html"><![CDATA[<h1 id="介绍"><a href="#介绍" class="headerlink" title="介绍"></a>介绍</h1><ul><li>名称：Wugeek(物集客)</li><li>地点：河北邯郸</li><li>域名：<a href="http://www.wugeek.com/">http://www.wugeek.com/</a></li><li>logo：云上的章鱼（技术寓意为云计算、物联网、大数据，章鱼保罗）<ul><li><img src="https://cdn.jsdelivr.net/gh/houxiaozhao/imageLibrary@master/uPic/2023/06/05/xFHqty.jpg" alt="img"></li></ul></li></ul><h1 id="历程（大体方向：物联网云平台）"><a href="#历程（大体方向：物联网云平台）" class="headerlink" title="历程（大体方向：物联网云平台）"></a>历程（大体方向：物联网云平台）</h1><blockquote><p>基于云计算、大数据、物联网等技术的平台及其相关软硬件产品</p></blockquote><h2 id="第一阶段：探索技术，探索方向（2016）"><a href="#第一阶段：探索技术，探索方向（2016）" class="headerlink" title="第一阶段：探索技术，探索方向（2016）"></a>第一阶段：探索技术，探索方向（2016）</h2><ul><li><p>第一次团队合影（2016-7-1）</p><ul><li><img src="https://cdn.jsdelivr.net/gh/houxiaozhao/imageLibrary@master/uPic/2023/06/05/H4i2uM.jpg" alt="img"></li></ul></li><li><p>第二次团队合影（2016-12-1）</p><ul><li><img src="https://cdn.jsdelivr.net/gh/houxiaozhao/imageLibrary@master/uPic/2023/06/05/ycwzTn.jpg" alt="img"></li></ul></li><li><p>调研过国内国外物联网平台</p><ul><li>国内<ul><li><img src="https://cdn.jsdelivr.net/gh/houxiaozhao/imageLibrary@master/uPic/2023/06/05/PRERjM.jpg" alt="img"></li></ul></li><li>国外<ul><li><img src="https://cdn.jsdelivr.net/gh/houxiaozhao/imageLibrary@master/uPic/2023/06/05/SCAXxK.jpg" alt="img"></li></ul></li></ul></li><li><p>成果</p><ul><li><p>物联网云平台架构图</p></li><li><p>智能书柜</p><p>第一个完整的由上到下跑通的项目（前端、后端、通信、树莓派、硬件） 使用讯飞语音开发套件实现语音开门。 这个书柜项目完成了技术的的集成和检验技术可行性；奠定了团队后期创业几年的技术 S4T(stack for things)；</p></li><li><p>S4T-wifi 人员轨迹分析</p><p>S4T 内部的具体应用 为了将整个 S4T 整个体系和各个模块与硬件结合验证平台功能性，决定使用 3 教现有的硬件设施 1 至 4 楼的无线 AP 设备采集的 wifi 上网信息，通过数据展示，分析并展示人员运动的轨迹信息；实现硬件采集，数据分析，后台业务逻辑控制，前端数据展示，集成各个功能模块(采集中心，管控中心呢，业务中心，认证中心，数据中心，分析重心，展示中心)</p></li></ul></li><li><p>最后结果：研发面向行业应用的基于云计算、大数据、物联网等技术的平台（简称“物联网云平台”）及其相关软硬件产品</p></li></ul><h2 id="第二阶段：深入行业（2017）以外包的名义，了解行业需求"><a href="#第二阶段：深入行业（2017）以外包的名义，了解行业需求" class="headerlink" title="第二阶段：深入行业（2017）以外包的名义，了解行业需求"></a>第二阶段：深入行业（2017）以外包的名义，了解行业需求</h2><ul><li><p>智慧安防</p><p>河北安防合作</p></li><li><p>智慧灌区（漳滏河灌区项目）</p></li><li><p>天网检控电源检测</p></li><li><p>物联网通信协议</p><ul><li><p>2G&#x2F;4G&#x2F;5G</p></li><li><p>Wifi</p></li><li><p>NFC</p></li><li><p>UWB 室内定位</p></li><li><p>蓝牙 近距离无线连接</p></li><li><p>ZigBee 低速短距离传输的无线网上协议</p></li><li><p>NB-IOT</p></li><li><p>Lora 低功耗局域网无线标准 距离远</p></li><li><p>Lora 技术数据测试与积累</p><p>为了测试 lora 通信能力，也同时将数据进行数据分析，我们对 lora 进行了近 1 个多月的通信能力测试，数据分析工作； 并能实现了 lora 远距离通信的基本功能； lora 无线传输技术在物联网传输中自主可用性较强，决定将其作为团队发展重点；</p></li></ul></li><li><p>开放实验室门禁系统（Lora 的第一次应用）</p></li><li><p>iTable(通用协同填表系统)</p><ul><li><img src="https://cdn.jsdelivr.net/gh/houxiaozhao/imageLibrary@master/uPic/2023/06/05/0wjDvz.jpg" alt="img"></li></ul></li><li><p>2017 夏</p><ul><li><img src="https://cdn.jsdelivr.net/gh/houxiaozhao/imageLibrary@master/uPic/2023/06/05/7H57MT.jpg" alt="img"></li></ul></li><li><p>2018 初 冬</p><ul><li><img src="https://cdn.jsdelivr.net/gh/houxiaozhao/imageLibrary@master/uPic/2023/06/05/26NVQU.jpg" alt="img"></li></ul></li></ul><h2 id="第三阶段：冲刺，两条腿走路（生存和发展）（2018）"><a href="#第三阶段：冲刺，两条腿走路（生存和发展）（2018）" class="headerlink" title="第三阶段：冲刺，两条腿走路（生存和发展）（2018）"></a>第三阶段：冲刺，两条腿走路（生存和发展）（2018）</h2><ul><li><p>物联网云平台（自顶向下）</p><p>继续承担团队资金来源，探索行业需求的使命</p><ul><li><p>大范围接触社会公司企业，寻找对接可行性</p><p>神龙物流、石家庄贾总、双安科技、七一八所、北京泰格瑞德等等</p></li><li><p>与七一八所签订《峰峰华明环保项目》</p><p>这也是 Lora 技术的第一次商业化应用。 无组织粉尘监控平台是一款完全私有化的工业级物联网在线环境监测解决方案，涵盖 PM2.5、PM10 等有害气体的监测。</p></li></ul></li><li><p>iTable 教育版（从下往上）</p><p>2018 年 1 月到 2018 年 7 月，用了半年的时间进行高密度，大范围的辅导机构拜访、推广、试用； 推广辅导机构 100 家以上，大中小机构全面对接； 中小学校长老师对接； 团队的所有主力全部投入精力参与产品的开发与推广工作。</p><ul><li><p>私有化部署，软件+硬件离线注入方式，解决数据安全问题</p></li><li><p>iTable 是个神奇的东西</p><p>报名流程、辅导班考勤流程、辅导班每日作业、微商城、物业通知报修、团队内部周报提交</p></li><li><p>推广失败</p><p>需求调研不足（老人小孩不会使用手机的问题） 团队和辅导机构目标不一致。我们想做平台，他们却不想共享自己的资源。导致使用积极性欠缺。</p></li></ul></li></ul><h2 id="第四阶段：放弃一切，最后一博（2019）"><a href="#第四阶段：放弃一切，最后一博（2019）" class="headerlink" title="第四阶段：放弃一切，最后一博（2019）"></a>第四阶段：放弃一切，最后一博（2019）</h2><ul><li><p>智慧社区项目</p></li><li><p>团队核心人员转移到邯郸市国际会展中心浪潮大数据中心。</p></li><li><p>开始了团队全体陌拜。（开发人员必须接触真实用户）</p><p>456 月共拜访小区、物业、业委会 69 次。基本上是上午拜访用户，中午开会总结、下午带着需求进行开发更新。</p></li><li><p>做了什么</p><ul><li><img src="https://cdn.jsdelivr.net/gh/houxiaozhao/imageLibrary@master/uPic/2023/06/05/5HwPmi.jpg" alt="img"></li><li><img src="https://cdn.jsdelivr.net/gh/houxiaozhao/imageLibrary@master/uPic/2023/06/05/3V6T3j.jpg" alt="img"></li><li><img src="https://cdn.jsdelivr.net/gh/houxiaozhao/imageLibrary@master/uPic/2023/06/05/RpNneh.jpg" alt="img"></li></ul></li></ul><h1 id="最后"><a href="#最后" class="headerlink" title="最后"></a>最后</h1><ul><li><p>三线城市创业，是不是在胡闹</p><p>做一件实事</p></li><li><p>创业成功与否取决于人的认识</p><ul><li><img src="https://cdn.jsdelivr.net/gh/houxiaozhao/imageLibrary@master/uPic/2023/06/05/aGbk5u.jpg" alt="img"></li></ul></li><li><p>团队使命</p><p>十年磨一剑，研发面向行业应用的基于云计算、大数据、物联网等技术的平台(简称“物联网云平台”)及其相关软硬件产品 怀揣梦想，创新创业，营造一块“做人做事做学问” 的试验田，经历人生 中的一次“痛”，受益一生</p></li><li><p>团队文化</p><p>营造“目标一致，分工合作，低调做事，坚持不懈”的价值观，杜绝负能 量，对于有不同意见的成员，允许其在一定时间内予以摸索，最终认可团 队价值观。每个人都要通过团队合作，分析自己的优缺点，找到自己在团 队中的定位，干好自己的工作。</p></li></ul><h1 id="创业过程遇到的一些其他问题"><a href="#创业过程遇到的一些其他问题" class="headerlink" title="创业过程遇到的一些其他问题"></a>创业过程遇到的一些其他问题</h1><ul><li><p>成员调整</p><p>成员加入退出机制。！！</p></li><li><p>公司成立</p><p>公司成立注销，股权分配、税务、发票等</p></li><li><p>技术调研报告</p><ul><li><img src="https://cdn.jsdelivr.net/gh/houxiaozhao/imageLibrary@master/uPic/2023/06/05/LcsBtB.jpg" alt="img"></li></ul><p>每隔一段时间都要组织成员同学调研新技术、分享技术报告。</p></li></ul><h1 id="用到的一些技术"><a href="#用到的一些技术" class="headerlink" title="用到的一些技术"></a>用到的一些技术</h1><ul><li><p>前端</p><p>经历了从 angular.js 到 Vuejs、ionic 到 uniapp 的转变 <a href="https://cn.vuejs.org/">https://cn.vuejs.org/</a> <a href="https://uniapp.dcloud.io/README">https://uniapp.dcloud.io/README</a></p></li><li><p>后端</p><p>node 开发框架 Thinkjs +Egg.js <a href="https://eggjs.org/zh-cn/intro/">https://eggjs.org/zh-cn/intro/</a></p></li><li><p>硬件</p><p>lora STM32 4G 各传感器</p></li></ul>]]></content>
      
      
      <categories>
          
          <category> 创业故事 </category>
          
          <category> 物联网 </category>
          
          <category> 技术创新 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 物联网平台 </tag>
            
            <tag> 云计算 </tag>
            
            <tag> 大数据 </tag>
            
            <tag> 创业历程 </tag>
            
            <tag> IoT </tag>
            
            <tag> 智能硬件 </tag>
            
            <tag> 技术创新 </tag>
            
            <tag> 行业应用 </tag>
            
            <tag> 团队建设 </tag>
            
            <tag> 商业模式 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Vue.js与Cordova构建混合应用：从环境搭建到插件集成</title>
      <link href="/2019/05/04/Hybrid%20App%20%E5%BC%80%E5%8F%91%E8%BF%87%E7%A8%8B(Vue+Android)%E5%9F%BA%E4%BA%8EJavaScript%E7%9A%84%E6%B7%B7%E5%90%88%E5%BC%8FAPP%E5%BC%80%E5%8F%91-hybridapp%E5%BC%80%E5%8F%91%E8%BF%87%E7%A8%8Bvueandroid%E5%9F%BA%E4%BA%8Ejavascript%E7%9A%84%E6%B7%B7%E5%90%88%E5%BC%8Fapp%E5%BC%80%E5%8F%91/"/>
      <url>/2019/05/04/Hybrid%20App%20%E5%BC%80%E5%8F%91%E8%BF%87%E7%A8%8B(Vue+Android)%E5%9F%BA%E4%BA%8EJavaScript%E7%9A%84%E6%B7%B7%E5%90%88%E5%BC%8FAPP%E5%BC%80%E5%8F%91-hybridapp%E5%BC%80%E5%8F%91%E8%BF%87%E7%A8%8Bvueandroid%E5%9F%BA%E4%BA%8Ejavascript%E7%9A%84%E6%B7%B7%E5%90%88%E5%BC%8Fapp%E5%BC%80%E5%8F%91/</url>
      
        <content type="html"><![CDATA[<h3 id="准备开发环境"><a href="#准备开发环境" class="headerlink" title="准备开发环境"></a>准备开发环境</h3><ul><li><p>前端开发环境</p><ul><li>Node.js LTS<ul><li>@vue&#x2F;cli</li><li>cordova</li><li>yarn 推荐</li></ul></li><li>编辑器 VS code(墙裂推荐)<ul><li>各种插件</li></ul></li></ul></li></ul><span id="more"></span><ul><li>Android 环境（需要编译 Android 软件）<ul><li>安装 JDK<ul><li>设置环境变量</li></ul></li><li>安装 SDK?Android Studio - 设置环境变量<br><a href="https://blog.csdn.net/pupilxiaoming/article/details/77801398">https://blog.csdn.net/pupilxiaoming/article/details/77801398</a></li></ul></li></ul><p>###项目搭建</p><ul><li><p>使用脚手架生成基础项目</p><ul><li>cordova 项目<ul><li>cordova create demo</li><li>cordova platform add android</li><li>cordova run android</li><li>目录结构<ul><li>www 存放网页代码</li><li>plugins 插件</li><li>platforms 平台</li><li>res 资源</li></ul></li><li>调试<br><a href="chrome://inspect/#devices">chrome://inspect/#devices</a></li></ul></li><li>vue 项目<ul><li>vue create demo</li><li>yarn</li><li>npm run serve</li><li>目录结构<ul><li>public 静态资源</li><li>src 源码</li></ul></li><li>安装一个 UI 框架 Vuetify<ul><li>yarn add vuetify</li><li>导入文件<br>import Vuetify from ‘vuetify’import ‘vuetify&#x2F;dist&#x2F;vuetify.min.css’Vue.use(Vuetify)</li><li>代码结构 app.vue<br><template> <v-app> <v-toolbar app> <v-spacer></v-spacer>这是一个 App <v-spacer></v-spacer> </v-toolbar> <v-content> <v-container fluid> <router-view></router-view> </v-container> </v-content> <v-bottom-nav app :active.sync="bottomNav" :value="true" fixed color="white"> <v-btn color="teal" flat value="recent" to="/"> <span>首页</span> <v-icon>home</v-icon> </v-btn> <v-btn color="teal" flat value="favorites" to="/about"> <span>关于</span> <v-icon>account_circle</v-icon> </v-btn> </v-bottom-nav> </v-app></template><script>export default { name: "App", data() { return { bottomNav: "recent" }; }};</script></li></ul></li></ul></li><li>把 vue 运行到 Android<ul><li>npm run build</li><li>复制文件</li><li>cordova run android</li><li>配置 vue 项目<ul><li>vue.config.js<br>module.exports &#x3D; { baseUrl: “”};</li></ul></li><li>重新 build、复制、run</li></ul></li></ul><h3 id="合并两个项目"><a href="#合并两个项目" class="headerlink" title="合并两个项目"></a>合并两个项目</h3><ul><li>复制 cordova 到 vue<ul><li>&#x2F;hooks</li><li>&#x2F;platforms</li><li>&#x2F;plugins</li><li>&#x2F;res</li><li>&#x2F;www</li><li>config.xml</li></ul></li><li>修改 package.json</li><li><h2 id="修改配置"><a href="#修改配置" class="headerlink" title="修改配置"></a>修改配置</h2></li><li>npm run build</li><li>cordova run android</li></ul></li></ul><h3 id="cordova-插件使用"><a href="#cordova-插件使用" class="headerlink" title="cordova 插件使用"></a>cordova 插件使用</h3><ul><li>引入 cordova.js<br>if (window.location.protocol &#x3D;&#x3D;&#x3D; “file:” || window.location.port &#x3D;&#x3D;&#x3D; “3000”) { var cordovaScript &#x3D; document.createElement(“script”); cordovaScript.setAttribute(“type”, “text&#x2F;javascript”); cordovaScript.setAttribute(“src”, “cordova.js”); document.body.appendChild(cordovaScript);}</li><li>安装 cordova 插件<a href="http://cordova.axuer.com/plugins/">http://cordova.axuer.com/plugins/</a><ul><li>扫描二维码 <a href="https://github.com/phonegap/phonegap-plugin-barcodescanner">https://github.com/phonegap/phonegap-plugin-barcodescanner</a><ul><li>cordova plugin add phonegap-plugin-barcodescanner</li><li>使用<br>&#x2F;_ global cordova:true _&#x2F; cordova.plugins.barcodeScanner.scan(result &#x3D;&gt; { alert(result.text); });</li></ul></li><li>读取通讯录<a href="https://github.com/apache/cordova-plugin-contacts">https://github.com/apache/cordova-plugin-contacts</a><ul><li>cordova plugin add cordova-plugin-contacts</li><li>使用<br>navigator.contacts.find( [“displayName”, “name”, “phoneNumbers”, “emails”, “address”], e &#x3D;&gt; { console.log(e); }, err &#x3D;&gt; { console.log(err); }, { filter: “”, multiple: true } );</li></ul></li></ul></li></ul><h3 id="路由整理，嵌套的路由"><a href="#路由整理，嵌套的路由" class="headerlink" title="路由整理，嵌套的路由"></a>路由整理，嵌套的路由</h3>]]></content>
      
      
      <categories>
          
          <category> 移动应用开发 </category>
          
          <category> 混合应用 </category>
          
          <category> 前端技术 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> JavaScript </tag>
            
            <tag> Vue.js </tag>
            
            <tag> Cordova </tag>
            
            <tag> Android </tag>
            
            <tag> Hybrid App </tag>
            
            <tag> 移动开发 </tag>
            
            <tag> 跨平台开发 </tag>
            
            <tag> 插件开发 </tag>
            
            <tag> 前端框架 </tag>
            
            <tag> 应用打包 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>InfluxDB实践：从MongoDB迁移到时序数据库的开发体验</title>
      <link href="/2019/03/07/%E6%97%B6%E5%BA%8F%E6%95%B0%E6%8D%AE%E5%BA%93-%E6%97%B6%E5%BA%8F%E6%95%B0%E6%8D%AE%E5%BA%93/"/>
      <url>/2019/03/07/%E6%97%B6%E5%BA%8F%E6%95%B0%E6%8D%AE%E5%BA%93-%E6%97%B6%E5%BA%8F%E6%95%B0%E6%8D%AE%E5%BA%93/</url>
      
        <content type="html"><![CDATA[<h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>我之前的节点数据是全都存到 mongoDB 中的。偶然的机会，发现了 InfluxDB 这种时序数据库。于是花了点时间简单使用一些，看看是否能替换 mongoDB 存储历史数据。</p><h1 id="InfluxDB-简介"><a href="#InfluxDB-简介" class="headerlink" title="InfluxDB 简介"></a>InfluxDB 简介</h1><p>InfluxDB 是一个开源时序数据库。适合处理分析资源数据监控相关数据。</p><p><a href="https://docs.influxdata.com/influxdb/v1.6/">https://docs.influxdata.com/influxdb/v1.6/</a></p>  <span id="more"></span><h1 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h1><p>目前最新版本为 v1.6。</p><p>安装 InfluxDB 的方式很简单(Ubuntu)</p><pre><code>$ curl -sL &lt;https://repos.influxdata.com/influxdb.key&gt; | sudo apt-key add -$ source /etc/lsb-release$ echo &quot;deb &lt;https://repos.influxdata.com/$&#123;DISTRIB_ID,,&#125;&gt; $&#123;DISTRIB_CODENAME&#125; stable&quot; | sudo tee /etc/apt/sources.list.d/influxdb.list$ sudo apt-get update &amp;&amp; sudo apt-get install influxdb$ sudo service influxdb start</code></pre><p>完成。😋</p><p>然后就可以在命令行里输入 influx 愉快的玩耍了。</p><p>使用命令行创建一些数据</p><pre><code>create database &#39;mydb&#39;use mydbinsert test,tag1=111,tag2=222 field1=111111,field2=222222</code></pre><p>然后就可以查询数据。由于是新手，当然是使用工具啦。</p><p>以前的版本自带一个 web 管理界面。现在的版本没有了~</p><p>附上可视化工具一枚<a href="https://github.com/CymaticLabs/InfluxDBStudio">https://github.com/CymaticLabs/InfluxDBStudio</a></p><p><img src="https://img-blog.csdnimg.cn/20190307145841886.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3UwMTExMTI3NzM=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br><img src="https://img-blog.csdnimg.cn/20190307145901883.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3UwMTExMTI3NzM=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><p>插入成功 😄 可以看到里面除了我们自己加的两个 tag,两个 field,还包括一个自动添加的 time。毕竟是<code>时序数据库</code>嘛！</p><p>除了使用 InfluxDBStudio 以外，还可以使用另一个工具 Grafana。<a href="https://grafana.com/">https://grafana.com</a> 感兴趣的可以自己去查查。嗯，很炫。</p><p><img src="https://img-blog.csdnimg.cn/20190307145928906.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3UwMTExMTI3NzM=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><h1 id="Nodejs-使用"><a href="#Nodejs-使用" class="headerlink" title="Nodejs 使用"></a>Nodejs 使用</h1><p>npm 包 <a href="https://www.npmjs.com/package/influx">https://www.npmjs.com/package/influx</a></p><h2 id="安装-1"><a href="#安装-1" class="headerlink" title="安装"></a>安装</h2><pre><code>npm install --save influx@next</code></pre><h2 id="第一步-插入数据"><a href="#第一步-插入数据" class="headerlink" title="第一步 插入数据"></a>第一步 插入数据</h2><pre><code>const Influx = require(&#39;influx&#39;); //导包// 定义数据库连接和数据格式，创建clientconst client = new Influx.InfluxDB(&#123;  database: &#39;mydb&#39;,  username: &#39;root&#39;,  password: &#39;root&#39;,  hosts: [&#123; host: &#39;xx.xx.xx.xxx&#39; &#125;],  schema: [    &#123;      measurement: &#39;test&#39;, //类似于数据表的概念      fields: &#123; //数据表的字段，定义类型，FLOAT/INTEGER/STRING/BOOLEAN              field1:Influx.FieldType.INTEGER,                field2:Influx.FieldType.INTEGER,      &#125;, // tag 也是里面的字段，是自带索引光环。查询速度杠杠的。      tags: [&#39;tag1&#39;,&#39;tag2&#39;]    &#125;  ]&#125;);// 插入数据client.writePoints([          &#123;            measurement: &#39;test&#39;,            fields: &#123;              field1:1231123,                            field2:44233,            &#125;,            tags: &#123;              tag1:14233,                            tag2:41122            &#125;          &#125;        ])</code></pre><h2 id="第二步-查询数据"><a href="#第二步-查询数据" class="headerlink" title="第二步 查询数据"></a>第二步 查询数据</h2><pre><code>const Influx = require(&#39;influx&#39;);// 和上边一样。const client = new Influx.InfluxDB(&#123;  database: &#39;mydb&#39;,  username: &#39;root&#39;,  password: &#39;root&#39;,  hosts: [&#123; host: &#39;xx.xx.xx.xxx&#39; &#125;],  schema: [    &#123;      measurement: &#39;test&#39;, //类似于数据表的概念      fields: &#123; //数据表的字段，定义类型，FLOAT/INTEGER/STRING/BOOLEAN              field1:Influx.FieldType.INTEGER,                field2:Influx.FieldType.INTEGER,      &#125;, // tag 也是里面的字段，是自带索引光环。查询速度杠杠的。      tags: [&#39;tag1&#39;,&#39;tag2&#39;]    &#125;  ]&#125;);// 获取5分钟内的数据// 至于Influx的查询语法，据说和mysql有点类似。还没有具体研究。现在就简单查一个吧client  .query(    `    SELECT * FROM &quot;test&quot; WHERE time &gt; now() - 5m  `  )  .then(res =&gt; &#123;    console.log(res); //输出一个数组。  &#125;);</code></pre><h1 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h1><p>到目前位置，已经基本满足项目需求。接下来就是各种花式查询而已。</p><h2 id="各种链接-🔗"><a href="#各种链接-🔗" class="headerlink" title="各种链接 🔗"></a>各种链接 🔗</h2><ul><li><a href="https://docs.influxdata.com/influxdb/v1.6/">https://docs.influxdata.com/influxdb/v1.6/</a></li><li><a href="https://github.com/CymaticLabs/InfluxDBStudio">https://github.com/CymaticLabs/InfluxDBStudio</a></li><li><a href="https://grafana.com/">https://grafana.com</a></li><li><a href="https://www.npmjs.com/package/influx">https://www.npmjs.com/package/influx</a></li></ul>]]></content>
      
      
      <categories>
          
          <category> 数据库 </category>
          
          <category> 后端开发 </category>
          
          <category> Node.js开发 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Node.js </tag>
            
            <tag> MongoDB </tag>
            
            <tag> InfluxDB </tag>
            
            <tag> 时序数据库 </tag>
            
            <tag> 数据迁移 </tag>
            
            <tag> 数据监控 </tag>
            
            <tag> Ubuntu </tag>
            
            <tag> Grafana </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Egg.js与ThinkJS框架对比：Node.js企业级开发实践分析</title>
      <link href="/2018/10/09/Egg.js%20VS%20Thinkjs%20%E7%AE%80%E5%8D%95%E5%88%86%E6%9E%90%E4%BD%BF%E7%94%A8-eggjsvsthinkjs%E7%AE%80%E5%8D%95%E5%88%86%E6%9E%90%E4%BD%BF%E7%94%A8/"/>
      <url>/2018/10/09/Egg.js%20VS%20Thinkjs%20%E7%AE%80%E5%8D%95%E5%88%86%E6%9E%90%E4%BD%BF%E7%94%A8-eggjsvsthinkjs%E7%AE%80%E5%8D%95%E5%88%86%E6%9E%90%E4%BD%BF%E7%94%A8/</url>
      
        <content type="html"><![CDATA[<p>@[toc](Egg.js VS Thinkjs 简单分析使用)</p><h2 id="命令行脚手架"><a href="#命令行脚手架" class="headerlink" title="命令行脚手架"></a>命令行脚手架</h2><h4 id="Egg-js"><a href="#Egg-js" class="headerlink" title="Egg.js"></a>Egg.js</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$ npm i egg-init -g</span><br><span class="line">$ egg-init egg-example --<span class="built_in">type</span>=simple</span><br><span class="line">$ <span class="built_in">cd</span> egg-example</span><br><span class="line">$ npm i</span><br><span class="line">$ npm run dev</span><br></pre></td></tr></table></figure><p>打开浏览器访问 <code>http://127.0.0.1:7001/</code></p>  <span id="more"></span><h4 id="Thinkjs"><a href="#Thinkjs" class="headerlink" title="Thinkjs"></a>Thinkjs</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$ npm install -g think-cli</span><br><span class="line">$ thinkjs new demo;</span><br><span class="line">$ <span class="built_in">cd</span> demo;</span><br><span class="line">$ npm install;</span><br><span class="line">$ npm start;</span><br></pre></td></tr></table></figure><p>打开浏览器访问 <code>http://127.0.0.1:8360/</code></p><p>从创建项目的脚手架来看两者基本一致，但是 think-cli 支持 使用命令行创建 controller、service、model 等</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ thinkjs controller &lt;controller-name&gt; [module-name]</span><br><span class="line">$ thinkjs service &lt;service-name&gt; [module-name]</span><br><span class="line">$ thinkjs model &lt;model-name&gt; [module-name]</span><br></pre></td></tr></table></figure><p>更多使用方法查看<a href="https://github.com/thinkjs/think-cli">https://github.com/thinkjs/think-cli</a></p><h2 id="配置"><a href="#配置" class="headerlink" title="配置"></a>配置</h2><h4 id="Egg-js-1"><a href="#Egg-js-1" class="headerlink" title="Egg.js"></a>Egg.js</h4><ul><li><p>默认配置在 config 文件夹下 config.default.js</p></li><li><p>写法</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = &#123;</span><br><span class="line">  <span class="attr">keys</span>: <span class="string">&quot;my-cookie-secret-key&quot;</span>,</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">// 或</span></span><br><span class="line"><span class="built_in">exports</span>.<span class="property">keys</span> = <span class="string">&quot;my-cookie-secret-key&quot;</span>;</span><br><span class="line"><span class="comment">// 或</span></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = <span class="function"><span class="params">appInfo</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    <span class="attr">keys</span>: <span class="string">&quot;my-cookie-secret-key&quot;</span>,</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></li><li><p>支持多环境配置</p></li><li><p>多个配置文件会覆盖合并，框架在启动时会把合并后的最终配置 dump 到 <code>run/application_config.json</code>（worker 进程）和 <code>run/agent_config.json</code>（agent 进程）</p></li></ul><h4 id="Thinkjs-1"><a href="#Thinkjs-1" class="headerlink" title="Thinkjs"></a>Thinkjs</h4><ul><li><p>根据不用功能划分不同配置文件</p><ul><li><code>config.js</code> 通用的一些配置</li><li><code>adapter.js</code> adapter 配置</li><li><code>router.js</code> 自定义路由配置</li><li><code>middleware.js</code> middlware 配置</li><li><code>validator.js</code> 数据校验配置</li><li><code>extend.js</code> extend 配置</li></ul></li><li><p>写法</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = &#123;</span><br><span class="line">  <span class="attr">keys</span>: <span class="string">&quot;my-cookie-secret-key&quot;</span>,</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">// 或</span></span><br><span class="line"><span class="built_in">exports</span>.<span class="property">keys</span> = <span class="string">&quot;my-cookie-secret-key&quot;</span>;</span><br></pre></td></tr></table></figure></li><li><p>支持多环境配置</p></li><li><p>最终配置文件会合并，合并后的配置在<code>runtime/config/[env].json</code>中</p></li><li><p>支持动态设置配置</p></li></ul><h2 id="Koa-内置对象"><a href="#Koa-内置对象" class="headerlink" title="Koa 内置对象"></a>Koa 内置对象</h2><p>Egg.js 和 Thinkjs 都用扩展 Koa 对象，app,request,response,context</p><h4 id="Egg-js-2"><a href="#Egg-js-2" class="headerlink" title="Egg.js"></a>Egg.js</h4><p>启动自定义脚本获取</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// app.js</span></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = <span class="function"><span class="params">app</span> =&gt;</span> &#123;</span><br><span class="line">  app.<span class="property">cache</span> = <span class="keyword">new</span> <span class="title class_">Cache</span>();</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>controller 中使用 <code>this.ctx.app</code> <code>this.ctx</code> <code>this.ctx.request</code> <code>this.ctx.response</code></p><h4 id="Thinkjs-2"><a href="#Thinkjs-2" class="headerlink" title="Thinkjs"></a>Thinkjs</h4><p>任何地方使用<code>think.app</code></p><p>controller 中使用 <code>this.ctx</code> <code>this.ctx.req</code> <code>this.ctx.res</code></p><h2 id="中间件"><a href="#中间件" class="headerlink" title="中间件"></a>中间件</h2><p>两者都是基于 Koa 实现的，中间件基于洋葱圈模型</p><p>两者写法一致</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// middleware/log.js</span></span><br><span class="line"><span class="keyword">const</span> defaultOptions = &#123;</span><br><span class="line">  <span class="attr">consoleExecTime</span>: <span class="literal">true</span>, <span class="comment">// 是否打印执行时间的配置</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = <span class="function">(<span class="params">options = &#123;&#125;</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// 合并传递进来的配置</span></span><br><span class="line">  options = <span class="title class_">Object</span>.<span class="title function_">assign</span>(&#123;&#125;, defaultOptions, options);</span><br><span class="line">  <span class="keyword">return</span> <span class="function">(<span class="params">ctx, next</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (!options.<span class="property">consoleExecTime</span>) &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="title function_">next</span>(); <span class="comment">// 如果不需要打印执行时间，直接调用后续执行逻辑</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">const</span> startTime = <span class="title class_">Date</span>.<span class="title function_">now</span>();</span><br><span class="line">    <span class="keyword">let</span> err = <span class="literal">null</span>;</span><br><span class="line">    <span class="comment">// 调用 next 统计后续执行逻辑的所有时间</span></span><br><span class="line">    <span class="keyword">return</span> <span class="title function_">next</span>()</span><br><span class="line">      .<span class="title function_">catch</span>(<span class="function"><span class="params">e</span> =&gt;</span> &#123;</span><br><span class="line">        err = e; <span class="comment">// 这里先将错误保存在一个错误对象上，方便统计出错情况下的执行时间</span></span><br><span class="line">      &#125;)</span><br><span class="line">      .<span class="title function_">then</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">const</span> endTime = <span class="title class_">Date</span>.<span class="title function_">now</span>();</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`request exec time: <span class="subst">$&#123;endTime - startTime&#125;</span>ms`</span>);</span><br><span class="line">        <span class="keyword">if</span> (err) <span class="keyword">return</span> <span class="title class_">Promise</span>.<span class="title function_">reject</span>(err); <span class="comment">// 如果后续执行逻辑有错误，则将错误返回</span></span><br><span class="line">      &#125;);</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h4 id="Egg-js-3"><a href="#Egg-js-3" class="headerlink" title="Egg.js"></a>Egg.js</h4><p>用法：在 config.default.js 配置</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = &#123;</span><br><span class="line">  <span class="comment">// 配置需要的中间件，数组顺序即为中间件的加载顺序</span></span><br><span class="line">  <span class="attr">middleware</span>: [<span class="string">&quot;log&quot;</span>],</span><br><span class="line">  <span class="comment">// 配置 log 中间件的配置</span></span><br><span class="line">  <span class="attr">log</span>: &#123;</span><br><span class="line">    <span class="attr">consoleExecTime</span>: <span class="literal">true</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h4 id="Thinkjs-3"><a href="#Thinkjs-3" class="headerlink" title="Thinkjs"></a>Thinkjs</h4><p>用法：在<code>src/config/middleware.js</code>文件 ，数组顺序即为中间件的加载顺序</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = [</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">handle</span>: <span class="string">&quot;log&quot;</span>, <span class="comment">// 中间件处理函数</span></span><br><span class="line">    <span class="attr">options</span>: &#123;</span><br><span class="line">      <span class="comment">// 当前中间件需要的配置</span></span><br><span class="line">      <span class="attr">consoleExecTime</span>: <span class="literal">true</span>,</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">];</span><br></pre></td></tr></table></figure><h2 id="Controller"><a href="#Controller" class="headerlink" title="Controller"></a>Controller</h2><p>写法基本类似，只不过 thinkjs 中需要额外添加一个 Action</p><h4 id="Egg-js-4"><a href="#Egg-js-4" class="headerlink" title="Egg.js"></a>Egg.js</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// base_controller.js</span></span><br><span class="line"><span class="comment">// 使用this.success()方法统一对外输出,参考thinkjs返回</span></span><br><span class="line"><span class="meta">&quot;use strict&quot;</span>;</span><br><span class="line"><span class="keyword">const</span> &#123; <span class="title class_">Controller</span> &#125; = <span class="built_in">require</span>(<span class="string">&quot;egg&quot;</span>);</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">BaseController</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Controller</span> &#123;</span><br><span class="line">  <span class="title function_">success</span>(<span class="params">data</span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">ctx</span>.<span class="property">body</span> = &#123;</span><br><span class="line">      <span class="attr">errno</span>: <span class="number">0</span>,</span><br><span class="line">      <span class="attr">errmsg</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">      data,</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="title function_">fail</span>(<span class="params">msg, no</span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">ctx</span>.<span class="property">body</span> = &#123;</span><br><span class="line">      <span class="attr">errno</span>: no || <span class="number">400</span>,</span><br><span class="line">      <span class="attr">errmsg</span>: msg || <span class="string">&quot;内部错误&quot;</span>,</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = <span class="title class_">BaseController</span>;</span><br></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// controller</span></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">Controller</span> = <span class="built_in">require</span>(<span class="string">&quot;./../../core/base.controller.js&quot;</span>);</span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = <span class="keyword">class</span> <span class="title class_">extends</span> <span class="title class_">Controller</span> &#123;</span><br><span class="line">  <span class="keyword">async</span> <span class="title function_">getUser</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">success</span>(&#123; <span class="attr">username</span>: <span class="string">&quot;hou&quot;</span> &#125;);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>controller 生效还要添加路由,比 Thinkjs 麻烦。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">module.exports = app =&gt; &#123;</span><br><span class="line">  const &#123; router, controller &#125; = app;</span><br><span class="line">  router.get(&#x27;/v1/user/getUser&#x27;, controller.v1.user.getUser);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h4 id="Thinkjs-4"><a href="#Thinkjs-4" class="headerlink" title="Thinkjs"></a>Thinkjs</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title class_">Base</span> = <span class="built_in">require</span>(<span class="string">&quot;./../base&quot;</span>);</span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = <span class="keyword">class</span> <span class="title class_">extends</span> <span class="title class_">Base</span> &#123;</span><br><span class="line">  <span class="comment">//比egg.js多了一个Action,让框架自动识别为controller.通多think-router中间件实现</span></span><br><span class="line">  <span class="keyword">async</span> <span class="title function_">getUserAction</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">success</span>(&#123; <span class="attr">username</span>: <span class="string">&quot;hou&quot;</span> &#125;);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>红红火火恍恍惚惚，让 egg.js 的 controller 集成自定义的一个基类。强行使他们写法一致！😄</p><h2 id="Router"><a href="#Router" class="headerlink" title="Router"></a>Router</h2><p>都支持 restful。</p><h4 id="Egg-js-5"><a href="#Egg-js-5" class="headerlink" title="Egg.js"></a>Egg.js</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = <span class="function"><span class="params">app</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> &#123; router, controller &#125; = app;</span><br><span class="line">  router.<span class="title function_">get</span>(<span class="string">&quot;/v1/user/getUser&quot;</span>, controller.<span class="property">v1</span>.<span class="property">user</span>.<span class="property">getUser</span>);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h4 id="Thinkjs-5"><a href="#Thinkjs-5" class="headerlink" title="Thinkjs"></a>Thinkjs</h4><p>对于 controller，不用写 router。也可以自定义，我没有用到过，就不写了。</p><h2 id="RestFul"><a href="#RestFul" class="headerlink" title="RestFul"></a>RestFul</h2><h4 id="Egg-js-6"><a href="#Egg-js-6" class="headerlink" title="Egg.js"></a>Egg.js</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// app/router.js</span></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = <span class="function"><span class="params">app</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// 注意这里是resources方法。</span></span><br><span class="line">  app.<span class="property">router</span>.<span class="title function_">resources</span>(<span class="string">&quot;topics&quot;</span>, <span class="string">&quot;/api/v2/topics&quot;</span>, app.<span class="property">controller</span>.<span class="property">topics</span>);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>映射关系</p><table><thead><tr><th>Method</th><th>Path</th><th>Route Name</th><th>Controller.Action</th></tr></thead><tbody><tr><td>GET</td><td>&#x2F;posts</td><td>posts</td><td>app.controllers.posts.index</td></tr><tr><td>GET</td><td>&#x2F;posts&#x2F;new</td><td>new_post</td><td>app.controllers.posts.new</td></tr><tr><td>GET</td><td>&#x2F;posts&#x2F;:id</td><td>post</td><td>app.controllers.posts.show</td></tr><tr><td>GET</td><td>&#x2F;posts&#x2F;:id&#x2F;edit</td><td>edit_post</td><td>app.controllers.posts.edit</td></tr><tr><td>POST</td><td>&#x2F;posts</td><td>posts</td><td>app.controllers.posts.create</td></tr><tr><td>PUT</td><td>&#x2F;posts&#x2F;:id</td><td>post</td><td>app.controllers.posts.update</td></tr><tr><td>DELETE</td><td>&#x2F;posts&#x2F;:id</td><td>post</td><td>app.controllers.posts.destroy</td></tr></tbody></table><h4 id="Thinkjs-6"><a href="#Thinkjs-6" class="headerlink" title="Thinkjs"></a>Thinkjs</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// router.js</span></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = [[<span class="string">&quot;/user/:id?&quot;</span>, <span class="string">&quot;rest&quot;</span>]];</span><br></pre></td></tr></table></figure><p>通过自定义路由，将 <code>/user/:id</code> 相关的请求指定为 REST Controller，然后就可以对其访问了。</p><ul><li><code>GET /user</code> 获取用户列表，执行 <code>getAction</code></li><li><code>GET /user/:id</code> 获取某个用户的详细信息，执行 <code>getAction</code></li><li><code>POST /user</code> 添加一个用户，执行 <code>postAction</code></li><li><code>PUT /user/:id</code> 更新一个用户，执行 <code>putAction</code></li><li><code>DELETE /user/:id</code> 删除一个用户，执行 <code>deleteAction</code></li></ul><h2 id="Service"><a href="#Service" class="headerlink" title="Service"></a>Service</h2><p>基本一样</p><h4 id="Egg-js-7"><a href="#Egg-js-7" class="headerlink" title="Egg.js"></a>Egg.js</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// service/user.js</span></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">Service</span> = <span class="built_in">require</span>(<span class="string">&quot;egg&quot;</span>).<span class="property">Service</span>;</span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = <span class="keyword">class</span> <span class="title class_">extends</span> <span class="title class_">Service</span> &#123;</span><br><span class="line">  <span class="keyword">async</span> <span class="title function_">find</span>(<span class="params">id</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> &#123; <span class="attr">username</span>: <span class="string">&quot;hou&quot;</span>, <span class="attr">id</span>: id &#125;;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// controller.js</span></span><br><span class="line"><span class="variable language_">this</span>.<span class="property">ctx</span>.<span class="property">service</span>.<span class="property">user</span>.<span class="title function_">find</span>(<span class="number">11111</span>);</span><br></pre></td></tr></table></figure><h4 id="Thinkjs-7"><a href="#Thinkjs-7" class="headerlink" title="Thinkjs"></a>Thinkjs</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// service/user.js</span></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = <span class="keyword">class</span> <span class="title class_">extends</span> think.<span class="property">Service</span> &#123;</span><br><span class="line">  <span class="title function_">find</span>(<span class="params">id</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> &#123; <span class="attr">username</span>: <span class="string">&quot;hou&quot;</span>, <span class="attr">id</span>: id &#125;;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// controller</span></span><br><span class="line">think.<span class="title function_">service</span>(<span class="string">&quot;user&quot;</span>).<span class="title function_">find</span>(<span class="number">11111</span>);</span><br></pre></td></tr></table></figure><h2 id="插件-x2F-适配器？？？？"><a href="#插件-x2F-适配器？？？？" class="headerlink" title="插件&#x2F;适配器？？？？"></a>插件&#x2F;适配器？？？？</h2><h4 id="Egg-js-插件-https-eggjs-org-zh-cn-basics-plugin-html"><a href="#Egg-js-插件-https-eggjs-org-zh-cn-basics-plugin-html" class="headerlink" title="Egg.js(插件)https://eggjs.org/zh-cn/basics/plugin.html"></a>Egg.js(插件)<a href="https://eggjs.org/zh-cn/basics/plugin.html">https://eggjs.org/zh-cn/basics/plugin.html</a></h4><p>使用 npm 安装插件</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ npm i egg-mysql --save</span><br></pre></td></tr></table></figure><p>使用</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// config/plugin.js</span></span><br><span class="line"><span class="built_in">exports</span>.<span class="property">mysql</span> = &#123;</span><br><span class="line">  <span class="attr">enable</span>: <span class="literal">true</span>,</span><br><span class="line">  <span class="attr">package</span>: <span class="string">&quot;egg-mysql&quot;</span>,</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">// config/config.default.js</span></span><br><span class="line"><span class="built_in">exports</span>.<span class="property">mysql</span> = &#123;</span><br><span class="line">  <span class="comment">// 单数据库信息配置</span></span><br><span class="line">  <span class="attr">client</span>: &#123;</span><br><span class="line">    <span class="comment">// host</span></span><br><span class="line">    <span class="attr">host</span>: <span class="string">&quot;mysql.com&quot;</span>,</span><br><span class="line">    <span class="comment">// 端口号</span></span><br><span class="line">    <span class="attr">port</span>: <span class="string">&quot;3306&quot;</span>,</span><br><span class="line">    <span class="comment">// 用户名</span></span><br><span class="line">    <span class="attr">user</span>: <span class="string">&quot;test_user&quot;</span>,</span><br><span class="line">    <span class="comment">// 密码</span></span><br><span class="line">    <span class="attr">password</span>: <span class="string">&quot;test_password&quot;</span>,</span><br><span class="line">    <span class="comment">// 数据库名</span></span><br><span class="line">    <span class="attr">database</span>: <span class="string">&quot;test&quot;</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">// 是否加载到 app 上，默认开启</span></span><br><span class="line">  <span class="attr">app</span>: <span class="literal">true</span>,</span><br><span class="line">  <span class="comment">// 是否加载到 agent 上，默认关闭</span></span><br><span class="line">  <span class="attr">agent</span>: <span class="literal">false</span>,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h4 id="Thinkjs（适配器）https-thinkjs-org-zh-cn-doc-3-0-adapter-html"><a href="#Thinkjs（适配器）https-thinkjs-org-zh-cn-doc-3-0-adapter-html" class="headerlink" title="Thinkjs（适配器）https://thinkjs.org/zh-cn/doc/3.0/adapter.html"></a>Thinkjs（适配器）<a href="https://thinkjs.org/zh-cn/doc/3.0/adapter.html">https://thinkjs.org/zh-cn/doc/3.0/adapter.html</a></h4><p>使用 npm 安装插件</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ npm i think-model-mysql --save</span><br></pre></td></tr></table></figure><p>使用</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// config/adapter.js</span></span><br><span class="line"><span class="built_in">exports</span>.<span class="property">model</span> = &#123;</span><br><span class="line">  <span class="attr">type</span>: <span class="string">&quot;mysql&quot;</span>,</span><br><span class="line">  <span class="attr">common</span>: &#123;</span><br><span class="line">    <span class="attr">logConnect</span>: isDev,</span><br><span class="line">    <span class="attr">logSql</span>: isDev,</span><br><span class="line">    <span class="attr">logger</span>: <span class="function"><span class="params">msg</span> =&gt;</span> think.<span class="property">logger</span>.<span class="title function_">info</span>(msg),</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">mysql</span>: &#123;</span><br><span class="line">    <span class="attr">handle</span>: mysql,</span><br><span class="line">    <span class="attr">database</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">    <span class="attr">prefix</span>: <span class="string">&quot;think_&quot;</span>,</span><br><span class="line">    <span class="attr">encoding</span>: <span class="string">&quot;utf8&quot;</span>,</span><br><span class="line">    <span class="attr">host</span>: <span class="string">&quot;127.0.0.1&quot;</span>,</span><br><span class="line">    <span class="attr">port</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">    <span class="attr">user</span>: <span class="string">&quot;root&quot;</span>,</span><br><span class="line">    <span class="attr">password</span>: <span class="string">&quot;root&quot;</span>,</span><br><span class="line">    <span class="attr">dateStrings</span>: <span class="literal">true</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h2 id="定时任务"><a href="#定时任务" class="headerlink" title="定时任务"></a>定时任务</h2><h4 id="Egg-js-8"><a href="#Egg-js-8" class="headerlink" title="Egg.js"></a>Egg.js</h4><p>每个文件写一个定时任务，存放在 app&#x2F;schedule</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = &#123;</span><br><span class="line">  <span class="attr">schedule</span>: &#123;</span><br><span class="line">    <span class="attr">interval</span>: <span class="string">&quot;1m&quot;</span>, <span class="comment">// 1 分钟间隔</span></span><br><span class="line">    <span class="attr">type</span>: <span class="string">&quot;all&quot;</span>, <span class="comment">// 指定所有的 worker 都需要执行</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="keyword">async</span> <span class="title function_">task</span>(<span class="params">ctx</span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;触发定时任务&quot;</span>);</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h4 id="Thinkjs-8"><a href="#Thinkjs-8" class="headerlink" title="Thinkjs"></a>Thinkjs</h4><p>所有定时任务存在一个文件中</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/config/crontab.js</span></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = [</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">interval</span>: <span class="string">&quot;10s&quot;</span>,</span><br><span class="line">    <span class="attr">type</span>: <span class="string">&quot;all&quot;</span>,</span><br><span class="line">    <span class="attr">handle</span>: <span class="function">() =&gt;</span> &#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;触发定时任务&quot;</span>);</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">];</span><br></pre></td></tr></table></figure><h2 id="多进行和进程间通信"><a href="#多进行和进程间通信" class="headerlink" title="多进行和进程间通信"></a>多进行和进程间通信</h2><ul><li><p>两者都是有一个 master 进程和若干 worker 进程。不同的是 Egg.js 多一个 agent 进程。<br>在这方面 Egg.js 比 Thinkjs 要方便许多。一些脏活累活都可以交给 agent 进程去做。比如长连接，监听消息队列等。</p></li><li><p>worker 间通信都是通过 master 进程中转</p></li></ul><h4 id="Egg-js-9"><a href="#Egg-js-9" class="headerlink" title="Egg.js"></a>Egg.js</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// agent.js 监听消息队列</span></span><br><span class="line"><span class="meta">&quot;use strict&quot;</span>;</span><br><span class="line"><span class="keyword">const</span> mqtt = <span class="built_in">require</span>(<span class="string">&quot;mqtt&quot;</span>);</span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = <span class="function"><span class="params">agent</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> client = mqtt.<span class="title function_">connect</span>(<span class="string">&quot;mqtt://test.mosquitto.org&quot;</span>);</span><br><span class="line">  client.<span class="title function_">on</span>(<span class="string">&quot;connect&quot;</span>, <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;链接成功&quot;</span>);</span><br><span class="line">    client.<span class="title function_">subscribe</span>(<span class="string">&quot;asdasdasd&quot;</span>);</span><br><span class="line">  &#125;);</span><br><span class="line">  client.<span class="title function_">on</span>(<span class="string">&quot;message&quot;</span>, <span class="keyword">function</span> (<span class="params">topic, message</span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(message.<span class="title function_">toString</span>());</span><br><span class="line">    agent.<span class="property">messenger</span>.<span class="title function_">sendToApp</span>(<span class="string">&quot;shoudaoxiaoxi&quot;</span>, message.<span class="title function_">toString</span>()); <span class="comment">// 发给所有app进程</span></span><br><span class="line">    agent.<span class="property">messenger</span>.<span class="title function_">sendRandom</span>(<span class="string">&quot;shoudaoxiaoxi&quot;</span>, message.<span class="title function_">toString</span>()); <span class="comment">// 发给随机一个app进程</span></span><br><span class="line">  &#125;);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//app.js 接收agent进程发送的消息</span></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = <span class="function"><span class="params">app</span> =&gt;</span> &#123;</span><br><span class="line">  app.<span class="property">messenger</span>.<span class="title function_">on</span>(<span class="string">&quot;shoudaoxiaoxi&quot;</span>, <span class="function"><span class="params">msg</span> =&gt;</span> &#123;</span><br><span class="line">    app.<span class="property">logger</span>.<span class="title function_">info</span>(msg);</span><br><span class="line">    <span class="comment">// 创建一个匿名上下文来访问服务</span></span><br><span class="line">    <span class="keyword">const</span> ctx = app.<span class="title function_">createAnonymousContext</span>();</span><br><span class="line">    ctx.<span class="title function_">runInBackground</span>(<span class="title function_">async</span> () =&gt; &#123;</span><br><span class="line">      <span class="keyword">await</span> ctx.<span class="property">service</span>.<span class="property">source</span>.<span class="title function_">update</span>(); <span class="comment">//直接访问service</span></span><br><span class="line">      app.<span class="property">lastUpdateBy</span> = msg;</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h4 id="Thinkjs-9"><a href="#Thinkjs-9" class="headerlink" title="Thinkjs"></a>Thinkjs</h4><p>在 Thinkjs 中监听消息队列只能在 master 中了。如果有好的办法实现上边功能，请教我。</p><h2 id="数据库模型"><a href="#数据库模型" class="headerlink" title="数据库模型"></a>数据库模型</h2><h4 id="Egg-js-10"><a href="#Egg-js-10" class="headerlink" title="Egg.js"></a>Egg.js</h4><h4 id="Thinkjs-10"><a href="#Thinkjs-10" class="headerlink" title="Thinkjs"></a>Thinkjs</h4><h2 id="TypeScript-支持"><a href="#TypeScript-支持" class="headerlink" title="TypeScript 支持"></a>TypeScript 支持</h2><h4 id="Egg-js-11"><a href="#Egg-js-11" class="headerlink" title="Egg.js"></a>Egg.js</h4><ul><li>官方支持 mysql.</li><li>支持 ORM 框架<a href="http://docs.sequelizejs.com/">sequelize</a>。还没有用到过，就不提了。</li><li>mongo<ul><li><a href="https://github.com/eggjs/egg-mongoose">https://github.com/eggjs/egg-mongoose</a></li><li><a href="https://github.com/brickyang/egg-mongo-native">https://github.com/brickyang/egg-mongo-native</a></li></ul></li></ul><h4 id="Thinkjs-11"><a href="#Thinkjs-11" class="headerlink" title="Thinkjs"></a>Thinkjs</h4><ul><li>默认支持 mysql,</li><li>官方还支持 mongo.<a href="https://github.com/thinkjs/think-mongo">https://github.com/thinkjs/think-mongo</a></li><li>ORM <a href="https://github.com/thinkjs/think-sequelize">https://github.com/thinkjs/think-sequelize</a></li></ul><h2 id="单元测试"><a href="#单元测试" class="headerlink" title="单元测试"></a>单元测试</h2><h4 id="Egg-js-12"><a href="#Egg-js-12" class="headerlink" title="Egg.js"></a>Egg.js</h4><p>完整的单元测试框架使用 Mocha</p><h4 id="Thinkjs-12"><a href="#Thinkjs-12" class="headerlink" title="Thinkjs"></a>Thinkjs</h4><p>官网上没有提到单元测试内容，但是好像也支持，脚手架生成项目有 test 文件夹，使用的框架是 ava</p><h2 id="部署"><a href="#部署" class="headerlink" title="部署"></a>部署</h2><h4 id="Egg-js-13"><a href="#Egg-js-13" class="headerlink" title="Egg.js"></a>Egg.js</h4><p>使用<code>egg-scripts</code>模块部署。脚手架自带。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">npm run start <span class="comment">## 启动</span></span><br><span class="line">npm run stop <span class="comment">## 停止</span></span><br></pre></td></tr></table></figure><p>与阿里的 alinode 快速集成。</p><h4 id="Thinkjs-13"><a href="#Thinkjs-13" class="headerlink" title="Thinkjs"></a>Thinkjs</h4><p>转译<code>npm run compile</code></p><ul><li>Docker</li><li>PM2</li><li>直接启动 production.js <code>node production.js</code></li></ul><h2 id=""><a href="#" class="headerlink" title=""></a></h2>]]></content>
      
      
      <categories>
          
          <category> Node.js开发 </category>
          
          <category> 后端框架 </category>
          
          <category> 技术选型 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Node.js </tag>
            
            <tag> Egg.js </tag>
            
            <tag> ThinkJS </tag>
            
            <tag> Koa </tag>
            
            <tag> 中间件 </tag>
            
            <tag> MVC框架 </tag>
            
            <tag> 企业级应用 </tag>
            
            <tag> 性能优化 </tag>
            
            <tag> 开发效率 </tag>
            
            <tag> 框架对比 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>mpvue微信小程序开发入门：从环境搭建到实战应用</title>
      <link href="/2018/09/22/mpvue%E5%B0%8F%E7%A8%8B%E5%BA%8F%E5%BF%AB%E9%80%9F%E4%B8%8A%E6%89%8B%E6%8C%87%E5%8D%97-mpvue%E5%B0%8F%E7%A8%8B%E5%BA%8F%E5%BF%AB%E9%80%9F%E4%B8%8A%E6%89%8B%E6%8C%87%E5%8D%97/"/>
      <url>/2018/09/22/mpvue%E5%B0%8F%E7%A8%8B%E5%BA%8F%E5%BF%AB%E9%80%9F%E4%B8%8A%E6%89%8B%E6%8C%87%E5%8D%97-mpvue%E5%B0%8F%E7%A8%8B%E5%BA%8F%E5%BF%AB%E9%80%9F%E4%B8%8A%E6%89%8B%E6%8C%87%E5%8D%97/</url>
      
        <content type="html"><![CDATA[<blockquote><p>需要了解一些原生小程序开发流程，主要是接口调用方式和目录结构。</p></blockquote><h2 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"># 全局安装 vue-cli</span><br><span class="line">$ npm install --<span class="variable language_">global</span> vue-cli</span><br><span class="line"></span><br><span class="line"># 创建一个基于 mpvue-quickstart 模板的新项目</span><br><span class="line">$ vue init mpvue/mpvue-quickstart my-project</span><br><span class="line"></span><br><span class="line"># 安装依赖</span><br><span class="line">$ cd my-project</span><br><span class="line">$ npm install</span><br><span class="line"># 启动构建</span><br><span class="line">$ npm run dev</span><br></pre></td></tr></table></figure>  <span id="more"></span><h2 id="设置底部导航栏"><a href="#设置底部导航栏" class="headerlink" title="设置底部导航栏"></a>设置底部导航栏</h2><ol><li><p>添加一个页面</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">mkdir</span> demo</span><br><span class="line"><span class="built_in">cd</span> demo</span><br><span class="line"><span class="built_in">touch</span> index.vue</span><br><span class="line"><span class="built_in">touch</span> main.js</span><br></pre></td></tr></table></figure><p><code>main.js</code></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">Vue</span> <span class="keyword">from</span> <span class="string">&quot;vue&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">App</span> <span class="keyword">from</span> <span class="string">&quot;./index&quot;</span>;</span><br><span class="line"><span class="keyword">const</span> app = <span class="keyword">new</span> <span class="title class_">Vue</span>(<span class="title class_">App</span>);</span><br><span class="line">app.$mount();</span><br></pre></td></tr></table></figure><p><code>index.vue</code></p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span>&gt;</span>index<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">name</span>: <span class="string">&quot;index&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="title function_">data</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">return</span> &#123;&#125;;</span></span><br><span class="line"><span class="language-javascript">    &#125;,</span></span><br><span class="line"><span class="language-javascript">    <span class="title function_">mounted</span>(<span class="params"></span>) &#123;&#125;,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">methods</span>: &#123;&#125;,</span></span><br><span class="line"><span class="language-javascript">  &#125;;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><p>新建页面后需要重新运行<code>npm run dev</code></p></li><li><p>准备素材，底部导航的图标（<a href="http://iconfont.cn/%EF%BC%89">http://iconfont.cn/）</a></p></li><li><p>在<code>app.json</code>设置</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;pages&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;pages/index/main&quot;</span><span class="punctuation">,</span> <span class="string">&quot;pages/logs/main&quot;</span><span class="punctuation">,</span> <span class="string">&quot;pages/counter/main&quot;</span><span class="punctuation">,</span> <span class="string">&quot;pages/demo/main&quot;</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;window&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;backgroundTextStyle&quot;</span><span class="punctuation">:</span> <span class="string">&quot;light&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;navigationBarBackgroundColor&quot;</span><span class="punctuation">:</span> <span class="string">&quot;#fff&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;navigationBarTitleText&quot;</span><span class="punctuation">:</span> <span class="string">&quot;WeChat&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;navigationBarTextStyle&quot;</span><span class="punctuation">:</span> <span class="string">&quot;black&quot;</span></span><br><span class="line">  <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;tabBar&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;debug&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;list&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">      <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;pagePath&quot;</span><span class="punctuation">:</span> <span class="string">&quot;pages/index/main&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;text&quot;</span><span class="punctuation">:</span> <span class="string">&quot;首页&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;iconPath&quot;</span><span class="punctuation">:</span> <span class="string">&quot;static/img/home.png&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;selectedIconPath&quot;</span><span class="punctuation">:</span> <span class="string">&quot;static/img/home_fill.png&quot;</span></span><br><span class="line">      <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;pagePath&quot;</span><span class="punctuation">:</span> <span class="string">&quot;pages/logs/main&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;text&quot;</span><span class="punctuation">:</span> <span class="string">&quot;动态&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;iconPath&quot;</span><span class="punctuation">:</span> <span class="string">&quot;static/img/creative.png&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;selectedIconPath&quot;</span><span class="punctuation">:</span> <span class="string">&quot;static/img/creative_fill.png&quot;</span></span><br><span class="line">      <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;pagePath&quot;</span><span class="punctuation">:</span> <span class="string">&quot;pages/counter/main&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;text&quot;</span><span class="punctuation">:</span> <span class="string">&quot;官网&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;iconPath&quot;</span><span class="punctuation">:</span> <span class="string">&quot;static/img/favor.png&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;selectedIconPath&quot;</span><span class="punctuation">:</span> <span class="string">&quot;static/img/favor_fill.png&quot;</span></span><br><span class="line">      <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;pagePath&quot;</span><span class="punctuation">:</span> <span class="string">&quot;pages/demo/main&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;text&quot;</span><span class="punctuation">:</span> <span class="string">&quot;官网&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;iconPath&quot;</span><span class="punctuation">:</span> <span class="string">&quot;static/img/shop.png&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;selectedIconPath&quot;</span><span class="punctuation">:</span> <span class="string">&quot;static/img/shop_fill.png&quot;</span></span><br><span class="line">      <span class="punctuation">&#125;</span></span><br><span class="line">    <span class="punctuation">]</span></span><br><span class="line">  <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure></li></ol><h2 id="设置全局变量getApp"><a href="#设置全局变量getApp" class="headerlink" title="设置全局变量getApp();"></a>设置全局变量<code>getApp();</code></h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">Vue</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">globalData</span> = <span class="title function_">getApp</span>();</span><br></pre></td></tr></table></figure><h2 id="引入-flyio-网络库"><a href="#引入-flyio-网络库" class="headerlink" title="引入 flyio 网络库"></a>引入 flyio 网络库</h2><ol><li><p>安装</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yarn add flyio</span><br></pre></td></tr></table></figure></li><li><p><code>main.js</code>中加入</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">var Fly=require(&quot;flyio/dist/npm/wx&quot;)</span><br><span class="line">var fly=new Fly</span><br><span class="line">Vue.prototype.$http=fly</span><br></pre></td></tr></table></figure></li><li><p>调用接口测试</p><p>如果调用的本地服务可以先设置<code>不校验合法域名。。。</code>在微信开发者工具，点击右上角详情进行设置</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">this</span>.<span class="property">$http</span></span><br><span class="line">  .<span class="title function_">get</span>(<span class="string">&quot;https://www.apiopen.top/journalismApi&quot;</span>)</span><br><span class="line">  .<span class="title function_">then</span>(<span class="function"><span class="params">res</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(res);</span><br><span class="line">  &#125;)</span><br><span class="line">  .<span class="title function_">catch</span>(<span class="function"><span class="params">err</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(err);</span><br><span class="line">  &#125;);</span><br></pre></td></tr></table></figure></li></ol><h2 id="引入-weui-css"><a href="#引入-weui-css" class="headerlink" title="引入 weui.css"></a>引入 weui.css</h2><ol><li><p>下载地址：<a href="https://github.com/KuangPF/mpvue-weui/blob/master/static/weui/weui.css">https://github.com/KuangPF/mpvue-weui/blob/master/static/weui/weui.css</a></p></li><li><pre><code class="javascript">## main.jsimport &#39;./../static/weui.css&#39;;<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">3.  用法 https://kuangpf.com/mpvue-weui</span><br><span class="line"></span><br><span class="line">## 登陆</span><br><span class="line"></span><br><span class="line">1. https://developers.weixin.qq.com/community/develop/doc/0000a26e1aca6012e896a517556c01</span><br><span class="line"></span><br><span class="line">2. 需要使用按钮主动获取用户授权</span><br><span class="line"></span><br><span class="line">   目前用户授权方式需要主动获取授权。两种方式引导用户点击授权按钮</span><br><span class="line"></span><br><span class="line">   - 进入小程序时判断是否有用户信息没有的话，不进入 tab 页，而是授权页面。写一些欢迎信息</span><br><span class="line">   - 用户进入用户个人中心。判断是否有用户信息，没有则展示授权按钮</span><br><span class="line"></span><br><span class="line">   1. 第一种方式</span><br><span class="line"></span><br><span class="line">      `app.json`中添加 pages `&quot;pages/welcome/main&quot;`</span><br><span class="line"></span><br><span class="line">      welcome 页面中</span><br><span class="line"></span><br><span class="line">      ```html</span><br><span class="line">      &lt;template&gt;</span><br><span class="line">        &lt;div&gt;</span><br><span class="line">          &lt;button open-type=&quot;getUserInfo&quot; type=&quot;primary&quot; lang=&quot;zh_CN&quot; @getuserinfo=&quot;onGotUserInfo&quot;&gt;授权&lt;/button&gt;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">      &lt;/template&gt;</span><br><span class="line">      &lt;script&gt;</span><br><span class="line">        const app = getApp();</span><br><span class="line">        export default &#123;</span><br><span class="line">          name: &quot;index&quot;,</span><br><span class="line">          data() &#123;</span><br><span class="line">            return &#123;</span><br><span class="line">              canIUse: wx.canIUse(&quot;button.open-type.getUserInfo&quot;),</span><br><span class="line">            &#125;;</span><br><span class="line">          &#125;,</span><br><span class="line">          methods() &#123;&#125;,</span><br><span class="line">          mounted() &#123;</span><br><span class="line">            wx.getUserInfo(&#123;</span><br><span class="line">              success: res =&gt; &#123;</span><br><span class="line">                console.log(&quot;获取用户信息.....&quot;, res);</span><br><span class="line">                this.globalData.userinfo = res.userInfo;</span><br><span class="line">                wx.switchTab(&#123;</span><br><span class="line">                  url: &quot;./../../pages/index/main&quot;, // 这个地方很奇怪，写 url: &#x27;pages/index/main&#x27;，会报错，不能跳到首页</span><br><span class="line">                &#125;);</span><br><span class="line">              &#125;,</span><br><span class="line">              fail: res =&gt; &#123;</span><br><span class="line">                console.log(&quot;没有获取用户信息&quot;);</span><br><span class="line">                if (this.canIUse) &#123;</span><br><span class="line">                  console.log(&quot;没有用户信息&quot;);</span><br><span class="line">                  // 由于 getUserInfo 是网络请求，可能会在 Page.onLoad 之后才返回</span><br><span class="line">                  // 所以此处加入 callback 以防止这种情况</span><br><span class="line">                  app.userInfoReadyCallback = res =&gt; &#123;</span><br><span class="line">                    console.log(&quot;回调里得到用户信息&quot;, res.userInfo);</span><br><span class="line">                    this.globalData.userinfo = res.userInfo;</span><br><span class="line">                    wx.switchTab(&#123;</span><br><span class="line">                      url: &quot;pages/index/main&quot;,</span><br><span class="line">                    &#125;);</span><br><span class="line">                  &#125;;</span><br><span class="line">                &#125; else &#123;</span><br><span class="line">                  console.log(&quot;低版本微信&quot;);</span><br><span class="line">                  // 在没有 open-type=getUserInfo 版本的兼容处理</span><br><span class="line">                  wx.getUserInfo(&#123;</span><br><span class="line">                    success: res =&gt; &#123;</span><br><span class="line">                      console.log(&quot;得到用户信息&quot;, res.userInfo);</span><br><span class="line">                      this.globalData.userinfo = res.userInfo;</span><br><span class="line">                      wx.switchTab(&#123;</span><br><span class="line">                        url: &quot;pages/index/main&quot;,</span><br><span class="line">                      &#125;);</span><br><span class="line">                    &#125;,</span><br><span class="line">                  &#125;);</span><br><span class="line">                &#125;</span><br><span class="line">              &#125;,</span><br><span class="line">            &#125;);</span><br><span class="line">          &#125;,</span><br><span class="line">          methods: &#123;</span><br><span class="line">            onGotUserInfo: function (e) &#123;</span><br><span class="line">              console.log(&quot;用户授权中得到用户信息&quot;, e.mp.detail.userInfo);</span><br><span class="line">              this.globalData.userinfo = e.mp.detail.userInfo;</span><br><span class="line">              wx.switchTab(&#123;</span><br><span class="line">                url: &quot;../../pages/index/main&quot;,</span><br><span class="line">              &#125;);</span><br><span class="line">            &#125;,</span><br><span class="line">          &#125;,</span><br><span class="line">        &#125;;</span><br><span class="line">      &lt;/script&gt;</span><br></pre></td></tr></table></figure>  ![](https://i.loli.net/2018/09/22/5ba5bca695921.png)  <figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">button</span> <span class="attr">open-type</span>=<span class="string">&quot;getUserInfo&quot;</span> <span class="attr">lang</span>=<span class="string">&quot;zh_CN&quot;</span> @<span class="attr">getuserinfo</span>=<span class="string">&quot;onGotUserInfo&quot;</span>&gt;</span>授权<span class="tag">&lt;/<span class="name">button</span>&gt;</span> 这里的原生小程序应该写bindgetuserinfo=&quot;onGotUserInfo&quot; mpvue 中使用 @getuserinfo=&quot;onGotUserInfo&quot;</span><br></pre></td></tr></table></figure></code></pre></li><li><p>第二种方式</p><p>……</p></li></ol><h2 id="自定义分享"><a href="#自定义分享" class="headerlink" title="自定义分享"></a>自定义分享</h2>   <figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">&quot;default&quot;</span> <span class="attr">open-type</span>=<span class="string">&quot;share&quot;</span>&gt;</span>自定义分享<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br></pre></td></tr></table></figure><p>   当用户点击分享按钮后，会触发<code>onShareAppMessage</code>事件。这个方法不能定义到<code>methods</code>中。需要放到外层与<code>data</code> <code>methods</code>平级</p><p>   <code>onShareAppMessage</code>返回一个对象可以自定义分享内容。具体参数<a href="https://developers.weixin.qq.com/miniprogram/dev/framework/app-service/page.htm">https://developers.weixin.qq.com/miniprogram/dev/framework/app-service/page.htm</a></p><p>   在 path 参数中可以定义查询参数如<code>/pages/index/main?id=123</code>这样，当其他用户点击分享时，可以得到该参数。</p><p>   在 vue 中可以通过<code>console.log(this.$root.$mp.appOptions.query);</code>得到传递的参数</p><h2 id="页面跳转传参"><a href="#页面跳转传参" class="headerlink" title="页面跳转传参"></a>页面跳转传参</h2>   <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">wx.<span class="title function_">navigateTo</span>(&#123;</span><br><span class="line">  <span class="attr">url</span>: <span class="string">&quot;/pages/index/index2/main?id=111&quot;</span>,</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>   通过<code>this.$root.$mp.query</code>接收参数</p><h2 id="使用-font-awesome-图标"><a href="#使用-font-awesome-图标" class="headerlink" title="使用 font-awesome 图标"></a>使用 font-awesome 图标</h2><ol><li><p>安装<code>yarn add font-awesome</code></p></li><li><p>在 main.js 中引用<code>import &#39;font-awesome/css/font-awesome.min.css&#39;;</code></p></li><li><p>修改<code>build/webpack.base.conf.js</code></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">       <span class="attr">test</span>: <span class="regexp">/\.(woff2?|eot|ttf|otf)(\?.*)?$/</span>,</span><br><span class="line">       <span class="attr">loader</span>: <span class="string">&#x27;url-loader&#x27;</span>,</span><br><span class="line">       <span class="attr">options</span>: &#123;</span><br><span class="line">         <span class="comment">// limit: 10000, //注释掉</span></span><br><span class="line">         <span class="attr">name</span>: utils.<span class="title function_">assetsPath</span>(<span class="string">&#x27;fonts/[name].[ext]&#x27;</span>)</span><br><span class="line">       &#125;</span><br><span class="line">     &#125;</span><br></pre></td></tr></table></figure></li><li><p>重新编译运行<code>npm run dev</code></p></li></ol><h2 id="源码"><a href="#源码" class="headerlink" title="源码"></a>源码</h2><p>   <a href="https://github.com/houxiaozhao/mpvue-xiaochengxu">https://github.com/houxiaozhao/mpvue-xiaochengxu</a></p>]]></content>
      
      
      <categories>
          
          <category> 前端开发 </category>
          
          <category> 小程序开发 </category>
          
          <category> Vue.js </category>
          
      </categories>
      
      
        <tags>
            
            <tag> JavaScript </tag>
            
            <tag> Vue.js </tag>
            
            <tag> 前端框架 </tag>
            
            <tag> mpvue </tag>
            
            <tag> 微信小程序 </tag>
            
            <tag> WeUI </tag>
            
            <tag> Flyio </tag>
            
            <tag> 小程序开发 </tag>
            
            <tag> 用户授权 </tag>
            
            <tag> 组件开发 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Flask与MySQL集成：构建Python Web应用数据库</title>
      <link href="/2018/08/25/python3%20flask%20%E4%BD%BF%E7%94%A8Mysql%E6%95%B0%E6%8D%AE%E5%BA%93-python3flask%E4%BD%BF%E7%94%A8mysql%E6%95%B0%E6%8D%AE%E5%BA%93/"/>
      <url>/2018/08/25/python3%20flask%20%E4%BD%BF%E7%94%A8Mysql%E6%95%B0%E6%8D%AE%E5%BA%93-python3flask%E4%BD%BF%E7%94%A8mysql%E6%95%B0%E6%8D%AE%E5%BA%93/</url>
      
        <content type="html"><![CDATA[<h1 id="python3-flask-使用-Mysql-数据库"><a href="#python3-flask-使用-Mysql-数据库" class="headerlink" title="python3 flask 使用 Mysql 数据库"></a>python3 flask 使用 Mysql 数据库</h1><ol><li><p>创建 flask 基本项目结构</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask</span><br><span class="line">app = Flask(__name__)</span><br></pre></td></tr></table></figure><span id="more"></span></li><li><p>安装<code>flask-sqlalchemy</code></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install flask-sqlalchemy</span><br></pre></td></tr></table></figure></li><li><p>导入配置</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask_sqlalchemy <span class="keyword">import</span> SQLAlchemy</span><br><span class="line"></span><br><span class="line">app.config[<span class="string">&#x27;SQLALCHEMY_DATABASE_URI&#x27;</span>] = <span class="string">&#x27;mysql+pymysql://root:root@localhost/hhh&#x27;</span></span><br><span class="line">app.config[<span class="string">&#x27;SQLALCHEMY_COMMIT_ON_TEARDOWN&#x27;</span>] = <span class="literal">True</span></span><br><span class="line">app.config[<span class="string">&#x27;SQLALCHEMY_TRACK_MODIFICATIONS&#x27;</span>] = <span class="literal">True</span></span><br><span class="line">db = SQLAlchemy(app)</span><br></pre></td></tr></table></figure><p>python3 不再支持 MySQKdb,连接 mysql 数据库需要使用 pymysql</p><p>安装 pymysql</p><p><code>pip install pymysql</code></p></li><li><p>定义表模型</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">User</span>(db.Model):</span><br><span class="line">    <span class="built_in">id</span> = db.Column(db.Integer, primary_key=<span class="literal">True</span>)</span><br><span class="line">    username = db.Column(db.String(<span class="number">64</span>), unique=<span class="literal">True</span>, nullable=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, username</span>):</span><br><span class="line">        <span class="variable language_">self</span>.username = username</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__repr__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;&lt;User &#123;&#125;&gt;&#x27;</span>.<span class="built_in">format</span>(<span class="variable language_">self</span>.username)</span><br></pre></td></tr></table></figure></li><li><p>创建表<br>在 python shell 中</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; from app import db</span><br><span class="line">&gt;&gt;&gt; db.create_all()</span><br></pre></td></tr></table></figure></li><li><p>添加数据<br>在 python shell 中</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; from app import db</span><br><span class="line">&gt;&gt;&gt; from app import User</span><br><span class="line">&gt;&gt;&gt; user=User(&#x27;hou&#x27;)</span><br><span class="line">&gt;&gt;&gt; db.session.add(user)</span><br><span class="line">&gt;&gt;&gt; db.session.commit()</span><br></pre></td></tr></table></figure></li><li><p>查询数据库</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; User.query.all()</span><br><span class="line">[&lt;User hou&gt;]</span><br><span class="line">&gt;&gt;&gt; User.query.filter_by(username=<span class="string">&#x27;hou&#x27;</span>).first()</span><br><span class="line">&lt;User hou&gt;</span><br></pre></td></tr></table></figure></li><li><p>一对多或一对一表关联</p><ul><li><p>定义 Post 表模型</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> datetime <span class="keyword">import</span> datetime</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Post</span>(db.Model):</span><br><span class="line">    <span class="built_in">id</span> = db.Column(db.Integer, primary_key=<span class="literal">True</span>)</span><br><span class="line">    body = db.Column(db.Text)</span><br><span class="line">    timestamp = db.Column(db.DateTime, index=<span class="literal">True</span>, default=datetime.utcnow)</span><br><span class="line">    <span class="comment"># 添加外键声明</span></span><br><span class="line">    user_id = db.Column(db.Integer, db.ForeignKey(<span class="string">&#x27;user.id&#x27;</span>))</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__repr__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;&lt;Post &#123;&#125;&gt;&#x27;</span>.<span class="built_in">format</span>(<span class="variable language_">self</span>.body)</span><br></pre></td></tr></table></figure></li><li><p>User 添加关系</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">User</span>(db.Model):</span><br><span class="line">    <span class="built_in">id</span> = db.Column(db.Integer, primary_key=<span class="literal">True</span>)</span><br><span class="line">    username = db.Column(db.String(<span class="number">64</span>), unique=<span class="literal">True</span>, nullable=<span class="literal">True</span>)</span><br><span class="line">    <span class="comment"># 新加的</span></span><br><span class="line">    <span class="comment"># 如果您想要一对一关系，您可以把 uselist=False 传给 relationship() 。</span></span><br><span class="line">    posts = db.relationship(<span class="string">&#x27;Post&#x27;</span>, backref=<span class="string">&#x27;user&#x27;</span>, lazy=<span class="string">&#x27;dynamic&#x27;</span>)</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, username</span>):</span><br><span class="line">        <span class="variable language_">self</span>.username = username</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__repr__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;&lt;User &#123;&#125;&gt;&#x27;</span>.<span class="built_in">format</span>(<span class="variable language_">self</span>.username)</span><br></pre></td></tr></table></figure></li><li><p>执行创建表</p></li><li><p>添加数据</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; from app import *</span><br><span class="line">&gt;&gt;&gt; user=User.query.filter_by(username=<span class="string">&#x27;hou&#x27;</span>).first()</span><br><span class="line">&gt;&gt;&gt; post1=Post(body=<span class="string">&#x27;post1post1post1post1post1post1&#x27;</span>,user=user)</span><br><span class="line">&gt;&gt;&gt; db.session.add(post1)</span><br><span class="line">&gt;&gt;&gt; db.session.commit()</span><br></pre></td></tr></table></figure></li><li><p>查询数据</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; user=User.query.filter_by(username=<span class="string">&#x27;hou&#x27;</span>).first()</span><br><span class="line">&gt;&gt;&gt; user.posts.all()</span><br><span class="line">[&lt;Post 哈哈哈哈哈&gt;, &lt;Post post1post1post1post1post1post1&gt;]</span><br><span class="line">&gt;&gt;&gt; user.posts.filter_by(<span class="built_in">id</span>=4).first()</span><br><span class="line">&lt;Post post1post1post1post1post1post1&gt;</span><br></pre></td></tr></table></figure></li></ul></li><li><p>多对多表关联</p><ul><li><p>定义 Category 表模型</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Category</span>(db.Model):</span><br><span class="line">    <span class="built_in">id</span> = db.Column(db.Integer, primary_key=<span class="literal">True</span>)</span><br><span class="line">    name = db.Column(db.String(<span class="number">50</span>))</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, name</span>):</span><br><span class="line">        <span class="variable language_">self</span>.name = name</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__repr__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;&lt;Category %r&gt;&#x27;</span> % <span class="variable language_">self</span>.name</span><br></pre></td></tr></table></figure></li><li><p>定义关联表</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">categorys = db.Table(<span class="string">&#x27;categorys&#x27;</span>,</span><br><span class="line">                     db.Column(<span class="string">&#x27;id&#x27;</span>, db.Integer, primary_key=<span class="literal">True</span>),</span><br><span class="line">                     db.Column(<span class="string">&#x27;post_id&#x27;</span>, db.Integer, db.ForeignKey(<span class="string">&#x27;post.id&#x27;</span>)),</span><br><span class="line">                     db.Column(<span class="string">&#x27;category_id&#x27;</span>, db.Integer, db.ForeignKey(<span class="string">&#x27;category.id&#x27;</span>))</span><br><span class="line">                     )</span><br></pre></td></tr></table></figure></li><li><p>Post 中添加关系</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">categorys = db.relationship(<span class="string">&#x27;Category&#x27;</span>, secondary=categorys, backref=db.backref(<span class="string">&#x27;posts&#x27;</span>, lazy=<span class="string">&#x27;dynamic&#x27;</span>))</span><br></pre></td></tr></table></figure></li><li><p>执行创建表</p></li><li><p>准备类别数据</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; from app import *</span><br><span class="line">&gt;&gt;&gt; category1=Category(name=<span class="string">&quot;前端&quot;</span>)</span><br><span class="line">&gt;&gt;&gt; category2=Category(name=<span class="string">&quot;nodejs&quot;</span>)</span><br><span class="line">&gt;&gt;&gt; category3=Category(name=<span class="string">&quot;python&quot;</span>)</span><br><span class="line">&gt;&gt;&gt; db.session.add(category1)</span><br><span class="line">&gt;&gt;&gt; db.session.add(category2)</span><br><span class="line">&gt;&gt;&gt; db.session.add(category3)</span><br><span class="line">&gt;&gt;&gt; db.session.commit()</span><br></pre></td></tr></table></figure></li><li><p>添加 post</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; from app import *</span><br><span class="line">&gt;&gt;&gt; category1=Category.query.get(1)</span><br><span class="line">&gt;&gt;&gt; category2=Category.query.get(2)</span><br><span class="line">&gt;&gt;&gt; category3=Category.query.get(3)</span><br><span class="line">&gt;&gt;&gt; user=User.query.get(1)</span><br><span class="line">&gt;&gt;&gt; post1=Post(body=<span class="string">&#x27;关联的post&#x27;</span>,user=user,categorys=[category1])</span><br><span class="line">&gt;&gt;&gt; post2=Post(body=<span class="string">&#x27;关联的post&#x27;</span>,user=user,categorys=[category1,category2,category3])</span><br><span class="line">&gt;&gt;&gt; db.session.add(post1)</span><br><span class="line">&gt;&gt;&gt; db.session.add(post2)</span><br><span class="line">&gt;&gt;&gt; db.session.commit()</span><br></pre></td></tr></table></figure></li></ul></li><li><p>修改代码结构使其更好的提供接口</p></li></ol><p><img src="http://obr4xf51d.bkt.clouddn.com/18-8-25/83459102.jpg"></p><ol start="11"><li><p>提供简单 rest 接口<code>user</code></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> jsonify, request</span><br><span class="line"><span class="keyword">from</span> app.api <span class="keyword">import</span> bp</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> app.models <span class="keyword">import</span> User</span><br><span class="line"><span class="keyword">from</span> app <span class="keyword">import</span> db</span><br><span class="line"><span class="keyword">from</span> app.error <span class="keyword">import</span> bad_request</span><br></pre></td></tr></table></figure><p>@bp.route(‘&#x2F;users’, methods&#x3D;[‘GET’])<br>def get_users():<br>limit &#x3D; min(request.args.get(‘limit’, 10, int), 100)<br>offset &#x3D; (request.args.get(‘page’, 1, int) - 1) * request.args.get(‘limit’, 10, int)<br>return jsonify([user.to_dict() for user in User.query.limit(limit).offset(offset).all()])</p><p>@bp.route(‘&#x2F;users&#x2F;<a href="int:id">int:id</a>‘, methods&#x3D;[‘GET’])<br>def get_user(id):<br>return jsonify(User.query.get_or_404(id).to_dict())</p><p>@bp.route(‘&#x2F;users’, methods&#x3D;[‘POST’])<br>def add_user():<br>data &#x3D; request.get_json() or {}<br>if ‘username’ not in data:<br>return bad_request(‘错误的参数’)<br>user &#x3D; User(username&#x3D;data[‘username’])<br>db.session.add(user)<br>db.session.commit()<br>return jsonify(user.to_dict())</p><p>@bp.route(‘&#x2F;users&#x2F;<a href="int:id">int:id</a>‘, methods&#x3D;[‘PUT’])<br>def update_user(id):<br>user &#x3D; User.query.get_or_404(id)<br>data &#x3D; request.get_json() or {}<br>if ‘username’ not in data:<br>return bad_request(‘错误的参数’)<br>setattr(user, ‘username’, data[‘username’])<br>db.session.commit()<br>return jsonify(user.to_dict())</p><p>@bp.route(‘&#x2F;users&#x2F;<a href="int:id">int:id</a>‘, methods&#x3D;[‘DELETE’])<br>def delete_user(id):<br>user &#x3D; User.query.get_or_404(id)<br>db.session.delete(user)<br>db.session.commit()<br>return jsonify({‘message’: ‘ok’})</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure></li><li><p>源代码地址 <a href="https://github.com/houxiaozhao/python3-flask-mysql">https://github.com/houxiaozhao/python3-flask-mysql</a></p></li></ol>]]></content>
      
      
      <categories>
          
          <category> Python开发 </category>
          
          <category> Web后端 </category>
          
          <category> 数据库 </category>
          
          <category> API开发 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 后端开发 </tag>
            
            <tag> Web开发 </tag>
            
            <tag> Flask </tag>
            
            <tag> MySQL </tag>
            
            <tag> SQLAlchemy </tag>
            
            <tag> Python </tag>
            
            <tag> ORM </tag>
            
            <tag> RESTful API </tag>
            
            <tag> 数据库设计 </tag>
            
            <tag> 数据模型 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>vue-cli3使用和Cordova集成记录</title>
      <link href="/2018/08/11/vue-cli3%E4%BD%BF%E7%94%A8%E5%92%8CCordova%E9%9B%86%E6%88%90%E8%AE%B0%E5%BD%95-vue-cli3%E4%BD%BF%E7%94%A8%E5%92%8Ccordova%E9%9B%86%E6%88%90%E8%AE%B0%E5%BD%95/"/>
      <url>/2018/08/11/vue-cli3%E4%BD%BF%E7%94%A8%E5%92%8CCordova%E9%9B%86%E6%88%90%E8%AE%B0%E5%BD%95-vue-cli3%E4%BD%BF%E7%94%A8%E5%92%8Ccordova%E9%9B%86%E6%88%90%E8%AE%B0%E5%BD%95/</url>
      
        <content type="html"><![CDATA[<h3 id="1-安装"><a href="#1-安装" class="headerlink" title="1. 安装"></a>1. 安装</h3><p>安装过程很简单</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">npm install -g @vue/cli</span><br><span class="line"><span class="comment"># OR</span></span><br><span class="line">yarn global add @vue/cli</span><br></pre></td></tr></table></figure>  <span id="more"></span><p>安装后使用<code>vue --version</code>查看是否安装成功</p><h3 id="2-创建项目"><a href="#2-创建项目" class="headerlink" title="2. 创建项目"></a>2. 创建项目</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">vue create demo</span><br><span class="line"><span class="comment"># OR</span></span><br><span class="line">vue ui <span class="comment">#使用ui界面进行创建</span></span><br></pre></td></tr></table></figure><p>选项</p><ul><li>默认</li><li>手动选择</li></ul><p>我们选择手动选择功能，具体选择如下</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">? Please pick a preset: Manually <span class="keyword">select</span> features</span><br><span class="line">? Check the features needed <span class="keyword">for</span> your project: Babel, Router, Vuex, CSS Pre-processors, Linter</span><br><span class="line">? Pick a CSS pre-processor (PostCSS, Autoprefixer and CSS Modules are supported by default): LESS</span><br><span class="line">? Pick a linter / formatter config: Prettier</span><br><span class="line">? Pick additional lint features: Lint on save</span><br><span class="line">? Where <span class="keyword">do</span> you prefer placing config <span class="keyword">for</span> Babel, PostCSS, ESLint, etc.? In dedicated config files</span><br><span class="line">? Save this as a preset <span class="keyword">for</span> future projects? No</span><br></pre></td></tr></table></figure><p>选择完成后自动安装依赖，据观察如果本地安装了 yarn 的话，会使用 yarn 安装依赖。</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> demo</span><br><span class="line">yarn serve</span><br></pre></td></tr></table></figure><h3 id="3-项目结构和配置"><a href="#3-项目结构和配置" class="headerlink" title="3. 项目结构和配置"></a>3. 项目结构和配置</h3><p>vue-cli 3 生成的项目结构比 2 的要简单很多，去掉了 build、config、等文件夹</p><p>根目录两个文件夹</p><ul><li>src 源代码放在这里</li><li>public 原先的 index.html 放在这个文件夹</li></ul><p>除了两个文件夹还包括几个文件</p><ul><li>.eslintrc.js eslint 配置文件</li><li>.gitignore git 的文件，用来配置忽略文件和文件夹的</li><li>.postcssrc.js 我也不懂。。。</li><li>babel.config.js 配置 babel 转译用的，保持不变即可</li></ul><p>还有一个可选的配置文件 vue.config.js 默认是没有这个文件的，需要自己创建。</p><p>自用的几个配置项</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = &#123;</span><br><span class="line">  <span class="attr">baseUrl</span>: <span class="string">&#x27;&#x27;</span>, <span class="comment">//用户部署的基本url,如果不配置默认为部署所在域的根目录，如果不要部署到子路径，则需要配置该项。如果设为空，转移后的使用相对路径引用文件。并且将所有的css js都放到了根目录</span></span><br><span class="line">  <span class="attr">outputDir</span>: <span class="string">&#x27;www&#x27;</span>, <span class="comment">//输出文件夹，我这里设为www,主要是和Cordova配合生成安卓应用的。</span></span><br><span class="line">  productionSourceMap： <span class="literal">false</span>, <span class="comment">//不生成map</span></span><br><span class="line">  <span class="attr">runtimeCompiler</span>: <span class="literal">true</span> <span class="comment">// 包含运行时编译器的 Vue 构建版本</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="4-安卓打包"><a href="#4-安卓打包" class="headerlink" title="4.安卓打包"></a>4.安卓打包</h3><p>首先构造 Cordova 项目结构</p><ul><li><p>第一个就是静态文件存放目录，www 文件夹，这就是配置<code>outputDir</code>的原因</p></li><li><p>另外 Cordova 还需要 res 文件夹，存放 icon，screen 等。我是直接从 Cordova 生成项目中复制出来的。</p><p><img src="http://obr4xf51d.bkt.clouddn.com/18-8-11/92004247.jpg"></p></li><li><p>最重要的是 config.xml 文件(也是复制过来的?)</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&#x27;1.0&#x27; encoding=&#x27;utf-8&#x27;?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">widget</span> <span class="attr">id</span>=<span class="string">&quot;com.wugeek.zbyx&quot;</span> <span class="attr">version</span>=<span class="string">&quot;1.0.0&quot;</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.w3.org/ns/widgets&quot;</span> <span class="attr">xmlns:cdv</span>=<span class="string">&quot;http://cordova.apache.org/ns/1.0&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>众邦优选<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">description</span>&gt;</span></span><br><span class="line">        A sample Apache Cordova application that responds to the deviceready event.</span><br><span class="line">    <span class="tag">&lt;/<span class="name">description</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">author</span> <span class="attr">email</span>=<span class="string">&quot;dev@cordova.apache.org&quot;</span> <span class="attr">href</span>=<span class="string">&quot;http://cordova.io&quot;</span>&gt;</span></span><br><span class="line">        Apache Cordova Team</span><br><span class="line">    <span class="tag">&lt;/<span class="name">author</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">content</span> <span class="attr">src</span>=<span class="string">&quot;index.html&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">plugin</span> <span class="attr">name</span>=<span class="string">&quot;cordova-plugin-whitelist&quot;</span> <span class="attr">spec</span>=<span class="string">&quot;1&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">access</span> <span class="attr">origin</span>=<span class="string">&quot;*&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">allow-intent</span> <span class="attr">href</span>=<span class="string">&quot;http://*/*&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">allow-intent</span> <span class="attr">href</span>=<span class="string">&quot;https://*/*&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">allow-intent</span> <span class="attr">href</span>=<span class="string">&quot;tel:*&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">allow-intent</span> <span class="attr">href</span>=<span class="string">&quot;sms:*&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">allow-intent</span> <span class="attr">href</span>=<span class="string">&quot;mailto:*&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">allow-intent</span> <span class="attr">href</span>=<span class="string">&quot;geo:*&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">platform</span> <span class="attr">name</span>=<span class="string">&quot;android&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">allow-intent</span> <span class="attr">href</span>=<span class="string">&quot;market:*&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">icon</span> <span class="attr">density</span>=<span class="string">&quot;ldpi&quot;</span> <span class="attr">src</span>=<span class="string">&quot;res/icon/android/mipmap-ldpi/ic_launcher.png&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">icon</span> <span class="attr">density</span>=<span class="string">&quot;mdpi&quot;</span> <span class="attr">src</span>=<span class="string">&quot;res/icon/android/mipmap-mdpi/ic_launcher.png&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">icon</span> <span class="attr">density</span>=<span class="string">&quot;hdpi&quot;</span> <span class="attr">src</span>=<span class="string">&quot;res/icon/android/mipmap-hdpi/ic_launcher.png&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">icon</span> <span class="attr">density</span>=<span class="string">&quot;xhdpi&quot;</span> <span class="attr">src</span>=<span class="string">&quot;res/icon/android/mipmap-xhdpi/ic_launcher.png&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">icon</span> <span class="attr">density</span>=<span class="string">&quot;xxhdpi&quot;</span> <span class="attr">src</span>=<span class="string">&quot;res/icon/android/mipmap-xxhdpi/ic_launcher.png&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">platform</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">platform</span> <span class="attr">name</span>=<span class="string">&quot;ios&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">allow-intent</span> <span class="attr">href</span>=<span class="string">&quot;itms:*&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">allow-intent</span> <span class="attr">href</span>=<span class="string">&quot;itms-apps:*&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">platform</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">engine</span> <span class="attr">name</span>=<span class="string">&quot;android&quot;</span> <span class="attr">spec</span>=<span class="string">&quot;^7.0.0&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">widget</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure></li><li><p>plugins 和 platforms 文件夹不用手动建。会自动生成</p></li></ul><p>然后添加安卓平台<code>cordova platforms add android</code></p><p>最后编译运行<code>cordova run android</code></p><p>值得注意的是，这个时候 cordova 插件是有问题的，因为没有引用 Cordova.js 文件</p><p>所有在<code>mian.js</code>中判断当前平台添加<code>cordova.js</code></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (<span class="variable language_">window</span>.<span class="property">location</span>.<span class="property">protocol</span> === <span class="string">&quot;file:&quot;</span> || <span class="variable language_">window</span>.<span class="property">location</span>.<span class="property">port</span> === <span class="string">&quot;3000&quot;</span>) &#123;</span><br><span class="line">  <span class="keyword">var</span> cordovaScript = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&quot;script&quot;</span>);</span><br><span class="line">  cordovaScript.<span class="title function_">setAttribute</span>(<span class="string">&quot;type&quot;</span>, <span class="string">&quot;text/javascript&quot;</span>);</span><br><span class="line">  cordovaScript.<span class="title function_">setAttribute</span>(<span class="string">&quot;src&quot;</span>, <span class="string">&quot;cordova.js&quot;</span>);</span><br><span class="line">  <span class="variable language_">document</span>.<span class="property">body</span>.<span class="title function_">appendChild</span>(cordovaScript);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>安装<code>vue-cordova</code>这个插件，可以更方便访问 Cordova 的方法和属性</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">Vue</span>.<span class="property">cordova</span>.<span class="title function_">on</span>(<span class="string">&quot;deviceready&quot;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;Cordova : device is ready !&quot;</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>PS :写的时候参考了 cli&#x2F;vue3 的官网，发现已经有了中文翻译了?。就在半个月前还没有，抠配置配了好长时间。各位还是去官网看教程吧，写的很详细。<a href="https://cli.vuejs.org/zh/">cli vue3 地址点此</a></p><h2 id="Cordova-项目打包"><a href="#Cordova-项目打包" class="headerlink" title="Cordova 项目打包"></a>Cordova 项目打包</h2><p>生成 release 版本项目<br><code>cordova build android --release</code><br>生成签名文件（有的话就不需要了）<br><code>keytool -genkey -v -keystore my.keystore -alias demo -keyalg RSA -keysize 2048 -validity 10000</code><br>签名<br><code>jarsigner -verbose -sigalg SHA1withRSA -digestalg SHA1 -keystore my.keystore app-release-unsigned.apk demo</code></p><p>写一个 build.js 再根目录自动完成,先把 keystore 文件放到根目录</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;android&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;release&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">      <span class="attr">&quot;keystore&quot;</span><span class="punctuation">:</span> <span class="string">&quot;my.keystore&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;alias&quot;</span><span class="punctuation">:</span> <span class="string">&quot;demo&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;storePassword&quot;</span><span class="punctuation">:</span> <span class="string">&quot;password&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;password&quot;</span><span class="punctuation">:</span> <span class="string">&quot;password&quot;</span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line">  <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 前端开发 </category>
          
          <category> 混合应用开发 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Vue.js </tag>
            
            <tag> Cordova </tag>
            
            <tag> 跨平台开发 </tag>
            
            <tag> Android开发 </tag>
            
            <tag> 混合开发 </tag>
            
            <tag> Vue CLI </tag>
            
            <tag> 移动应用 </tag>
            
            <tag> 前端工程化 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Node.js与ThinkJS框架开发指南：构建高效Web应用</title>
      <link href="/2018/04/04/nodejs%E5%92%8CThinkjs-nodejs%E5%92%8Cthinkjs/"/>
      <url>/2018/04/04/nodejs%E5%92%8CThinkjs-nodejs%E5%92%8Cthinkjs/</url>
      
        <content type="html"><![CDATA[<h1 id="Node-js"><a href="#Node-js" class="headerlink" title="Node.js"></a>Node.js</h1><h4 id="Node-js-简述"><a href="#Node-js-简述" class="headerlink" title="Node.js 简述"></a>Node.js 简述</h4><p><strong>Node.js</strong>：简单的说 Node.js 就是运行在服务端的 JavaScript。</p><p><a href="https:://github.com/younghz/Markdown" title="Markdown">Node.js 安装配置</a> （介绍在 window 和 Linux 上的安装 Node.js 的方法）</p><p><a href="http://nodejs.cn/" title="Markdown">Node.js 官方文档</a></p>  <span id="more"></span><p>官方文档介绍：</p><ul><li><p>Node.js 是一个基于 Chrome V8 引擎的 JavaScript 运行环境。</p></li><li><p>Node.js 使用了一个<strong>事件驱动、非阻塞式 I&#x2F;O 的模型</strong>，使其轻量又高效。<a href="https://blog.csdn.net/m0_37886429/article/details/78292300" title="Markdown">事件驱动与异步 IO 的讲解</a></p></li><li><p>Node.js 的<strong>包管理器 npm</strong>，是全球最大的开源库生态系统。</p><p>​</p></li></ul><p><strong>认识包管理器 npm</strong>（npm 已经在安装 Node.js 的时候安装好了）</p><p>当我们在 Node.js 上开发时，会用到很多别人写的 JavaScript 代码。如果我们需要使用别人写的某个包，每次都根据名称搜索一下官方文档，下载代码，解压，再使用，非常繁琐。于是一个集中管理的工具应运而生：大家都把自己开发的模块打包后放到<a href="https://www.npmjs.com/browse/depended" title="Markdown">npm</a>官网上，如果要使用，直接通过 npm 安装就可以直接使用，不管代码存在哪，应该从哪下载。</p><p>更重要的是，如果我们要使用模块 A，而模块 A 又依赖于模块 B，模块 B 又依赖于其他的模块，那么 npm 可以根据依赖关系，把所有依赖的包都下载下来并管理起来。否则，靠我们自己手动管理，肯定是麻烦又容易出错。</p><h4 id="第一个-Node-程序"><a href="#第一个-Node-程序" class="headerlink" title="第一个 Node 程序"></a>第一个 Node 程序</h4><p>了解 Node.js 应用的几个组成部分：</p><ol><li><strong>引入 required 模块</strong> ：我们可以使用 require 指令来载入 Node.js 模块。</li><li><strong>创建服务器</strong> ：服务器可以监听客户端的请求，类似于 Apache，Nginx 等服务器。</li><li><strong>接收请求和响应请求</strong> ：服务器很容易创建，客户端可以使用浏览器或终端发送 http 请求，服务器接收请求后返回相应数据。</li></ol><p>创建 Node.js 应用：</p><p>步骤一：引入 required 模块</p><p>使用 require 指令载入 http 模块，并将实例化的 HTTP 赋值给变量 http，实例如下：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">var http = require(&#x27;http&#x27;);</span><br></pre></td></tr></table></figure><p>步骤二：创建服务器</p><p>接下来我们使用 <code>http.createServer()</code> 方法创建服务器，并使用<code>listen</code>方法绑定 8888 端口。函数通过<code>request</code>，<code>response</code>参数来接收和响应数据。实例如下：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">var http = require(&#x27;http&#x27;);  //请求Node.js自带的http模块，并且把它赋值给http变量</span><br><span class="line">http.createServer(function (request, response) &#123;  //调用http模块提供的模块</span><br><span class="line">    // 发送 HTTP 头部</span><br><span class="line">    // HTTP 状态值: 200 : OK</span><br><span class="line">    // 内容类型: text/plain</span><br><span class="line">    response.writeHead(200, &#123;&#x27;Content-Type&#x27;: &#x27;text/plain&#x27;&#125;);</span><br><span class="line"></span><br><span class="line">    // 发送响应数据 &quot;Hello World&quot;</span><br><span class="line">    response.end(&#x27;Hello World\n&#x27;);</span><br><span class="line">&#125;).listen(8888);</span><br><span class="line"></span><br><span class="line">// 终端打印如下信息</span><br><span class="line">console.log(&#x27;Server running at http://127.0.0.1:8888/&#x27;);</span><br></pre></td></tr></table></figure><h1 id="Node-js-后端框架"><a href="#Node-js-后端框架" class="headerlink" title="Node.js 后端框架"></a>Node.js 后端框架</h1><p><strong>Express 和 Koa（典型框架）</strong></p><p>Express：轻量灵活的的 node.js 框架，可以快速的搭建应用，使用广泛。<a href="http://expressjs.jser.us/" title="Markdown">Express 官方文档</a></p><p>Koa：由 Express 原版人马打造，致力于成为 web 应用和 API 开发领域中的一个更小、更富有表现力、更健壮的基石。通过利用 async 函数，koa 帮你丢弃回调函数，并有力的增强错误处理。<a href="https://koa.bootcss.com/" title="Markdown">koa 官方文档</a></p><p>Express 和 Koa 是 node.js 最基础的两个后端框架。因为构建一个 app 仍需要些很多脚手架代码，于是在他们基础上出现了很多其他框架来减少编写这类代码。（例如：ThinkJS，egg.js 等）</p><h1 id="ThinkJS"><a href="#ThinkJS" class="headerlink" title="ThinkJS"></a>ThinkJS</h1><p>介绍：ThinkJS 是一款面向未来开发的 Node.js 框架，整合了大量的项目最佳实践，让企业级开发变得简单、高效。从 3.0 开始，框架底层基于 Koa2.x 实现，兼容 Koa 的所有功能。</p><p>特性：</p><ul><li>基于 Koa2.x，兼容<code>middleware</code></li><li>内核小巧，支持<code>Extend</code>、<code>Adapter</code>等插件方式</li><li>性能优异，单元测试覆盖程度高</li><li>内置自动编译、自动更新机制、方便快速开发</li><li>使用更优雅的<code>async/await</code>处理异步问题、不再支持<code>*/yield</code>方式</li></ul><h4 id="快速入门"><a href="#快速入门" class="headerlink" title="快速入门"></a>快速入门</h4><p>借助 ThinkJS 提供的脚手架，可以快速的创建一个项目。为了可以使用更多的 ES6 特性，框架要求 node.js 的版本至少是 6.x，建议使用 LTS 版本。</p><h4 id="安装-ThinkJS-命令"><a href="#安装-ThinkJS-命令" class="headerlink" title="安装 ThinkJS 命令"></a>安装 ThinkJS 命令</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install -g think-cli</span><br></pre></td></tr></table></figure><p>安装完成后，系统中会有 thinkjs 命令（可以通过<code>thinkjs-v</code>查看 think-cli 版本号）</p><h4 id="创建项目"><a href="#创建项目" class="headerlink" title="创建项目"></a>创建项目</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">thinkjs new demo  //创建名为demo的项目</span><br><span class="line">npm install   //安装依赖</span><br><span class="line">npm start  //运行项目</span><br></pre></td></tr></table></figure><h4 id="项目结构"><a href="#项目结构" class="headerlink" title="项目结构"></a>项目结构</h4><p>默认创建的项目结构如下：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">|--- development.js   //开发环境下的入口文件</span><br><span class="line">|--- nginx.conf  //nginx 配置文件</span><br><span class="line">|--- package.json</span><br><span class="line">|--- pm2.json //pm2 配置文件</span><br><span class="line">|--- production.js //生产环境下的入口文件</span><br><span class="line">|--- README.md</span><br><span class="line">|--- src</span><br><span class="line">| |--- bootstrap  //启动自动执行目录</span><br><span class="line">| | |--- master.js //Master 进程下自动执行</span><br><span class="line">| | |--- worker.js //Worker 进程下自动执行</span><br><span class="line">| |--- config  //配置文件目录</span><br><span class="line">| | |--- adapter.js  // adapter 配置文件</span><br><span class="line">| | |--- config.js  // 默认配置文件</span><br><span class="line">| | |--- config.production.js  //生产环境下的默认配置文件，和 config.js 合并</span><br><span class="line">| | |--- extend.js  //extend 配置文件</span><br><span class="line">| | |--- middleware.js //middleware 配置文件</span><br><span class="line">| | |--- router.js //自定义路由配置文件</span><br><span class="line">| |--- controller  //控制器目录</span><br><span class="line">| | |--- base.js</span><br><span class="line">| | |--- index.js</span><br><span class="line">| |--- logic //logic 目录</span><br><span class="line">| | |--- index.js</span><br><span class="line">| |--- model //模型目录</span><br><span class="line">| | |--- index.js</span><br><span class="line">|--- view  //模板目录</span><br><span class="line">| |--- index_index.html</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><h4 id="基础功能"><a href="#基础功能" class="headerlink" title="基础功能"></a>基础功能</h4><h5 id="Config（配置）"><a href="#Config（配置）" class="headerlink" title="Config（配置）"></a>Config（配置）</h5><p>实际项目中，肯定需要各种配置，包括：框架需要的配置以及项目自定义的配置。ThinkJS 将所有的配置都统一管理，文件都放在<code>src/config/</code>目录下，并根据不同的功能划分为不同的配置文件。</p><ul><li><code>config.js</code> 通用的一些配置</li><li><code>adapter.js</code> adapter 配置 （数据库的配置）</li><li><code>router.js</code>自定义路由配置</li><li><code>middleware.js</code> middleware 配置</li><li><code>validator.js</code> 数据校验配置</li><li><code>extend.js</code> extend 配置</li></ul><p><strong>配置格式</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">// src/config.js</span><br><span class="line"></span><br><span class="line">module.exports = &#123;</span><br><span class="line">  port: 1234,</span><br><span class="line">  redis: &#123;</span><br><span class="line">    host: &#x27;192.168.1.2&#x27;,</span><br><span class="line">    port: 2456,</span><br><span class="line">    password: &#x27;&#x27;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>配置值即可以是一个简单的字符串，也可以是一个复杂的对象，具体是什么类型根据具体的需求来决定。</p><p><strong>使用配置</strong></p><p>框架提供了在不同环境下不同的方式快速获取配置：</p><ul><li>在 ctx（上下文）中，可以通过<code>ctx.config(key)</code>来获取配置</li><li>在 controller 中，可以通过<code>controller.config(key)</code>来获取配置</li><li>其他情况下，可以通过<code>think.config(key)</code>来获取配置</li></ul><p>实际上，<code>ctx.config</code>和<code>controller.config</code>是基于<code>think.config</code>包装的一种更方便的获取配置的方式。</p><h5 id="Adapter（适配器）"><a href="#Adapter（适配器）" class="headerlink" title="Adapter（适配器）"></a>Adapter（适配器）</h5><p>Adapter 是用来解决一类功能的多种实现，这些实现提供一套相同的接口，类似设计模式里的工厂模式。如：<strong>支持多种数据库</strong>，支持多种模板引擎等。通过这种方式，可以很方便地在不同的类型中进行切换。Adapter 一般配合 Extend 一起使用。</p><p>框架默认提供了很多 Adapter，如：View、Model、Cache、Session、Websocket，项目中也可以根据需要进行扩展，也可以引入第三方的 Adapter。</p><p><strong>Adapter 配置</strong></p><p>Adapter 的配置文件为<code>src/config/adapter.js</code>，格式如下：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">const nunjucks = require(&#x27;think-view-nunjucks&#x27;);</span><br><span class="line">const ejs = require(&#x27;think-view-ejs&#x27;);</span><br><span class="line">const path = require(&#x27;path&#x27;);</span><br><span class="line"></span><br><span class="line">exports.view = &#123;</span><br><span class="line">  type: &#x27;nunjucks&#x27;, // 默认的模板引擎为 nunjucks</span><br><span class="line">  common: &#123; //通用配置</span><br><span class="line">    viewPath: path.join(think.ROOT_PATH, &#x27;view&#x27;),</span><br><span class="line">    sep: &#x27;_&#x27;,</span><br><span class="line">    extname: &#x27;.html&#x27;</span><br><span class="line">  &#125;,</span><br><span class="line">  nunjucks: &#123; // nunjucks 的具体配置</span><br><span class="line">    handle: nunjucks</span><br><span class="line">  &#125;,</span><br><span class="line">  ejs: &#123; // ejs 的具体配置</span><br><span class="line">    handle: ejs,</span><br><span class="line">    viewPath: path.join(think.ROOT_PATH, &#x27;view/ejs/&#x27;),</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">exports.cache = &#123;</span><br><span class="line">  ...</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>Adapter 配置支持运行环境，可以根据不同的运行环境设置不同的配置，如：在开发环境和生产环境的数据库一般都是不一样的，这时候可以通过 <code>adapter.development.js</code> 和 <code>adapter.production.js</code> 存放有差异的配置，系统启动后会读取对应的运行环境配置和默认配置进行合并。</p><p><strong>Adapter 配置解析</strong></p><p>Adapter 配置存储了所有类型下的详细配置，具体使用时需要对其解析，选择对应的一种进行使用。比如上面的配置文件中，配置了 nunjucks 和 ejs 二种模板引擎的详细配置，但具体使用时一种场景下肯定只会用其一种模板引擎。当然，配置解析并不需要使用者在项目中具体调用，一般都是在插件对应的方法里已经处理。</p><p><strong>Adapter 使用</strong></p><p>Adapter 都是一类功能的不同实现，一般是不能独立使用的，而是配合对应的扩展一起使用。如：view Adapter（think-view-nunjucks、think-view-ejs）配合 <a href="https://github.com/thinkjs/think-view">think-view</a> 扩展进行使用。</p><p><strong>数据库</strong>：(model Adapter 配合 think-mongo 扩展进行使用)</p><p>model adapter</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">/**</span><br><span class="line"> * model adapter config</span><br><span class="line"> * @type &#123;Object&#125;</span><br><span class="line"> */</span><br><span class="line">exports.model = &#123;</span><br><span class="line">  type: &#x27;mongo&#x27;, // 默认使用的类型，调用时可以指定参数切换</span><br><span class="line">  common: &#123; // 通用配置</span><br><span class="line">    logConnect: true, // 是否打印数据库连接信息</span><br><span class="line">    logger: msg =&gt; think.logger.info(msg) // 打印信息的 logger</span><br><span class="line">  &#125;,</span><br><span class="line">  mongo: &#123;</span><br><span class="line">    host: &#x27;127.0.0.1&#x27;,</span><br><span class="line">    port: 27017,</span><br><span class="line">    user: &#x27;&#x27;,</span><br><span class="line">    password: &#x27;&#x27;,</span><br><span class="line">    database: &#x27;&#x27;, // 数据库名称</span><br><span class="line">    options: &#x27;&#x27;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>extend</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">const view = require(&#x27;think-view&#x27;);</span><br><span class="line">const model = require(&#x27;think-model&#x27;);</span><br><span class="line">const cache = require(&#x27;think-cache&#x27;);</span><br><span class="line">const session = require(&#x27;think-session&#x27;);</span><br><span class="line">const mongo = require(&#x27;think-mongo&#x27;);</span><br><span class="line"></span><br><span class="line">module.exports = [</span><br><span class="line">  view, // make application support view</span><br><span class="line">  model(think.app),  ////将 think.app 传递给 model 扩展</span><br><span class="line">  mongo(think.app),</span><br><span class="line">  cache,</span><br><span class="line">  session</span><br><span class="line">];</span><br></pre></td></tr></table></figure><h5 id="Extend（扩展）"><a href="#Extend（扩展）" class="headerlink" title="Extend（扩展）"></a>Extend（扩展）</h5><p>虽然框架内置了很多功能，但在实际项目开发中，提供的功能还是远远不够的。3.0 里引入了扩展机制，方便对框架进行扩展。支持的扩展类型为：<code>think</code>、<code>application</code>、<code>context</code>、<code>request</code>、<code>response</code>、<code>controller</code>、<code>logic</code> 和 <code>service</code>。</p><p>框架内置的很多功能也是扩展来实现的，如：<code>Session</code>、<code>Cache</code>。</p><h5 id="Context（上下文）"><a href="#Context（上下文）" class="headerlink" title="Context（上下文）"></a>Context（上下文）</h5><p>Context 是 Koa 中处理用户请求中的一个对象，贯穿整个请求生命周期。一般在<code>middleware、controller、logic</code>中使用，简称 ctx。</p><p>框架里继承了该对象，并通过 Extend 机制扩展了很多非常有用的属性和方法。</p><p>例如：</p><p><strong>ctx.state</strong></p><p>在中间件之间传递信息以及将信息发送给模板时，推荐的命名空间。避免直接在 ctx 上加属性，这样可能会覆盖掉已有的属性，导致出现奇怪的问题。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ctx.state.user = await User.find(id);</span><br></pre></td></tr></table></figure><p>这样后续在 controller 里可以通过 <code>this.ctx.state.user</code> 来获取对应的值。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">module.exports = class extends think.Controller &#123;</span><br><span class="line">  indexAction() &#123;</span><br><span class="line">    const user = this.ctx.state.user;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>ctx.header</strong></p><p>获取所有的 header 信息，等同于 <code>ctx.request.header</code>。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">const headers = ctx.headers;</span><br></pre></td></tr></table></figure><p><strong>ctx.headers</strong></p><p>获取所有的 header 信息，等同于 <code>ctx.header</code>。</p><p><strong>ctx.url</strong></p><p>获取请求地址。</p><h5 id="Middleware（中间件）"><a href="#Middleware（中间件）" class="headerlink" title="Middleware（中间件）"></a>Middleware（中间件）</h5><p>Middleware 称之为中间件，是 Koa 中一个非常重要的概念，利用中间件，可以很方便的处理用户的请求。</p><p>中间件格式为一个高阶函数，外部的函数接收一个 <code>options</code> 参数，这样方便中间件提供一些配置信息，用来开启&#x2F;关闭一些功能。执行后返回另一个函数，这个函数接收 <code>ctx</code>, <code>next</code> 参数，其中 <code>ctx</code> 为 <code>context</code> 的简写，是当前请求生命周期的一个对象，存储了当前请求的一些相关信息，<code>next</code> 为调用后续的中间件，返回值是 Promise，这样可以很方便的处理后置逻辑。（执行过程是个洋葱模型）</p><p><strong>配置格式</strong></p><p>为了方便管理和使用中间件，框架使用的配置文件来管理中间件，配置文件为<code>src/config/middleware.js</code>。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">const path = require(&#x27;path&#x27;)</span><br><span class="line">const isDev = think.env === &#x27;development&#x27;</span><br><span class="line"></span><br><span class="line">module.exports = [</span><br><span class="line">  &#123;</span><br><span class="line">    handle: &#x27;meta&#x27;, // 中间件处理函数</span><br><span class="line">    options: &#123;   // 当前中间件需要的配置</span><br><span class="line">      logRequest: isDev,</span><br><span class="line">      sendResponseTime: isDev,</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    handle: &#x27;resource&#x27;,</span><br><span class="line">    enable: isDev, // 是否开启当前中间件</span><br><span class="line">    options: &#123;</span><br><span class="line">      root: path.join(think.ROOT_PATH, &#x27;www&#x27;),</span><br><span class="line">      publicPath: /^\/(static|favicon\.ico)/,</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;</span><br><span class="line">]</span><br></pre></td></tr></table></figure><p>配置项为项目中要使用的中间件列表，每一项支持<code>handle</code>，<code>enable</code>，<code>options</code>，<code>match</code>等属性。</p><p><code>handle</code></p><p>中间件的处理函数，可以使用系统内置的，也可以是外部导入的，也可以是项目里的中间件。</p><p><code>enable</code></p><p>是否开启当前的中间件。</p><p><code>options</code></p><p>传递给中间件的配置项，格式为一个对象，中间件里获取到这个配置。</p><p><code>match</code></p><p>匹配特定的规则后才执行该中间件，支持两种方式，一种是路径匹配，一种是自定义函数匹配。</p><p><strong>框架内置的中间件</strong></p><p>框架内置了几个中间件，可以通过字符串的方式直接引用。</p><ul><li><code>meta</code> 显示一些 meta 信息。如：发送 ThinkJS 版本号，接口的处理时间等</li><li><code>resource</code> 处理静态资源，生产环境建议关闭，直接用 webserver 处理即可</li><li><code>trace</code> 处理报错，开发环境将详细的报错信息显示处理，也可以自定义显示错误页面</li><li><code>payload</code> 处理表单提交和文件上传，类似于<code>koa-bodyparser</code>等 middleware</li><li><code>router</code> 路由解析，包含自定义路由解析</li><li><code>logic</code> logic 调用，数据校验</li><li><code>controller</code> controller 和 action</li></ul><p><strong>项目中自定义的中间件</strong></p><p>有时候项目中根据一些特定需要添加中间件，那么可以放在<code>src/middleware</code>目录下，然后就可以直接通过字符串的方式引用。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">// middleware/log.js</span><br><span class="line"></span><br><span class="line">const defaultOptions = &#123;</span><br><span class="line">  consoleExecTime: true // 是否打印执行时间的配置</span><br><span class="line">&#125;</span><br><span class="line">module.exports = (options = &#123;&#125;) =&gt; &#123;</span><br><span class="line">  // 合并传递进来的配置</span><br><span class="line">  options = Object.assign(&#123;&#125;, defaultOptions, options);</span><br><span class="line">  return (ctx, next) =&gt; &#123;</span><br><span class="line">    if(!options.consoleExecTime) &#123;</span><br><span class="line">      return next(); // 如果不需要打印执行时间，直接调用后续执行逻辑</span><br><span class="line">    &#125;</span><br><span class="line">    const startTime = Date.now();</span><br><span class="line">    let err = null;</span><br><span class="line">    // 调用 next 统计后续执行逻辑的所有时间</span><br><span class="line">    return next().catch(e =&gt; &#123;</span><br><span class="line">      err = e; // 这里先将错误保存在一个错误对象上，方便统计出错情况下的执行时间</span><br><span class="line">    &#125;).then(() =&gt; &#123;</span><br><span class="line">      const endTime = Date.now();</span><br><span class="line">      console.log(`request exec time: $&#123;endTime - startTime&#125;ms`);</span><br><span class="line">      if(err) return Promise.reject(err); // 如果后续执行逻辑有错误，则将错误返回</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>用法：在<code>/src/config/middleware.js</code></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">module.exports = [</span><br><span class="line">  &#123;</span><br><span class="line">    handle: &#x27;log&#x27;, // 中间件处理函数</span><br><span class="line">    options: &#123;   // 当前中间件需要的配置</span><br><span class="line">      consoleExecTime: true,</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;</span><br><span class="line">]</span><br></pre></td></tr></table></figure><p><strong>引入外部的中间件</strong></p><p>引入外部的中间件非常简单，只需要<code>require</code>进来即可。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">const cors = require(&#x27;koa2-cors&#x27;);</span><br><span class="line">module.exports = [</span><br><span class="line">  ...,</span><br><span class="line">  &#123;</span><br><span class="line">    handle: cors,</span><br><span class="line">    option: &#123;</span><br><span class="line">      origin: &#x27;*&#x27;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  ...</span><br><span class="line">]</span><br><span class="line"></span><br></pre></td></tr></table></figure><h5 id="Controller（控制器）"><a href="#Controller（控制器）" class="headerlink" title="Controller（控制器）"></a>Controller（控制器）</h5><p>MVC 模型中，控制器是用户请求的逻辑处理部分。比如：将用户相关的操作都放在<code>user.js</code>里，每一个操作就是里面的一个 Action。</p><p><strong>创建 controller</strong></p><p>项目里的 controller 需要继承<code>think.Controller</code>类，这样能使用一些内置的方法。当然项目中可以创建一些通用的基类，然后实际的 controller 都继承自这个基类。</p><p>项目创建时会自动创建一个名为<code>base.js</code>的基类，其他的<code>controller</code>继承该类即可。</p><p><strong>Action 执行</strong></p><p>Action 执行是通过中间件<code>think-controller</code>来完成的，通过<code>ctx.action</code>值在 controller 寻找 xxxAction 的方法名并调用，且调用相关的魔术方法，具体顺序为：</p><ul><li>实例化 Controller 类，传入 <code>ctx</code> 对象</li><li>如果方法 <a href="https://thinkjs.org/doc/3.0/controller.html#toc-083">__before</a> 存在则调用，如果返回值为 <code>false</code>，则停止继续执行</li><li>如果方法 <code>xxxAction</code> 存在则执行，如果返回值为 <code>false</code>，则停止继续执行</li><li>如果方法 <code>xxxAction</code> 不存在但 <a href="https://thinkjs.org/doc/3.0/controller.html#toc-fcb">__call</a> 方法存在，则调用 __call，如果返回值为 <code>false</code>，则停止继续执行</li><li>如果方法 <a href="https://thinkjs.org/doc/3.0/controller.html#toc-e16">__after</a> 存在则执行前置操作__before</li></ul><ul><li>如果方法 <a href="https://thinkjs.org/doc/3.0/controller.html#toc-e16">__after</a> 存在则执行</li></ul><p><strong>前置操作 __before</strong></p><p>项目中，有时候需要在一个统一的地方做一些操作，如：判断是否已经登录，如果没有登录就不能继续后面行为。此种情况下，可以通过内置的 <code>__before</code> 来实现。</p><p><code>__before</code> 是在调用具体的 Action 之前调用的，这样就可以在其中做一些处理。</p><p>如果类继承需要调用父级的 <code>__before</code> 方法的话，可以通过 <code>super.__before</code> 来完成。</p><p><strong>后置操作 __after</strong></p><p>后置操作 <code>__after</code> 与 <code>__before</code> 对应，只是在具体的 Action 执行之后执行，如果具体的 Action 执行返回了 <code>false</code>，那么 <code>__after</code> 不再执行。</p><h5 id="Logic"><a href="#Logic" class="headerlink" title="Logic"></a>Logic</h5><p>当在 Action 里处理用户的请求时，经常要先获取用户提交过来的数据，然后对其校验，如果校验没问题后才能进行后续的操作；当参数校验完成后，有时候还需要进行权限判断等，这些都判断无误后才能进行真正的逻辑处理。如果将这些代码都放在一个 Action 里，势必让 Action 的代码非常复杂且冗长。</p><p>为了解决这个问题，ThinkJS 在控制器前面增加了一层 Logic，Logic 里的 Action 和控制器里的 Action 一一对应，系统在调用控制器里的 Action 之前会自动调用 Logic 里的 Action。</p><h5 id="Router（路由）"><a href="#Router（路由）" class="headerlink" title="Router（路由）"></a>Router（路由）</h5><p>当用户访问一个地址时，需要有一个对应的逻辑进行处理。传统的处理方式下，一个请求对应的文件，如访问是<code>/user/about.php</code>,那么就会在项目对应的目录下有<code>/user/about.php</code>这个实体文件。这种方式虽然能解决问题，但会导致文件很多，同时可能很多文件逻辑功能其实比较简单。</p><p>在现在的 MVC 开发模型里，一般都是通过路由来解决此类问题。解决方式为：先将用户的所有请求映射到一个入口文件（如：<code>index.php</code>），然后框架解析当前请求的地址，根据配置或者约定解析出对应要执行的功能，最后去调用然后响应用户的请求。</p><p>由于 Node.js 是自己启动 HTTP（S）服务的，所以已经将用户的请求汇总到一个入口文件了，这样处理路由映射就更简单了。</p><p>在 ThinkJS 中，当用户访问一个 URL 时，最后是通过 controller 里具体的 action 来响应的。所以就需要解析出 URL 对应的 controller 和 action，这个解析工作是通过<code>think-router</code>模块来实现的。</p><p><strong>路由配置</strong></p><p><code>think-router</code>是一个 middleware，项目创建时已经默认加到配置文件<code>src/config/middleware.js</code>里了。</p><p><strong>路径预处理</strong></p><p>当用户访问服务时，通过<code>ctx.url</code>属性，可以得到初始的<code>pathname</code>，但是为了方便后续通过<code>pathname</code>解析出 controller 和 action，需要对 pathname 进行预处理。比如去除 URL 中<code>.html</code>后缀等操作，最后得到真正后续所需解析的<code>pathname</code>。默认的路由解析规则为<code>/controller/action</code>.</p><p>对于 ThinkJS 中的 controller，可以不用写 router，也可以自定义 router。</p><table><thead><tr><th>pathname</th><th>子集控制器</th><th>controller</th><th>action</th><th>备注</th></tr></thead><tbody><tr><td>&#x2F;</td><td>无</td><td>index</td><td>index</td><td>controller、action 为配置的默认值</td></tr><tr><td>&#x2F;user</td><td>无</td><td>user</td><td>index</td><td>action 为配置的默认值</td></tr><tr><td>&#x2F;user&#x2F;login</td><td>无</td><td>user</td><td>login</td><td></td></tr><tr><td>&#x2F;console&#x2F;user&#x2F;login</td><td>有</td><td>console&#x2F;user</td><td>login</td><td>有子集控制器 console&#x2F;user</td></tr><tr><td>&#x2F;console&#x2F;user&#x2F;login&#x2F;aaa&#x2F;b</td><td>有</td><td>console&#x2F;user</td><td>login</td><td>剩余的 aaa&#x2F;b 不在解析</td></tr></tbody></table><p><strong>自定义路由规则</strong></p><p>虽然默认的路由解析方式能够满足需求，但有时候会导致 URL 看起来不够优雅，我们更希望 URL 比较简短，这样会更利于记忆和传播。框架提供了自定义路由来处理这种需求。</p><p>自定义路由规则配置文件为<code>src/config/router.js</code>,路由规则为二维数组。</p><h5 id="异步处理"><a href="#异步处理" class="headerlink" title="异步处理"></a>异步处理</h5><p>Node.js 使用了一个事件驱动、非阻塞式 I&#x2F;O 的模型，很多接口都是异步的，如：文件操作、网络请求。虽然提供了文件操作的同步接口，但这些接口是阻塞式的，非特殊情况下不要使用它。</p><p>对于异步接口，官方的 API 都是 callback 形式的，但是这种方式在业务逻辑复杂后，很容易出现<a href="http://callbackhell.com/%22Markdown%22">callback hell</a> 的问题，为了解决这个问题相继出现了 event、Promise、Generator function、Async function 等解决方案，ThinkJS 使用 async function 方案来解决异步问题。</p><p><strong>Async functions</strong></p><p>Async functions 使用 <code>async/await</code> 语法定义函数，如：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">async function fn() &#123;</span><br><span class="line">  const value = await getFromApi();</span><br><span class="line">  doSomethimgWithValue();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>有 await 时必须要有 async，但有 async 不一定非要有 await</li><li>Async functions 可以是普通函数的方式，也可以是 Arrow functions 的方式</li><li>await 后面需要接 Promise，如果不是 Promise，则不会等待处理</li><li>返回值肯定为 Promise</li></ul><p>返回值和 await 后面接的表达式均为 Promise，也就是说 Async functions 以 Promise 为基础。如果 await 后面的表达式返回值不是 Promise，那么需要通过一些方式将其包装为 Promise。</p><h4 id="模型-x2F-数据库"><a href="#模型-x2F-数据库" class="headerlink" title="模型&#x2F;数据库"></a>模型&#x2F;数据库</h4><h5 id="关系型数据库"><a href="#关系型数据库" class="headerlink" title="关系型数据库"></a>关系型数据库</h5><p>在项目开发中，经常需要操作数据库（如：增删改查等功能），手工拼写 SQL 语句非常麻烦，同时还要注意 SQL 注入等安全问题。为此框架提供了模型功能，方便操作数据库。</p><p><strong>扩展模型功能</strong></p><p>框架默认没有提供模型的功能，需要加载对应的扩展才能支持，对应的模块为 <a href="https://github.com/thinkjs/think-model">think-model</a>。修改扩展的配置文件 <code>src/config/extend.js</code>，添加如下的配置：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">const model = require(&#x27;think-model&#x27;);</span><br><span class="line">module.exports = [</span><br><span class="line">  model(think.app) // 让框架支持模型的功能</span><br><span class="line">]；</span><br></pre></td></tr></table></figure><p><strong>配置数据库</strong></p><p>模型由于要支持多种数据库，所以配置文件的格式为 Adapter 的方式，文件路径为 <code>src/config/adapter.js</code></p><p><strong>Mysql</strong></p><p>Mysql 的 Adapter 为 <a href="https://github.com/thinkjs/think-model-mysql">think-model-mysql</a>，底层基于 <a href="https://github.com/mysqljs/mysql">mysql</a> 库实现，使用连接池的方式连接数据库，默认连接数为 1。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">const mysql = require(&#x27;think-model-mysql&#x27;);</span><br><span class="line">exports.model = &#123;</span><br><span class="line">  type: &#x27;mysql&#x27;,</span><br><span class="line">  mysql: &#123;</span><br><span class="line">    handle: mysql, // Adapter handle</span><br><span class="line">    user: &#x27;root&#x27;, // 用户名</span><br><span class="line">    password: &#x27;&#x27;, // 密码</span><br><span class="line">    database: &#x27;&#x27;, // 数据库</span><br><span class="line">    host: &#x27;127.0.0.1&#x27;, // host</span><br><span class="line">    port: 3306, // 端口</span><br><span class="line">    connectionLimit: 1, // 连接池的连接个数，默认为 1</span><br><span class="line">    prefix: &#x27;&#x27;, // 数据表前缀，如果一个数据库里有多个项目，那项目之间的数据表可以通过前缀来区分</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>创建模型文件</strong></p><p>模型文件放在 <code>src/model/</code> 目录下，继承模型基类 <code>think.Model</code>，文件格式为：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">// src/model/user.js</span><br><span class="line">module.exports = class extends think.Model &#123;</span><br><span class="line">  getList() &#123;</span><br><span class="line">    return this.field(&#x27;name&#x27;).select();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>实例化模型</strong></p><p>项目启动时，会扫描项目下的所有模型文件，扫描后会将所有的模型类存放在 <code>think.app.models</code> 对象上，实例化时会从这个对象上查找，如果找不到则实例化模型基类 <code>think.Model</code>。</p><p><strong>CRUD 操作</strong></p><p><code>think.Model</code> 基类提供了丰富的方法进行 CRUD 操作，下面来一一介绍。</p><p><a href="https://thinkjs.org/zh-cn/doc/3.0/relation_model.html">https://thinkjs.org/zh-cn/doc/3.0/relation_model.html</a></p><h5 id="MongoDB"><a href="#MongoDB" class="headerlink" title="MongoDB"></a>MongoDB</h5><p>有时候关系数据库并不能满足项目的需求，需要 MongoDB 来存储数据。框架提供了 <a href="https://github.com/thinkjs/think-mongo">think-mongo</a> 扩展来支持 MongoDB，该模块是基于 <a href="https://github.com/mongodb/node-mongodb-native">mongodb</a> 实现的。</p><p><strong>配置 MongoDB 数据库</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">MongoDB 的数据库配置复用了关系数据库模型的配置，为 adapter 配置，放在 model 下。文件路径为 `src/config/adapter.js`</span><br><span class="line"></span><br><span class="line">exports.model = &#123;</span><br><span class="line">  type: &#x27;mongo&#x27;, // 默认使用的类型，调用时可以指定参数切换</span><br><span class="line">  common: &#123; // 通用配置</span><br><span class="line">    logConnect: true, // 是否打印数据库连接信息</span><br><span class="line">    logger: msg =&gt; think.logger.info(msg) // 打印信息的 logger</span><br><span class="line">  &#125;,</span><br><span class="line">  mongo: &#123;</span><br><span class="line">    host: &#x27;127.0.0.1&#x27;,</span><br><span class="line">    port: 27017,</span><br><span class="line">    user: &#x27;&#x27;,</span><br><span class="line">    password: &#x27;&#x27;,</span><br><span class="line">    database: &#x27;&#x27;, // 数据库名称</span><br><span class="line">    options: &#123;</span><br><span class="line">      replicaSet: &#x27;mgset-3074013&#x27;,</span><br><span class="line">      authSource: &#x27;admin&#x27;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>扩展 MongoDB 功能</strong></p><p>修改扩展的配置文件 <code>src/config/extend.js</code>，添加如下的配置：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">const mongo = require(&#x27;think-mongo&#x27;);</span><br><span class="line"></span><br><span class="line">module.exports = [</span><br><span class="line">  mongo(think.app) // 让框架支持模型的功能</span><br><span class="line">]</span><br></pre></td></tr></table></figure><p>添加完扩展后，会注入 <code>think.Mongo</code>、<code>think.mongo</code>、<code>ctx.mongo</code> 和 <code>controller.mongo</code> 方法，其中 think.Mongo 为 Mongo 模型的基类文件，其他为实例化 Mongo 模型的方法，ctx.mongo 和 controller.mongo 是 think.mongo 方法的包装。</p><p><strong>创建模型文件</strong></p><p>模型文件放在 <code>src/model/</code> 目录下（多模块项目为 <code>src/common/model</code> 以及 <code>src/[module]/model</code>），继承模型基类 <code>think.Mongo</code>，文件格式为：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">// src/model/user.js</span><br><span class="line">module.exports = class extends think.Mongo &#123;</span><br><span class="line">  getList() &#123;</span><br><span class="line">    return this.field(&#x27;name&#x27;).select();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>实例化模型</strong></p><p>项目启动时，会扫描项目下的所有模型文件（目录为 <code>src/model/</code>），扫描后会将所有的模型类存放在 <code>think.app.models</code> 对象上，实例化时会从这个对象上查找，如果找不到则实例化模型基类 <code>think.Mongo</code>。</p><p><strong>API</strong></p><p><a href="https://thinkjs.org/zh-cn/doc/3.0/mongo.html">https://thinkjs.org/zh-cn/doc/3.0/mongo.html</a></p><h4 id="think-对象"><a href="#think-对象" class="headerlink" title="think 对象"></a>think 对象</h4><p>框架中内置 <code>think</code> 全局对象，方便在项目中随时随地使用。</p><p><strong>API</strong></p><p><a href="https://thinkjs.org/zh-cn/doc/3.0/think.html">https://thinkjs.org/zh-cn/doc/3.0/think.html</a></p><h4 id="启动自定义"><a href="#启动自定义" class="headerlink" title="启动自定义"></a>启动自定义</h4><p>当通过 <code>npm start</code> 或者 <code>node production.js</code> 来启动项目时，虽然可以在这些入口文件里添加其他的逻辑代码，但并不推荐这么做。系统给出了其他启动自定义的入口。</p><p><strong>bootstrap</strong></p><p>系统启动时会加载 <code>src/boostrap/</code> 目录下的文件，具体为：</p><ul><li>Master 进程下时加载 <code>src/bootstrap/master.js</code></li><li>Worker 进程下时加载 <code>src/bootstrap/worker.js</code></li></ul><p>所以可以将一些需要在系统启动时就需要执行的逻辑放在对应的文件里执行。</p><h4 id="Service-x2F-服务"><a href="#Service-x2F-服务" class="headerlink" title="Service &#x2F; 服务"></a>Service &#x2F; 服务</h4><p>项目中，有时候除了查询数据库等操作外，也需要调用远程的一些接口，如：调用 GitHub 的接口、调用发送短信的接口等等。</p><p>这种功能放在 Model 下是不太合适的，为此，框架提供了 Service 来解决此类问题。</p><p><strong>创建 Service 文件</strong></p><p>Service 文件存放在 <code>src/service/</code> 目录下，文件内容格式如下：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">//  src/service/user.js</span><br><span class="line">module.exports = class extends think.Service &#123;</span><br><span class="line">  find(id)&#123;</span><br><span class="line">     return &#123;username:&#x27;123&#x27;,id:id&#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>Service 都继承 <code>think.Service</code> 基类，但该基类不提供任何方法，可以通过 Extend 进行扩展。</p><p><strong>实例化 Service 类</strong></p><p>可以通过 <code>think.service</code> 方法实例化 Service 类，在控制器、ctx 也有对应的 <code>service</code> 方法，如：<code>ctx.service</code>、<code>controller.service</code>，这些方法都是 think.service 的快捷方式。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">//controller</span><br><span class="line"></span><br><span class="line">think.service(&#x27;user&#x27;).find(111)</span><br></pre></td></tr></table></figure><p>项目启动时，会扫描项目下所有的 services 文件，并存放到 <code>think.app.services</code> 对象下，实例化时会从该对象上查找对应的类文件，如果找不到则报错。</p>]]></content>
      
      
      <categories>
          
          <category> 后端开发 </category>
          
          <category> JavaScript </category>
          
      </categories>
      
      
        <tags>
            
            <tag> JavaScript </tag>
            
            <tag> Node.js </tag>
            
            <tag> ThinkJS </tag>
            
            <tag> Web开发 </tag>
            
            <tag> 事件驱动 </tag>
            
            <tag> 服务器端编程 </tag>
            
            <tag> npm </tag>
            
            <tag> 非阻塞IO </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Angular核心功能详解：方法、指令、服务与过滤器</title>
      <link href="/2018/03/25/angular%E5%B8%B8%E7%94%A8%E6%96%B9%E6%B3%95%E3%80%81%E6%8C%87%E4%BB%A4%E3%80%81%E6%9C%8D%E5%8A%A1%E3%80%81%E8%BF%87%E6%BB%A4%E5%99%A8-angular%E5%B8%B8%E7%94%A8%E6%96%B9%E6%B3%95%E6%8C%87%E4%BB%A4%E6%9C%8D%E5%8A%A1%E8%BF%87%E6%BB%A4%E5%99%A8/"/>
      <url>/2018/03/25/angular%E5%B8%B8%E7%94%A8%E6%96%B9%E6%B3%95%E3%80%81%E6%8C%87%E4%BB%A4%E3%80%81%E6%9C%8D%E5%8A%A1%E3%80%81%E8%BF%87%E6%BB%A4%E5%99%A8-angular%E5%B8%B8%E7%94%A8%E6%96%B9%E6%B3%95%E6%8C%87%E4%BB%A4%E6%9C%8D%E5%8A%A1%E8%BF%87%E6%BB%A4%E5%99%A8/</url>
      
        <content type="html"><![CDATA[<h1 id="angular-方法"><a href="#angular-方法" class="headerlink" title="angular 方法"></a>angular 方法</h1><h2 id="1-拷贝数组或对象"><a href="#1-拷贝数组或对象" class="headerlink" title="1. 拷贝数组或对象"></a>1. 拷贝数组或对象</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">angular.<span class="title function_">copy</span>(source, [destination]);</span><br></pre></td></tr></table></figure><h2 id="2-选择一个元素"><a href="#2-选择一个元素" class="headerlink" title="2. 选择一个元素"></a>2. 选择一个元素</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">angular.<span class="title function_">element</span>(element); <span class="comment">//jqLite</span></span><br></pre></td></tr></table></figure>  <span id="more"></span><h2 id="3-比较值是否相等"><a href="#3-比较值是否相等" class="headerlink" title="3. 比较值是否相等"></a>3. 比较值是否相等</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">angular.<span class="title function_">equals</span>(o1, o2); <span class="comment">//返回值：boolean</span></span><br></pre></td></tr></table></figure><h2 id="4-迭代对象"><a href="#4-迭代对象" class="headerlink" title="4. 迭代对象"></a>4. 迭代对象</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">angular.<span class="title function_">forEach</span>(obj, iterator, [context]); <span class="comment">//iteeator是一个方法function(value,key,[obj])&#123;处理代码&#125;</span></span><br></pre></td></tr></table></figure><h2 id="5-把-json-字符串转换为对象"><a href="#5-把-json-字符串转换为对象" class="headerlink" title="5. 把 json 字符串转换为对象"></a>5. 把 json 字符串转换为对象</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">angular.<span class="title function_">fromJson</span>(json);</span><br></pre></td></tr></table></figure><h2 id="6-把对象转换为-json-字符串"><a href="#6-把对象转换为-json-字符串" class="headerlink" title="6.把对象转换为 json 字符串"></a>6.把对象转换为 json 字符串</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">angular.<span class="title function_">toJson</span>(obj, pretty); <span class="comment">//pretty为ture时，输出字符串有换行符和空格。如果设置为一个整数，JSON输出将包含许多空间每缩进（默认为2）</span></span><br></pre></td></tr></table></figure><h2 id="7-判断是否为数组、时间、DOM-元素、函数、数字、对象、字符串、未定义、"><a href="#7-判断是否为数组、时间、DOM-元素、函数、数字、对象、字符串、未定义、" class="headerlink" title="7. 判断是否为数组、时间、DOM 元素、函数、数字、对象、字符串、未定义、"></a>7. 判断是否为数组、时间、DOM 元素、函数、数字、对象、字符串、未定义、</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">angular.<span class="title function_">isArray</span>(value);</span><br><span class="line">angular.<span class="title function_">isDate</span>(value);</span><br><span class="line">angular.<span class="title function_">isElement</span>(value);</span><br><span class="line">angular.<span class="title function_">isFunction</span>(value);</span><br><span class="line">angular.<span class="title function_">isNumber</span>(value);</span><br><span class="line">angular.<span class="title function_">isObject</span>(value);</span><br><span class="line">angular.<span class="title function_">isString</span>(value);</span><br><span class="line">angular.<span class="title function_">isUndefined</span>(value);</span><br></pre></td></tr></table></figure><h1 id="angular-指令"><a href="#angular-指令" class="headerlink" title="angular 指令"></a>angular 指令</h1><h2 id="1-失去焦点事件"><a href="#1-失去焦点事件" class="headerlink" title="1. 失去焦点事件"></a>1. 失去焦点事件</h2><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ngBlur</span><br></pre></td></tr></table></figure><h2 id="2-值改变时触发事件"><a href="#2-值改变时触发事件" class="headerlink" title="2.值改变时触发事件"></a>2.值改变时触发事件</h2><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">input</span></span></span><br><span class="line"><span class="tag">        <span class="attr">ng-change</span>=<span class="string">&quot;&quot;</span>&gt;</span></span><br><span class="line">...</span><br><span class="line"><span class="tag">&lt;/<span class="name">input</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="3-动态设置-class"><a href="#3-动态设置-class" class="headerlink" title="3. 动态设置 class"></a>3. 动态设置 class</h2><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">input</span></span></span><br><span class="line"><span class="tag">        <span class="attr">ng-class</span>=<span class="string">&quot;&quot;</span>&gt;</span></span><br><span class="line">...</span><br><span class="line"><span class="tag">&lt;/<span class="name">input</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="4-点击事件"><a href="#4-点击事件" class="headerlink" title="4. 点击事件"></a>4. 点击事件</h2><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">ANY</span> <span class="attr">ng-click</span>=<span class="string">&quot;expression&quot;</span>&gt;</span> ... <span class="tag">&lt;/<span class="name">ANY</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="5-双击事件"><a href="#5-双击事件" class="headerlink" title="5. 双击事件"></a>5. 双击事件</h2><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">ANY</span> <span class="attr">ng-dblclick</span>=<span class="string">&quot;expression&quot;</span>&gt;</span> ... <span class="tag">&lt;/<span class="name">ANY</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="6-禁用元素"><a href="#6-禁用元素" class="headerlink" title="6. 禁用元素"></a>6. 禁用元素</h2><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">INPUT</span></span></span><br><span class="line"><span class="tag">  <span class="attr">ng-disabled</span>=<span class="string">&quot;expression&quot;</span>&gt;</span></span><br><span class="line">...</span><br><span class="line"><span class="tag">&lt;/<span class="name">INPUT</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="7-获得焦点触发事件"><a href="#7-获得焦点触发事件" class="headerlink" title="7. 获得焦点触发事件"></a>7. 获得焦点触发事件</h2><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;window, input, select, textarea, a</span><br><span class="line">  ng-focus=&quot;expression&quot;&gt;</span><br><span class="line">...</span><br><span class="line">&lt;/window, input, select, textarea, a&gt;</span><br></pre></td></tr></table></figure><h2 id="8-显示、隐藏元素"><a href="#8-显示、隐藏元素" class="headerlink" title="8. 显示、隐藏元素"></a>8. 显示、隐藏元素</h2><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">ANY</span> <span class="attr">ng-hide</span>=<span class="string">&quot;true&quot;</span>&gt;</span> <span class="tag">&lt;/<span class="name">ANY</span>&gt;</span> <span class="tag">&lt;<span class="name">ANY</span> <span class="attr">ng-show</span>=<span class="string">&quot;true&quot;</span>&gt;</span> <span class="tag">&lt;/<span class="name">ANY</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="9-判断来确定是否进行显示"><a href="#9-判断来确定是否进行显示" class="headerlink" title="9. 判断来确定是否进行显示"></a>9. 判断来确定是否进行显示</h2><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">ANY</span> <span class="attr">ng-if</span>=<span class="string">&quot;expression&quot;</span>&gt;</span> ... <span class="tag">&lt;/<span class="name">ANY</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="10-导入其他页面"><a href="#10-导入其他页面" class="headerlink" title="10. 导入其他页面"></a>10. 导入其他页面</h2><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">ANY</span> <span class="attr">ng-include</span>=<span class="string">&quot;&quot;</span> [<span class="attr">onload</span>=<span class="string">&quot;&quot;</span> ] [<span class="attr">autoscroll</span>=<span class="string">&quot;&quot;</span> ]&gt;</span> ... <span class="tag">&lt;/<span class="name">ANY</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="11-将输入文本转换为数组"><a href="#11-将输入文本转换为数组" class="headerlink" title="11. 将输入文本转换为数组"></a>11. 将输入文本转换为数组</h2><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">input</span></span></span><br><span class="line"><span class="tag">        [<span class="attr">ng-list</span>=<span class="string">&quot;&quot;</span>]&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">input</span>&gt;</span></span><br><span class="line">输入的文本会转换数组，默认用，分割</span><br></pre></td></tr></table></figure><h2 id="12-只读"><a href="#12-只读" class="headerlink" title="12. 只读"></a>12. 只读</h2><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ngReadonly</span><br></pre></td></tr></table></figure><h2 id="13-遍历"><a href="#13-遍历" class="headerlink" title="13. 遍历"></a>13. 遍历</h2><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">ng-repeat</span>=<span class="string">&quot;(key, value) in myObj&quot;</span>&gt;</span>...<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="14-提交表单"><a href="#14-提交表单" class="headerlink" title="14.提交表单"></a>14.提交表单</h2><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">ng-submit</span>=<span class="string">&quot;&quot;</span>&gt;</span>...<span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="15-switch"><a href="#15-switch" class="headerlink" title="15. switch"></a>15. switch</h2><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">ng-model</span>=<span class="string">&quot;selection&quot;</span> <span class="attr">ng-options</span>=<span class="string">&quot;item for item in items&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;animate-switch-container&quot;</span> <span class="attr">ng-switch</span> <span class="attr">on</span>=<span class="string">&quot;selection&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;animate-switch&quot;</span> <span class="attr">ng-switch-when</span>=<span class="string">&quot;settings|options&quot;</span> <span class="attr">ng-switch-when-separator</span>=<span class="string">&quot;|&quot;</span>&gt;</span>Settings Div<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;animate-switch&quot;</span> <span class="attr">ng-switch-when</span>=<span class="string">&quot;home&quot;</span>&gt;</span>Home Span<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;animate-switch&quot;</span> <span class="attr">ng-switch-default</span>&gt;</span>default<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--ngSwitch指令包含ng-switch on、ng-switch-when、ng-switch-default功能类似switch，ng-switch on指要判断的值，ng-switch-when指条件条件符合将显示这个dom元素， ng-switch-default指条件都不符合默认显示的元素--&gt;</span></span><br></pre></td></tr></table></figure><h1 id="service"><a href="#service" class="headerlink" title="service"></a>service</h1><ol><li>过滤器$filter</li><li>$http</li><li>循环$interval</li><li>$log</li><li>$q</li><li>延时$timeout</li><li>$window</li></ol><h1 id="内置过滤器"><a href="#内置过滤器" class="headerlink" title="内置过滤器"></a>内置过滤器</h1><ol><li>格式化数字 currency</li><li>格式化日期事件 date</li><li>过滤数组 filter</li><li>将对象转换为 json 字符串 json</li><li>截取数组 limitTo</li><li>转化小写大写 lowercase、uppercase</li><li>格式化数字 number</li><li>排序 orderBy</li></ol>]]></content>
      
      
      <categories>
          
          <category> 前端开发 </category>
          
          <category> Angular开发 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> JavaScript </tag>
            
            <tag> 前端框架 </tag>
            
            <tag> Angular </tag>
            
            <tag> Web开发 </tag>
            
            <tag> 指令系统 </tag>
            
            <tag> 服务注入 </tag>
            
            <tag> 过滤器 </tag>
            
            <tag> DOM操作 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>JavaScript中this绑定规则详解：优先级与实践</title>
      <link href="/2018/03/23/%E5%88%A4%E5%AE%9A%20this%20%E5%88%B0%E5%BA%95%E6%8C%87%E5%90%91%E5%93%AA%E4%B8%AA%E5%AF%B9%E8%B1%A1-%E5%88%A4%E5%AE%9Athis%E5%88%B0%E5%BA%95%E6%8C%87%E5%90%91%E5%93%AA%E4%B8%AA%E5%AF%B9%E8%B1%A1/"/>
      <url>/2018/03/23/%E5%88%A4%E5%AE%9A%20this%20%E5%88%B0%E5%BA%95%E6%8C%87%E5%90%91%E5%93%AA%E4%B8%AA%E5%AF%B9%E8%B1%A1-%E5%88%A4%E5%AE%9Athis%E5%88%B0%E5%BA%95%E6%8C%87%E5%90%91%E5%93%AA%E4%B8%AA%E5%AF%B9%E8%B1%A1/</url>
      
        <content type="html"><![CDATA[<h3 id="判定-this"><a href="#判定-this" class="headerlink" title="判定 this"></a>判定 this</h3><p>现在，我们可以按照优先顺序来总结一下从函数调用的调用点来判定 this 的规则了。按照这个顺序来问问题，然后在第一个规则适用的地方停下。</p>  <span id="more"></span><ol><li>函数是通过 new 被调用的吗（new 绑定）？如果是，this 就是新构建的对象。<br>var bar &#x3D; new foo()</li><li>函数是通过 call 或 apply 被调用（明确绑定），甚至是隐藏在 bind 硬绑定 之中吗？如果是，this 就是那个被明确指定的对象。<br>var bar &#x3D; foo.call( obj2 )</li><li>函数是通过环境对象（也称为拥有者或容器对象）被调用的吗（隐含绑定）？如果是，this 就是那个环境对象。<br>var bar &#x3D; obj1.foo()</li><li>否则，使用默认的 this（默认绑定）。如果在 strict mode 下，就是 undefined，否则是 global 对象。<br>var bar &#x3D; foo()</li></ol><p>以上，就是理解对于普通的函数调用来说的 this 绑定规则 所需的全部。是的……几乎是全部</p><p>摘自：<a href="https://github.com/getify/You-Dont-Know-JS/blob/1ed-zh-CN/this%20&%20object%20prototypes/ch2.md#%E5%88%A4%E5%AE%9A-this">You-Dont-Know-JS</a></p><p><code>用作备忘</code></p>]]></content>
      
      
      <categories>
          
          <category> JavaScript </category>
          
          <category> 前端开发 </category>
          
          <category> 编程基础 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> JavaScript </tag>
            
            <tag> this绑定 </tag>
            
            <tag> 函数调用 </tag>
            
            <tag> 作用域 </tag>
            
            <tag> 对象方法 </tag>
            
            <tag> 严格模式 </tag>
            
            <tag> 开发技巧 </tag>
            
            <tag> 代码规范 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CSS现代布局技术：Flexbox与Grid布局系统详解</title>
      <link href="/2018/03/07/Flex%E5%B8%83%E5%B1%80%E5%92%8CGrids%20%E5%B8%83%E5%B1%80-flex%E5%B8%83%E5%B1%80%E5%92%8Cgrids%E5%B8%83%E5%B1%80/"/>
      <url>/2018/03/07/Flex%E5%B8%83%E5%B1%80%E5%92%8CGrids%20%E5%B8%83%E5%B1%80-flex%E5%B8%83%E5%B1%80%E5%92%8Cgrids%E5%B8%83%E5%B1%80/</url>
      
        <content type="html"><![CDATA[<h2 id="Flex-布局"><a href="#Flex-布局" class="headerlink" title="Flex 布局"></a>Flex 布局</h2><ol><li>Flex 是弹性布局，使用<code>display:flex</code>或<code>display: inline-flex</code>指定为 flex 布局</li><li>默认 水平的是主轴，垂直的是交叉轴</li><li>容器的属性（属性第一个为默认值）<ul><li>flex-direction 主轴方向 <code>row | row-reverse | column | column-reverse</code></li><li>flex-wrap 项目换行方式 <code>nowrap | wrap | wrap-reverse</code></li><li>flex–flow 以上两个属性的缩写</li><li>justify-content <strong>项目</strong>在主轴的对齐方式 <code>flex-start | flex-end | center | space-between | space-around</code></li><li>align-items <strong>项目</strong>在交叉轴对齐方式 <code>flex-start | flex-end | center | baseline | stretch</code></li><li>align-content 多跟 <strong>轴线</strong> 的对齐方式，只有一根轴线则不起作用 <code>flex-start | flex-end | center | space-between | space-around | stretch</code></li></ul></li><li>项目的属性<ul><li>order 定义项目排列顺序，数越小越靠前</li><li>flex-grow 放大比例 😵😵😵</li><li>flex-shrink 缩小比例 😵😵😵</li><li>flex-basis 在分配多余空间之前，项目占据的主轴空间 😵😵😵😵😵😵</li><li>flex 上边三个属性的简写</li><li>align-self 定义一个对齐方式的特例</li></ul></li></ol><p>演示 <a href="https://demo.agektmr.com/flexbox/">https://demo.agektmr.com/flexbox/</a></p><p>详细</p><ul><li><a href="http://www.ruanyifeng.com/blog/2015/07/flex-grammar.html">http://www.ruanyifeng.com/blog/2015/07/flex-grammar.html</a></li><li><a href="https://developer.mozilla.org/zh-CN/docs/Web/CSS/CSS_Flexible_Box_Layout">https://developer.mozilla.org/zh-CN/docs/Web/CSS/CSS_Flexible_Box_Layout</a></li></ul><h2 id="Grids-网格布局"><a href="#Grids-网格布局" class="headerlink" title="Grids 网格布局"></a>Grids 网格布局</h2><ol><li><p>使用<code>display:grid</code>指定为网格布局</p></li><li><p>容器的属性</p><ul><li>grid-template-row 定义行 有几个值就有几行</li><li>grid-template-column 定义列 有几个值就有几列</li></ul></li><li><p>项目的属性</p><ul><li><p>grid-column-start 子元素列的开始位置，数值为网格线的 index 有三行就有四个线</p></li><li><p>grid-column-end 子元素列的结束位置</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">grid-template-columns: 40px 50px auto 50px 40px;</span><br><span class="line">    grid-template-rows: 25% 100px auto;</span><br></pre></td></tr></table></figure></li><li><p>grid-column 以上两个简写 1 &#x2F; 4</p></li></ul></li></ol><p>未完。。。</p><p><a href="https://www.jianshu.com/p/d183265a8dad">https://www.jianshu.com/p/d183265a8dad</a></p><h2 id="两个游戏-抽空试试"><a href="#两个游戏-抽空试试" class="headerlink" title="两个游戏,抽空试试"></a>两个游戏,抽空试试</h2><ul><li>flex <a href="http://flexboxfroggy.com/#zh-cn">http://flexboxfroggy.com/#zh-cn</a></li><li>grids <a href="http://cssgridgarden.com/#zh-cn">http://cssgridgarden.com/#zh-cn</a></li></ul>]]></content>
      
      
      <categories>
          
          <category> 前端开发 </category>
          
          <category> CSS技术 </category>
          
          <category> 页面布局 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Flexbox </tag>
            
            <tag> CSS Grid </tag>
            
            <tag> 响应式布局 </tag>
            
            <tag> CSS3 </tag>
            
            <tag> 网页设计 </tag>
            
            <tag> 前端技术 </tag>
            
            <tag> 布局系统 </tag>
            
            <tag> 网格布局 </tag>
            
            <tag> 弹性盒子 </tag>
            
            <tag> 现代CSS </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>vuex 学习笔记</title>
      <link href="/2018/03/07/vuex%20%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-vuex%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
      <url>/2018/03/07/vuex%20%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-vuex%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/</url>
      
        <content type="html"><![CDATA[<ul><li><p>state</p><p>记录所有数据和状态的，跨页面使用的</p></li><li><p>getters</p><p>store 里的计算属性</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">state</span>:&#123;</span><br><span class="line">        <span class="attr">aaa</span>:<span class="number">2</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">getters</span>:&#123;</span><br><span class="line">        <span class="comment">// 通过$store.getters.aaacheng2访问</span></span><br><span class="line">        <span class="attr">aaacheng2</span>:<span class="function"><span class="params">state</span>=&gt;</span>&#123;</span><br><span class="line">            <span class="keyword">return</span> state.<span class="property">aaa</span>*<span class="number">2</span></span><br><span class="line">        &#125;,</span><br><span class="line"><span class="comment">// 通过$store.getters.aaacheng(6)访问</span></span><br><span class="line">        <span class="attr">aaacheng</span>:<span class="function">(<span class="params">state</span>)=&gt;</span><span class="function">(<span class="params">n</span>)=&gt;</span>&#123;</span><br><span class="line"><span class="keyword">return</span> state.<span class="property">aaa</span>*n</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// mapGetters 辅助函数 将 store 中的 getter 映射到局部计算属性</span></span><br></pre></td></tr></table></figure></li><li><p>mutation</p><p>用于修改 state 状态</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">increment</span> (state, n) &#123;</span><br><span class="line">state.<span class="property">count</span> += n</span><br><span class="line">&#125;</span><br><span class="line">store.<span class="title function_">commit</span>(<span class="string">&#x27;increment&#x27;</span>, <span class="number">10</span>)</span><br></pre></td></tr></table></figure><p><code>mapMutations</code> 辅助函数将组件的方法映射为 store.commit 调用</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">methods</span>: &#123;</span><br><span class="line">   ...<span class="title function_">mapMutations</span>([</span><br><span class="line">     <span class="string">&#x27;increment&#x27;</span>, <span class="comment">// 将 `this.increment()` 映射为 `this.$store.commit(&#x27;increment&#x27;)`</span></span><br><span class="line"></span><br><span class="line">     <span class="comment">// `mapMutations` 也支持载荷：</span></span><br><span class="line">     <span class="string">&#x27;incrementBy&#x27;</span> <span class="comment">// 将 `this.incrementBy(amount)` 映射为 `this.$store.commit(&#x27;incrementBy&#x27;, amount)`</span></span><br><span class="line">   ]),</span><br><span class="line">   ...<span class="title function_">mapMutations</span>(&#123;</span><br><span class="line">     <span class="attr">add</span>: <span class="string">&#x27;increment&#x27;</span> <span class="comment">// 将 `this.add()` 映射为 `this.$store.commit(&#x27;increment&#x27;)`</span></span><br><span class="line">   &#125;)</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure></li><li><p>action</p><p>提交 mutation 间接变更状态</p><p>保护一些常用业务操作，通过提交 mutation 改变业务中的状态</p><p>mutation 中则只包含更改 state 的方法</p><p>可以有异步操作</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> store = <span class="keyword">new</span> <span class="title class_">Vuex</span>.<span class="title class_">Store</span>(&#123;</span><br><span class="line">  <span class="attr">state</span>: &#123;</span><br><span class="line">    <span class="attr">count</span>: <span class="number">0</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">mutations</span>: &#123;</span><br><span class="line">    <span class="title function_">increment</span>(<span class="params">state</span>) &#123;</span><br><span class="line">      state.<span class="property">count</span>++;</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">actions</span>: &#123;</span><br><span class="line">    <span class="title function_">increment</span>(<span class="params">context</span>) &#123;</span><br><span class="line">      context.<span class="title function_">commit</span>(<span class="string">&quot;increment&quot;</span>);</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;);</span><br><span class="line"><span class="comment">// 调用方式</span></span><br><span class="line">store.<span class="title function_">dispatch</span>(<span class="string">&quot;increment&quot;</span>);</span><br></pre></td></tr></table></figure><p><code>mapActions</code>  辅助函数将组件的 methods 映射为   <code>store.dispatch</code>  调用</p><p>action 可以返回一个 promise</p></li><li><p>modules</p><p>把 store 分割为模块</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// A.js</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  <span class="attr">namespaced</span>: <span class="literal">true</span>,</span><br><span class="line">  <span class="attr">state</span>: &#123;&#125;,</span><br><span class="line">  <span class="attr">mutations</span>: &#123;&#125;,</span><br><span class="line">  <span class="attr">actions</span>: &#123;&#125;,</span><br><span class="line">  <span class="attr">getters</span>: &#123;&#125;,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// B.js</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  <span class="attr">namespaced</span>: <span class="literal">true</span>,</span><br><span class="line">  <span class="attr">state</span>: &#123;&#125;,</span><br><span class="line">  <span class="attr">mutations</span>: &#123;&#125;,</span><br><span class="line">  <span class="attr">actions</span>: &#123;&#125;,</span><br><span class="line">  <span class="attr">getters</span>: &#123;&#125;,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// store.js</span></span><br><span class="line"><span class="keyword">import</span> moduleA <span class="keyword">from</span> <span class="string">&quot;./A.js&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> moduleB <span class="keyword">from</span> <span class="string">&quot;./B.js&quot;</span>;</span><br><span class="line"><span class="keyword">const</span> store = <span class="keyword">new</span> <span class="title class_">Vuex</span>.<span class="title class_">Store</span>(&#123;</span><br><span class="line">  <span class="attr">modules</span>: &#123;</span><br><span class="line">    moduleA,</span><br><span class="line">    moduleB,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">this</span>.<span class="property">$store</span>.<span class="property">state</span>.<span class="property">XX</span>.<span class="property">XX</span>;</span><br><span class="line"><span class="variable language_">this</span>.<span class="property">$store</span>.<span class="property">getters</span>[<span class="string">&quot;XX/XX&quot;</span>];</span><br><span class="line"><span class="variable language_">this</span>.<span class="property">$store</span>.<span class="title function_">commit</span>(<span class="string">&quot;XX/XX&quot;</span>, data);</span><br></pre></td></tr></table></figure></li></ul>]]></content>
      
      
      <categories>
          
          <category> 前端开发 </category>
          
          <category> Vue.js </category>
          
      </categories>
      
      
        <tags>
            
            <tag> JavaScript </tag>
            
            <tag> Vue.js </tag>
            
            <tag> 前端开发 </tag>
            
            <tag> Web开发 </tag>
            
            <tag> Vuex </tag>
            
            <tag> 状态管理 </tag>
            
            <tag> 数据流管理 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Vue开发环境搭建与配置教程</title>
      <link href="/2018/03/07/VUE%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE-vue%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE/"/>
      <url>/2018/03/07/VUE%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE-vue%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE/</url>
      
        <content type="html"><![CDATA[<h1 id="安装-vue"><a href="#安装-vue" class="headerlink" title="安装 vue"></a>安装 vue</h1><ol><li><p>在 vue<a href="https://cn.vuejs.org/v2/guide/installation.html#%E5%91%BD%E4%BB%A4%E8%A1%8C%E5%B7%A5%E5%85%B7-CLI">官网</a>，使用 cli 命令行脚手架创建基本项目</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">全局安装 vue-cli</span></span><br><span class="line">npm install --global vue-cli</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">创建一个基于 webpack 模板的新项目</span></span><br><span class="line">vue init webpack my-project</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">安装依赖，走你</span></span><br><span class="line">cd my-project</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">或者 yarn</span></span><br><span class="line">npm install</span><br><span class="line">npm run dev</span><br></pre></td></tr></table></figure><span id="more"></span></li><li><p>运行<code>npm run dev</code> 打开浏览器 <a href="http://localhost:8080/">http://localhost:8080</a></p></li></ol><h1 id="配置"><a href="#配置" class="headerlink" title="配置"></a>配置</h1><h3 id="开发环境-vscode"><a href="#开发环境-vscode" class="headerlink" title="开发环境 vscode"></a>开发环境 vscode</h3><ol><li><p>使用 eslint 规范代码质量</p></li><li><p>vscode 安装插件 eslint</p></li><li><p>配置代码格式化规则 eslint</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">&quot;eslint.autoFixOnSave&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;eslint.validate&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">  <span class="string">&quot;javascript&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="string">&quot;javascriptreact&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;language&quot;</span><span class="punctuation">:</span> <span class="string">&quot;html&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;autoFix&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span></span><br><span class="line">  <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;language&quot;</span><span class="punctuation">:</span> <span class="string">&quot;vue&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;autoFix&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span></span><br><span class="line">  <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">]</span><span class="punctuation">,</span></span><br></pre></td></tr></table></figure></li><li><p>安装 vetur,配置</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">&quot;vetur.format.defaultFormatter.html&quot;</span><span class="punctuation">:</span> <span class="string">&quot;js-beautify-html&quot;</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;vetur.format.defaultFormatter.js&quot;</span><span class="punctuation">:</span> <span class="string">&quot;vscode-typescript&quot;</span><span class="punctuation">,</span></span><br></pre></td></tr></table></figure></li></ol><h3 id="axios"><a href="#axios" class="headerlink" title="axios"></a>axios</h3><ol><li><p>安装<code>yarn add axios</code></p></li><li><p>在 main.js 中导入并应用</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> axios <span class="keyword">from</span> <span class="string">&quot;axios&quot;</span>;</span><br><span class="line"><span class="title class_">Vue</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">$http</span> = axios;</span><br></pre></td></tr></table></figure></li></ol><h3 id="muse-ui"><a href="#muse-ui" class="headerlink" title="muse-ui"></a>muse-ui</h3><ol><li><p>安装<code>yarn add muse-ui</code></p></li><li><p>加载<em>main.js</em></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">Vue</span> <span class="keyword">from</span> <span class="string">&quot;vue&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">MuseUI</span> <span class="keyword">from</span> <span class="string">&quot;muse-ui&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;muse-ui/dist/muse-ui.css&quot;</span>;</span><br><span class="line"><span class="title class_">Vue</span>.<span class="title function_">use</span>(<span class="title class_">MuseUI</span>);</span><br></pre></td></tr></table></figure></li><li><p>图标显示</p><p>下载<a href="https://github.com/google/material-design-icons/releases">图标</a></p><p>解压复制 iconfont 到 static 中，然后在 index.html 引用</p></li></ol><h3 id="mdui"><a href="#mdui" class="headerlink" title="mdui"></a>mdui</h3><ol><li><p>安装<code>yarn add mdui</code></p></li><li><p>引入 css</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="string">&quot;mdui/dist/css/mdui.css&quot;</span>;</span><br></pre></td></tr></table></figure></li><li><p>在需要用 mdui api 时，引入</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> mdui <span class="keyword">from</span> <span class="string">&quot;mdui&quot;</span>;</span><br></pre></td></tr></table></figure></li></ol><h3 id="开发环境和生产环境"><a href="#开发环境和生产环境" class="headerlink" title="开发环境和生产环境"></a>开发环境和生产环境</h3><p>利用 webpack 区分两种环境</p><ol><li><p><code>build/webpack.dev.conf.js</code>文件</p><p>在 new webpack.DefinePlugin 附近</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">new</span> webpack.<span class="title class_">DefinePlugin</span>(&#123;</span><br><span class="line">     <span class="string">&#x27;process.env&#x27;</span>: <span class="built_in">require</span>(<span class="string">&#x27;../config/dev.env&#x27;</span>),</span><br><span class="line">     <span class="attr">MONITOR_IP</span>: <span class="string">&quot;&#x27;http://127.0.0.1:8360/&#x27;&quot;</span>,</span><br><span class="line">   &#125;),</span><br></pre></td></tr></table></figure><p>注意：如果配置时字符串的时候，一定要套两层引号，或者使用<code>JSON.stringify(&quot;XXXXX&quot;)</code></p><p>下面是集中配置方式</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">new</span> webpack.<span class="title class_">DefinePlugin</span>(&#123;</span><br><span class="line">  <span class="attr">PRODUCTION</span>: <span class="title class_">JSON</span>.<span class="title function_">stringify</span>(<span class="literal">true</span>),</span><br><span class="line">  <span class="attr">VERSION</span>: <span class="title class_">JSON</span>.<span class="title function_">stringify</span>(<span class="string">&quot;5fa3b9&quot;</span>),</span><br><span class="line">  <span class="attr">BROWSER_SUPPORTS_HTML5</span>: <span class="literal">true</span>,</span><br><span class="line">  <span class="attr">TWO</span>: <span class="string">&quot;1+1&quot;</span>,</span><br><span class="line">  <span class="string">&quot;typeof window&quot;</span>: <span class="title class_">JSON</span>.<span class="title function_">stringify</span>(<span class="string">&quot;object&quot;</span>),</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>参考<a href="https://segmentfault.com/a/1190000006952432">https://segmentfault.com/a/1190000006952432</a></p><p><code>DefinePlugin</code>可能会被误认为其作用是在 webpack 配置文件中为编译后的代码上下文环境设置全局变量，但其实不然。它真正的机制是：<code>DefinePlugin</code>的参数是一个 object，那么其中会有一些<code>key-value</code>对。在 webpack 编译的时候，会把业务代码中没有定义（使用 var&#x2F;const&#x2F;let 来预定义的）而变量名又与<code>key</code>相同的变量（直接读代码的话的确像是全局变量）替换成<code>value</code>。例如上面的官方例子，<code>PRODUCTION</code>就会被替换为<code>true</code>；<code>VERSION</code>就会被替换为<code>&#39;5fa3b9&#39;</code>（注意单引号）；<code>BROWSER_SUPPORTS_HTML5</code>也是会被替换为<code>true</code>；<code>TWO</code>会被替换为<code>1+1</code>（相当于是一个数学表达式）；<code>typeof window</code>就被替换为<code>&#39;object&#39;</code>了。</p></li><li><p>配置完成后，就可以在代码中直接使用，但是因为 eslint 的关系，会提示变量没有定义，但其实是可以直接用的。需要手动指定变量为全局变量</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* global MONITOR_IP:true */</span></span><br></pre></td></tr></table></figure></li></ol><h3 id="简单基于-token-的身份认证"><a href="#简单基于-token-的身份认证" class="headerlink" title="简单基于 token 的身份认证"></a>简单基于 token 的身份认证</h3><ol><li><p>页面跳转时，判断 localStorage 是否有 token，有则 next(),没有跳转到登陆</p></li><li><p>本应用使用 cas 单点登录方式，所以跳转到 cas 登陆页面</p></li><li><p>登陆成功自动跳转到应用的登陆页面，登陆应用获取 token</p></li><li><p>获取 token 后，把 token 放到 localStorage</p></li><li><p>然后跳转到首页</p></li><li><p>配置 axios 请求拦截器，如果 localStorage 里有 token 则在头部加入 Authorization</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">http.<span class="property">interceptors</span>.<span class="property">request</span>.<span class="title function_">use</span>(<span class="function"><span class="params">config</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">if</span> (<span class="variable language_">localStorage</span>.<span class="property">token</span>) &#123;</span><br><span class="line">    config.<span class="property">headers</span> = &#123;</span><br><span class="line">      <span class="title class_">Authorization</span>: <span class="string">`Bearer <span class="subst">$&#123;<span class="variable language_">localStorage</span>.token&#125;</span>`</span>,</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> config;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>​</p></li></ol>]]></content>
      
      
      <categories>
          
          <category> 前端开发 </category>
          
          <category> Vue.js </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Node.js </tag>
            
            <tag> Vue </tag>
            
            <tag> 前端开发 </tag>
            
            <tag> webpack </tag>
            
            <tag> VSCode </tag>
            
            <tag> 开发环境 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>解决Electron应用中Autobahn.js环境检测问题</title>
      <link href="/2018/03/07/electron%20%E4%B8%AD%E4%BD%BF%E7%94%A8autobahn%20%E4%B8%8D%E5%B7%A5%E4%BD%9C%E9%97%AE%E9%A2%98%E8%AE%B0%E5%BD%95-electron%E4%B8%AD%E4%BD%BF%E7%94%A8autobahn%E4%B8%8D%E5%B7%A5%E4%BD%9C%E9%97%AE%E9%A2%98%E8%AE%B0%E5%BD%95/"/>
      <url>/2018/03/07/electron%20%E4%B8%AD%E4%BD%BF%E7%94%A8autobahn%20%E4%B8%8D%E5%B7%A5%E4%BD%9C%E9%97%AE%E9%A2%98%E8%AE%B0%E5%BD%95-electron%E4%B8%AD%E4%BD%BF%E7%94%A8autobahn%E4%B8%8D%E5%B7%A5%E4%BD%9C%E9%97%AE%E9%A2%98%E8%AE%B0%E5%BD%95/</url>
      
        <content type="html"><![CDATA[<p>在 authbahn 源代码中<br><a href="https://github.com/crossbario/autobahn-js/blob/79b093bf47f6ff3e2fd50f42fce20578150baaf9/lib/transport/websocket.js#L81">if (global.process &amp;&amp; global.process.versions.node) {</a><br>判断当前的运行环境为 node 环境，但实际上 electron 中使用的还是 web。<br>所以暂时删除掉判断，直接进入 else，为浏览器环境。<br>目前可以正常运行，不知道以后会不会出现其他问题。</p>]]></content>
      
      
      <categories>
          
          <category> 桌面应用开发 </category>
          
          <category> 问题解决方案 </category>
          
          <category> Electron开发 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> JavaScript </tag>
            
            <tag> Electron </tag>
            
            <tag> Autobahn.js </tag>
            
            <tag> WebSocket </tag>
            
            <tag> 环境检测 </tag>
            
            <tag> 调试技巧 </tag>
            
            <tag> 源码分析 </tag>
            
            <tag> 兼容性问题 </tag>
            
            <tag> 开发经验 </tag>
            
            <tag> 问题修复 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Chrome浏览器绿色版制作：从下载到打包的详细步骤</title>
      <link href="/2018/02/25/%E7%BB%BF%E8%89%B2%E7%89%88chrome%E5%AE%89%E8%A3%85%E5%8C%85%E5%88%B6%E4%BD%9C%E6%95%99%E7%A8%8B-%E7%BB%BF%E8%89%B2%E7%89%88chrome%E5%AE%89%E8%A3%85%E5%8C%85%E5%88%B6%E4%BD%9C%E6%95%99%E7%A8%8B/"/>
      <url>/2018/02/25/%E7%BB%BF%E8%89%B2%E7%89%88chrome%E5%AE%89%E8%A3%85%E5%8C%85%E5%88%B6%E4%BD%9C%E6%95%99%E7%A8%8B-%E7%BB%BF%E8%89%B2%E7%89%88chrome%E5%AE%89%E8%A3%85%E5%8C%85%E5%88%B6%E4%BD%9C%E6%95%99%E7%A8%8B/</url>
      
        <content type="html"><![CDATA[<h2 id="教程"><a href="#教程" class="headerlink" title="教程"></a>教程</h2><ul><li>Google Chrome 下载地址<a href="https://api.shuax.com/tools/getchrome">https://api.shuax.com/tools/getchrome</a></li><li>插件下载<a href="https://shuax.com/portfolio/greenchrome/">https://shuax.com/portfolio/greenchrome/</a></li><li>便携化教程 <a href="https://bbs.kafan.cn/thread-1696230-1-1.html">https://bbs.kafan.cn/thread-1696230-1-1.html</a></li><li>安装包制作工具 <a href="http://www.jz5u.com/Soft/apply/other/170453.html">http://www.jz5u.com/Soft/apply/other/170453.html</a></li><li>安装包制作教程 <a href="https://www.cnblogs.com/wuhuacong/p/6101853.html">https://www.cnblogs.com/wuhuacong/p/6101853.html</a><span id="more"></span></li></ul><h3 id="制作绿色版-Chrome"><a href="#制作绿色版-Chrome" class="headerlink" title="制作绿色版 Chrome"></a>制作绿色版 Chrome</h3><ol><li>下载 google Chrome 离线安装包</li><li>解压该安装包.exe，再解压.7z 得到 chrome-bin</li><li>修改文件夹名称为 Chrome</li><li>下载插件 得到 greenChrome ,解压。</li><li>把文件夹内的 GreenChrome.ini 和 winmm.dll 一块放在 Chrome 文件夹下。（自行选择 64 位或 32 位与第一步下载的离线安装包对应。已经下载好的是 64 位 Chrome 安装包）</li><li>把文件夹内的 favicon.ico 复制到 Chrome</li><li>打开 Chrome 文件夹下的 chrome.exe 文件</li></ol><h3 id="设置首页"><a href="#设置首页" class="headerlink" title="设置首页"></a>设置首页</h3><ol><li>在 chrome 内，点击右上角三个点，再点设置</li><li>拖到最下边，选择<code>打开特定网页或一组网页</code></li><li>点击添加新网页</li><li>输入想要打开的网址</li><li>点击确定完成</li></ol><h3 id="安装-setupfactory"><a href="#安装-setupfactory" class="headerlink" title="安装 setupfactory"></a>安装 setupfactory</h3><ol><li>安装 Setup Factory v9.1 英文原版.exe</li><li>注册码 SUF-BMDP-F2NS-GN82-FS3J</li><li>安装完成后。在桌面打开 Setup Factory</li><li>创建一个新 project</li><li>输入公司名&#x2F;标题&#x2F;版本号&#x2F;公司网址 下一步</li><li>选择 64-bit 下一步</li><li>选择 Chrome 文件夹 下一步</li><li>选择样式 ，随意， 下一步</li><li>选择样式，随意，下一步</li><li>找到 Chinese(Simplified)并选择。下一步</li><li>不用选，下一步</li><li>再点击完成</li></ol><h3 id="制作安装包"><a href="#制作安装包" class="headerlink" title="制作安装包"></a>制作安装包</h3><ol><li>在软件界面，选择 chrome.exe 右键，选择 file properties</li><li>选择 Shortcuts 选项卡</li><li><img src="https://i.loli.net/2018/10/26/5bd26396688d5.png"></li><li>Icon 部分，点击 Custom 点击 Browse 选择 <code>%AppFolder%\favicon.ico</code></li><li>点击确定</li><li>点击菜单 publish，点击 build,会弹出一个框，直接点 next</li><li>然后点击 Browser 选择桌面</li><li>输入文件名称 （安装包名称）</li><li>点击 next 等几分钟后。</li><li>build 完成后点击完成。在桌面就会出现一个安装包文件。双击就可以安装了。</li></ol>]]></content>
      
      
      <categories>
          
          <category> 软件教程 </category>
          
          <category> 浏览器定制 </category>
          
          <category> 工具分享 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Chrome浏览器 </tag>
            
            <tag> 绿色软件 </tag>
            
            <tag> 便携版 </tag>
            
            <tag> Setup Factory </tag>
            
            <tag> 软件打包 </tag>
            
            <tag> 浏览器定制 </tag>
            
            <tag> GreenChrome </tag>
            
            <tag> 软件安装 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>MQTT和WAMP协议：物联网通信技术对比与实践应用</title>
      <link href="/2017/10/23/%E7%89%A9%E8%81%94%E7%BD%91%E9%80%9A%E4%BF%A1%E5%8D%8F%E8%AE%AEMQTT%E5%92%8CWAMP/"/>
      <url>/2017/10/23/%E7%89%A9%E8%81%94%E7%BD%91%E9%80%9A%E4%BF%A1%E5%8D%8F%E8%AE%AEMQTT%E5%92%8CWAMP/</url>
      
        <content type="html"><![CDATA[<h3 id="物联网通信协议-MQTT-amp-WAMP"><a href="#物联网通信协议-MQTT-amp-WAMP" class="headerlink" title="物联网通信协议 MQTT&amp;WAMP"></a>物联网通信协议 MQTT&amp;WAMP</h3><h4 id="一、物联网层次结构"><a href="#一、物联网层次结构" class="headerlink" title="一、物联网层次结构"></a>一、物联网层次结构</h4><h5 id="1-百度云架构"><a href="#1-百度云架构" class="headerlink" title="1.百度云架构"></a>1.百度云架构</h5><p><img src="https://doc.bce.baidu.com/bce-documentation/IOT/overview_01.png" alt="百度云物联网架构"></p>  <span id="more"></span><h5 id="2-技术层架构"><a href="#2-技术层架构" class="headerlink" title="2.技术层架构"></a>2.技术层架构</h5><p><img src="https://timgsa.baidu.com/timg?image&quality=80&size=b9999_10000&sec=1539402648576&di=6ed421d80ee289e786668d22e8ea57b5&imgtype=jpg&src=http://img1.imgtn.bdimg.com/it/u=1948897941,3581956780&fm=214&gp=0.jpg" alt="硬件技术层通信架构"></p><p>百度云、腾讯云、阿里云和其他物联网云厂商等，基本完全支持：MQTT+HTTP+WEBSOCKET+CoAP</p><h4 id="二、MQTT：http-mqtt-org"><a href="#二、MQTT：http-mqtt-org" class="headerlink" title="二、MQTT：http://mqtt.org/"></a>二、MQTT：<a href="http://mqtt.org/">http://mqtt.org/</a></h4><ol><li><p><a href="https://www.jianshu.com/p/a7599ae21d4a">MQTT 是什么</a></p></li><li><p><a href="https://www.jianshu.com/p/d726663efaa9">应用场景</a></p></li><li><p>如何实现 MQTT 应用实例：<br><a href="https://github.com/mqtt/mqtt.github.io/wiki/servers">安装 mqtt 服务</a>：常用的 Rabbitmq 开启 mqtt 服务；安装 emqtt；</p><p><a href="https://blog.csdn.net/swedenfeng/article/details/53510048">使用 MQTT 测试客户端进行简单测试</a></p><p>自己动手编程，实现 mqtt 收发</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">recv1:mosquitto_sub -h localhost -u wugeek -P 111111 -t &quot;xingtai&quot;</span><br><span class="line">recv2:mosquitto_sub -h localhost -u wugeek -P 111111 -t &quot;handan&quot;</span><br><span class="line"></span><br><span class="line">send:</span><br><span class="line">mosquitto_pub -h localhost -u wugeek -P 111111 -t &quot;xingtai&quot; -m &quot;hello邢台&quot;</span><br><span class="line"></span><br><span class="line">mosquitto_pub -h localhost -u wugeek -P 111111 -t &quot;xingtai&quot; -m &quot;邯郸天气真冷&quot;</span><br></pre></td></tr></table></figure></li><li><p>总结：想要深入学习 mqtt，直接看官方的 mqtt 协议！看懂协议，就明白代码为什么这么写!</p></li></ol><h4 id="三、WAMP：https-crossbar-io"><a href="#三、WAMP：https-crossbar-io" class="headerlink" title="三、WAMP：https://crossbar.io/"></a>三、WAMP：<a href="https://crossbar.io/">https://crossbar.io/</a></h4><p>1.<a href="https://wamp-proto.org/">wamp 是什么</a></p><p>2.应用场景：ws，与 web 端双向实时消息传递;后台服务与前端页面实时通信</p><p>3.如何实现 wamp 应用实例：安装服务，写代码测试</p><p>4.总结：wamp(不是 Windows+Apache+Mysql+PHP,之前在国内没有看到相应的应用，比较新)</p><h4 id="四、mqtt-与-wamp-的区别"><a href="#四、mqtt-与-wamp-的区别" class="headerlink" title="四、mqtt 与 wamp 的区别"></a>四、mqtt 与 wamp 的区别</h4><p>mqtt：物联网硬件简单的通信协议，数据量小，通信代价小</p><p>wamp：后台服务与 web 端实现双向实时通信，使用 topic 方式进行订阅和发送简单方便</p><h4 id="五、硬件协议解析"><a href="#五、硬件协议解析" class="headerlink" title="五、硬件协议解析"></a>五、硬件协议解析</h4><p>1.单片机 MCU ：处理能力小，内存小，存储小 总之什么都小！</p><p>2.所以开发的时候尽量要使用最小的代价实现应用</p><p>3.发的、收的数据尽量小</p><p>json 格式应用在硬件通信上面好不好?</p>]]></content>
      
      
      <categories>
          
          <category> 物联网技术 </category>
          
          <category> 通信协议 </category>
          
          <category> 系统架构 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> WebSocket </tag>
            
            <tag> MQTT </tag>
            
            <tag> WAMP </tag>
            
            <tag> 物联网 </tag>
            
            <tag> 通信协议 </tag>
            
            <tag> 云平台 </tag>
            
            <tag> 实时通信 </tag>
            
            <tag> 硬件开发 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>现代前端技术栈与AngularJS开发实践</title>
      <link href="/2017/06/03/%E5%89%8D%E7%AB%AF%E6%8A%80%E6%9C%AF%E5%92%8Cangularjs-%E5%89%8D%E7%AB%AF%E6%8A%80%E6%9C%AF%E5%92%8Cangularjs/"/>
      <url>/2017/06/03/%E5%89%8D%E7%AB%AF%E6%8A%80%E6%9C%AF%E5%92%8Cangularjs-%E5%89%8D%E7%AB%AF%E6%8A%80%E6%9C%AF%E5%92%8Cangularjs/</url>
      
        <content type="html"><![CDATA[<h3 id="前端技术栈"><a href="#前端技术栈" class="headerlink" title="前端技术栈"></a>前端技术栈</h3><ul><li><p>浏览器&#x2F;渲染引擎</p><ul><li>IE</li><li>chrome</li><li>firefox</li><li>Safari</li><li>QQ&#x2F;360???????<span id="more"></span></li></ul></li><li><p>前端核心</p><ul><li><p>HTML&#x2F;HTML5,</p><p><img src="https://img.mubu.com/document_image/09890fbd-d90f-4a86-83a6-9a9190baeeea.jpg" alt="img"></p><ul><li>DOM 树</li><li>元素</li><li>属性</li></ul></li><li><p>JavaScript</p><ul><li>原型（prototype）</li><li>Scope</li><li>JSON <a href="https://baike.baidu.com/item/JSON/2462549?fr=aladdin">https://baike.baidu.com/item/JSON/2462549?fr=aladdin</a></li><li>AJAX</li><li>Promise(解决回调函数嵌套过多的问题)<ul><li><a href="http://callbackhell.com/">http://callbackhell.com/</a></li><li><a href="http://liubin.org/promises-book/">http://liubin.org/promises-book/</a></li></ul></li></ul></li><li><p>CSS</p><ul><li>使用浏览器调试样式</li></ul></li></ul></li><li><p>编辑器</p><ul><li>sublime text 3</li><li>WebStorm</li><li>VSCode（推荐！！）</li></ul></li><li><p>构建工具&#x2F;生成器</p><p><img src="https://img.mubu.com/document_image/4c09e92d-1472-4bd1-983a-c8f076c85d5a.jpg" alt="img"></p><ul><li>Yeoman <a href="http://yeoman.io/generators/">http://yeoman.io/generators/</a></li><li>Grunt</li><li>gulp&#x2F;&#x2F;在用</li><li>webpack&#x2F;&#x2F;在用</li></ul></li><li><p>调试</p><ul><li>Developer Tools</li><li>Firebug</li></ul></li><li><p>包管理</p><ul><li>npm</li><li>bower</li></ul></li><li><p>框架和库</p><ul><li>JavaScript 基本库<ul><li>Jquery</li></ul></li><li>JavaScript 框架<ul><li>angularjs&#x2F;Angular</li><li>react</li><li>vue</li></ul></li><li>UI 框架<ul><li>BootStrap</li><li>ionic</li><li>Material</li></ul></li><li>数据可视化<ul><li>Echarts</li><li>G2</li></ul></li><li>CSS3 动画<ul><li>Animate.css</li></ul></li><li>实用工具<ul><li>lodash <a href="https://lodash.com/">https://lodash.com/</a><a href="https://www.kancloud.cn/wizardforcel/lodash-doc-45/144108">https://www.kancloud.cn/wizardforcel/lodash-doc-45/144108</a></li><li>Moment <a href="http://momentjs.cn/">http://momentjs.cn/</a></li></ul></li><li>编译器<ul><li>babel <a href="http://babeljs.cn/repl/#">http://babeljs.cn/repl/#</a></li></ul></li><li>模板引擎<ul><li>Jade-express</li><li>Ejs-thinkjs</li></ul></li><li>中间语言<ul><li>Typescript</li><li>JSX</li></ul></li><li>手机应用<ul><li>Cordova</li><li>React Native</li></ul></li><li>桌面应用<ul><li>Electron</li></ul></li></ul></li></ul><h3 id="angularjs"><a href="#angularjs" class="headerlink" title="angularjs"></a>angularjs</h3><ul><li><p>搭建一个最简单的 angular 项目</p></li><li><p>$scope、$rootScope、var</p><ul><li>$scope 是一个 js 对象，包含属性和方法，可以在视图中使用。作用域范围当前的 controller</li><li>$rootScope 根作用域，范围是被 ng-app 包含的所有 controller</li><li>var 定义变量关键词。var 的作用域取决于定义变量的位置。在 controller 里面用 var 定义的变量只在这个 controller 里面有效</li></ul></li><li><p><code>&amp;#123;&amp;#123;&amp;#125;&amp;#125;</code></p><ul><li>在<code>&amp;#123;&amp;#123;&amp;#125;&amp;#125;</code>里面是可以写 js 表达式的，而不仅仅是写一个变量。</li></ul></li><li><p>页面传参</p><ul><li>利用 ui-router 传参（常用）</li><li>$cacheFactory、service 或 factory、本地存储、全局变量</li></ul></li><li><p>错误（ReferenceError,SyntaxError,TypeError）</p><p><a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/ReferenceError">https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/ReferenceError</a></p><ul><li><p>HelloCtrl 没有注册</p><p><img src="https://img.mubu.com/document_image/f6f78e2a-edaf-4717-8cb3-5bd81a451b55.jpg" alt="img"></p></li><li><p>a 没有被定义</p><p><img src="https://img.mubu.com/document_image/362a3d98-b926-40cc-9b75-9363791ecf59.jpg" alt="img"></p></li><li><p>不能读取 undefined 的属性 d</p><p><img src="https://img.mubu.com/document_image/d25df15e-d055-44c5-ab2a-39afd68e472a.jpg" alt="img"></p></li><li><p>myApp.contoller 不是一个函数</p><p><img src="https://img.mubu.com/document_image/5798992a-432e-4eea-8423-05b64fd39778.jpg" alt="img"></p></li><li><p>语法错误</p><p><img src="https://img.mubu.com/document_image/90f7b0eb-21a0-44d6-b724-e4adaaf25b64.jpg" alt="img"></p></li></ul></li><li><p>angular 自带过滤器</p><ul><li>时间格式化<code>&amp;#123;&amp;#123;1502099966443| date:&quot;yyyy-MM-dd HH:mm:ss&quot;&amp;#125;&amp;#125;</code></li></ul></li><li><p>angular 常用的一些方法，指令等</p></li><li><p>http 请求的两种写法<a href="https://docs.angularjs.org/api/ng/service/$http">https://docs.angularjs.org/api/ng/service/$http</a><a href="https://code.angularjs.org/1.4.3/docs/api/ng/service/$http">https://code.angularjs.org/1.4.3/docs/api/ng/service/$http</a></p></li><li><p>angular select</p></li><li><p>常用插件</p><ul><li>smart-table <a href="https://github.com/lorenzofox3/Smart-Table">https://github.com/lorenzofox3/Smart-Table</a></li><li>ngDialog <a href="https://github.com/likeastore/ngDialog">https://github.com/likeastore/ngDialog</a></li><li>ui.bootstrap <a href="http://angular-ui.github.io/bootstrap/">http://angular-ui.github.io/bootstrap/</a></li><li>ngMaterial <a href="https://github.com/angular/material">https://github.com/angular/material</a></li><li>ng-file-upload <a href="https://github.com/danialfarid/ng-file-upload">https://github.com/danialfarid/ng-file-upload</a></li><li>toastr <a href="https://github.com/Foxandxss/angular-toastr">https://github.com/Foxandxss/angular-toastr</a></li><li>oc.lazyLoad <a href="https://oclazyload.readme.io/">https://oclazyload.readme.io/</a></li><li>satellizer <a href="https://github.com/sahat/satellizer">https://github.com/sahat/satellizer</a></li><li>vxWamp <a href="https://github.com/voryx/angular-wamp">https://github.com/voryx/angular-wamp</a></li></ul></li></ul><h3 id="我经常逛的网站"><a href="#我经常逛的网站" class="headerlink" title="我经常逛的网站"></a>我经常逛的网站</h3><ul><li>掘金 <a href="https://juejin.im/">https://juejin.im/</a></li><li>awesomes <a href="https://www.awesomes.cn/">https://www.awesomes.cn/</a></li></ul>]]></content>
      
      
      <categories>
          
          <category> 前端开发 </category>
          
          <category> JavaScript框架 </category>
          
          <category> Web技术 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> JavaScript </tag>
            
            <tag> CSS3 </tag>
            
            <tag> AngularJS </tag>
            
            <tag> 前端技术栈 </tag>
            
            <tag> HTML5 </tag>
            
            <tag> 构建工具 </tag>
            
            <tag> 开发框架 </tag>
            
            <tag> 调试工具 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>React Native vs Ionic 移动应用开发对比与实践</title>
      <link href="/2017/05/05/React%20Native%20%E7%AE%80%E4%BB%8B-reactnative%E7%AE%80%E4%BB%8B/"/>
      <url>/2017/05/05/React%20Native%20%E7%AE%80%E4%BB%8B-reactnative%E7%AE%80%E4%BB%8B/</url>
      
        <content type="html"><![CDATA[<h1 id="react-native-开发-IOS-手机应用基本方法及其与-IONIC-开发的对比"><a href="#react-native-开发-IOS-手机应用基本方法及其与-IONIC-开发的对比" class="headerlink" title="react native 开发 IOS 手机应用基本方法及其与 IONIC 开发的对比"></a>react native 开发 IOS 手机应用基本方法及其与 IONIC 开发的对比</h1><h2 id="1-react-native-介绍"><a href="#1-react-native-介绍" class="headerlink" title="1. react-native 介绍"></a>1. react-native 介绍</h2><p>react-native 是一款基于 js 框架 React.js 来开发 IOS 和 Android 原生 App 的开源框架，</p><p>Learn once,write anywhere</p>  <span id="more"></span><ul><li><p>NR 和 react.js 关系</p><p>RN 和 react.js 公用一些抽象层，比如语法标签等，但还是有许多差异，而且目标平台不同。</p></li><li><p>案例：<a href="http://reactnative.cn/cases.html">http://reactnative.cn/cases.html</a></p></li><li><p>ionic 与 RN：ionic 是 webview，NR 是以 js 方式开发的原生应用</p></li></ul><h2 id="2-搭建开发环境"><a href="#2-搭建开发环境" class="headerlink" title="2. 搭建开发环境"></a>2. 搭建开发环境</h2><p>macOS &#x3D;&gt;iOS</p><ul><li><p>安装 Homebrew&#x3D;&#x3D;dpkg</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/usr/bin/ruby -e &quot;$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/master/install)&quot;</span><br></pre></td></tr></table></figure></li><li><p>安装 node</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">brew install node</span><br></pre></td></tr></table></figure></li><li><p>安装 yarn</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install -g yarn</span><br></pre></td></tr></table></figure></li><li><p>安装 react-native-cli</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install -g react-native-cli</span><br></pre></td></tr></table></figure></li><li><p>安装 Xcode</p><p>App Store 下载</p></li><li><p>安装 Watchman（非必需）(监视文件系统变更)</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">brew install watchman</span><br></pre></td></tr></table></figure><p>​</p></li></ul><h2 id="3-Hello-World"><a href="#3-Hello-World" class="headerlink" title="3. Hello World"></a>3. Hello World</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">react-native init myapp</span><br><span class="line">cd myapp</span><br><span class="line">react-native run-ios</span><br></pre></td></tr></table></figure><p>packager</p><p><img src="http://i1.piimg.com/567571/6a6e6c2842de1261.png"><img src="http://p1.bpimg.com/567571/bc237af092afadf1.png"></p><p>修改 index.ios.js 文件</p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; <span class="title class_">Component</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">AppRegistry</span>, <span class="title class_">Text</span> ,<span class="title class_">View</span>&#125; <span class="keyword">from</span> <span class="string">&#x27;react-native&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">MyApp</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Component</span> &#123;</span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">View</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">Text</span>&gt;</span>Hello world!&#123;this.props.sss&#125;<span class="tag">&lt;/<span class="name">Text</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">View</span>&gt;</span></span></span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="title class_">AppRegistry</span>.<span class="title function_">registerComponent</span>(<span class="string">&#x27;myapp&#x27;</span>, <span class="function">() =&gt;</span> <span class="title class_">MyApp</span>);</span><br></pre></td></tr></table></figure><h2 id="4-ES6-语法-ECMAScript6"><a href="#4-ES6-语法-ECMAScript6" class="headerlink" title="4. ES6 语法(ECMAScript6)"></a>4. ES6 语法(ECMAScript6)</h2><h4 id="ES-与-JS-的关系"><a href="#ES-与-JS-的关系" class="headerlink" title="ES 与 JS 的关系"></a>ES 与 JS 的关系</h4><p>ES 是标准</p><p>JS 是实现</p><h4 id="常用："><a href="#常用：" class="headerlink" title="常用："></a>常用：</h4><p>let 和 const</p><ul><li><p>let 用来声明变量。只在所在的代码块内有效。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//不存在变量提升</span></span><br><span class="line"><span class="comment">// var 的情况</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(foo); <span class="comment">// 输出undefined</span></span><br><span class="line"><span class="keyword">var</span> foo = <span class="number">2</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// let 的情况</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(bar); <span class="comment">// 报错ReferenceError</span></span><br><span class="line"><span class="keyword">let</span> bar = <span class="number">2</span>;</span><br></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//暂时性死区</span></span><br><span class="line"><span class="keyword">var</span> tmp = <span class="number">123</span>;</span><br><span class="line"><span class="keyword">if</span> (<span class="literal">true</span>) &#123;</span><br><span class="line">  tmp = <span class="string">&quot;abc&quot;</span>; <span class="comment">//报错</span></span><br><span class="line">  <span class="keyword">let</span> tmp;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 报错</span></span><br><span class="line"><span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">let</span> a = <span class="number">10</span>;</span><br><span class="line">  <span class="keyword">var</span> a = <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 报错</span></span><br><span class="line"><span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">let</span> a = <span class="number">10</span>;</span><br><span class="line">  <span class="keyword">let</span> a = <span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>​</p></li><li><p>const 定义常量</p></li></ul><p>模版字符串&#96;&#96;（反引号）</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//之前定义html字符串</span></span><br><span class="line">$(<span class="string">&quot;#result&quot;</span>).<span class="title function_">append</span>(<span class="string">&quot;There are &lt;b&gt;&quot;</span> + basket.<span class="property">count</span> + <span class="string">&quot;&lt;/b&gt; &quot;</span> + <span class="string">&quot;items in your basket, &quot;</span> + <span class="string">&quot;&lt;em&gt;&quot;</span> + basket.<span class="property">onSale</span> + <span class="string">&quot;&lt;/em&gt; are on sale!&quot;</span>);</span><br><span class="line"><span class="comment">//使用模版字符串，在字符串中可以嵌入变量</span></span><br><span class="line">$(<span class="string">&quot;#result&quot;</span>).<span class="title function_">append</span>(<span class="string">`</span></span><br><span class="line"><span class="string">  There are &lt;b&gt;<span class="subst">$&#123;basket.count&#125;</span>&lt;/b&gt; items</span></span><br><span class="line"><span class="string">   in your basket, &lt;em&gt;<span class="subst">$&#123;basket.onSale&#125;</span>&lt;/em&gt;</span></span><br><span class="line"><span class="string">  are on sale!</span></span><br><span class="line"><span class="string">`</span>);</span><br><span class="line"><span class="comment">//可以调用函数</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">fn</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="string">&quot;Hello World&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="string">`foo <span class="subst">$&#123;fn()&#125;</span> bar`</span>; <span class="comment">// foo Hello World bar</span></span><br></pre></td></tr></table></figure><p>遍历器：为不同的数据结构提供统一的访问机制。</p><p>​ 任何数据结构只要部署 Iterator 接口，都可以被遍历（Array，Object，Map，Set）</p><p>​ for … of …循环</p><p>引入了类 class 关键词</p><p>Module（模块）常用！！</p><p>react native 必须用的</p><ul><li><p>import ( ) from ()&#x2F;export</p></li><li><p>class () extends ()</p></li><li><p>(Data)&#x3D;&gt;{</p></li><li><p>}</p></li><li><p>function(data){</p></li><li><p>}</p></li><li><p>…（扩展运算符）</p><p>扩展语法允许在需要多个参数（用于函数调用）或多个元素（用于数组文本）或多个变量（用于解构分配）的位置扩展表达式。<a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Operators/Spread_operator">https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Operators/Spread_operator</a></p></li></ul><p>浏览器不支持？Babel 转码器</p><h2 id="5-JSX-语法"><a href="#5-JSX-语法" class="headerlink" title="5. JSX 语法"></a>5. JSX 语法</h2><p>将 xml 结构的语法嵌入到 js 中</p><p>React 的核心机制之一就是可以在内存中创建虚拟 DOM 元素。React 利用虚拟 DOM 来减少对实际 DOM 的操作从而提升性能</p><p>JSX 就是将 Javascript 和 XML 结合的一种格式。React 发明了 JSX，利用 HTML 语法来创建 DOM。</p><p>当遇到&lt;时，jsx 就当 html 解析</p><p>当遇到{时，jsx 就当 javascript 解析</p><p>react 与 angularjs 的最大的区别</p><ul><li>增强 html</li><li>增强 js</li></ul><p>解释上边的 hello world</p><ul><li>引入 react 和 react-native 基础包</li><li>定义一个组件（类）</li><li>渲染方法 render()</li><li>返回 jsx 语句</li><li>使用 AppRegistry 将 MyApp 注册到应用中（根容器）</li></ul><h2 id="6-Flex-布局"><a href="#6-Flex-布局" class="headerlink" title="6. Flex 布局"></a>6. Flex 布局</h2><p>基本的样式属性</p><ul><li>flexDirection：row,row-reverse,column,column-reverse</li><li>justifyContent：flex-start,center,flex-end,space-around,space-between</li><li>alignItems：flex-start,center,flex-end,stretch</li><li>flexWrap：wrap,nowrap</li></ul><h2 id="7-网络请求"><a href="#7-网络请求" class="headerlink" title="7. 网络请求"></a>7. 网络请求</h2><h4 id="ajax-方式："><a href="#ajax-方式：" class="headerlink" title="ajax 方式："></a>ajax 方式：</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> xhr = <span class="keyword">new</span> <span class="title class_">XMLHttpRequest</span>();</span><br><span class="line">xhr.<span class="title function_">open</span>(<span class="string">&quot;GET&quot;</span>, url);</span><br><span class="line">xhr.<span class="property">responseType</span> = <span class="string">&quot;json&quot;</span>;</span><br><span class="line">xhr.<span class="property">onload</span> = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(xhr.<span class="property">response</span>);</span><br><span class="line">&#125;;</span><br><span class="line">xhr.<span class="property">onerror</span> = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;Oops, error&quot;</span>);</span><br><span class="line">&#125;;</span><br><span class="line">xhr.<span class="title function_">send</span>();</span><br></pre></td></tr></table></figure><h4 id="angularjs-方式："><a href="#angularjs-方式：" class="headerlink" title="angularjs 方式："></a>angularjs 方式：</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">$http</span><br><span class="line">  .<span class="title function_">get</span>(url)</span><br><span class="line">  .<span class="title function_">success</span>(<span class="keyword">function</span> (<span class="params">data</span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(data);</span><br><span class="line">  &#125;)</span><br><span class="line">  .<span class="title function_">error</span>(<span class="keyword">function</span> (<span class="params">err</span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(err);</span><br><span class="line">  &#125;);</span><br></pre></td></tr></table></figure><h4 id="Fetch-方式"><a href="#Fetch-方式" class="headerlink" title="Fetch 方式"></a>Fetch 方式</h4><ul><li>箭头函数</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">fetch</span>(url)</span><br><span class="line">  .<span class="title function_">then</span>(<span class="function"><span class="params">response</span> =&gt;</span> response.<span class="title function_">json</span>())</span><br><span class="line">  .<span class="title function_">then</span>(<span class="function"><span class="params">data</span> =&gt;</span> <span class="variable language_">console</span>.<span class="title function_">log</span>(data))</span><br><span class="line">  .<span class="title function_">catch</span>(<span class="function"><span class="params">e</span> =&gt;</span> <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;Oops, error&quot;</span>, e));</span><br></pre></td></tr></table></figure><ul><li>普通回调</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">fetch</span>(url)</span><br><span class="line">  .<span class="title function_">then</span>(<span class="keyword">function</span> (<span class="params">response</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> response.<span class="title function_">json</span>();</span><br><span class="line">  &#125;)</span><br><span class="line">  .<span class="title function_">then</span>(<span class="keyword">function</span> (<span class="params">data</span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(data);</span><br><span class="line">  &#125;)</span><br><span class="line">  .<span class="title function_">catch</span>(<span class="keyword">function</span> (<span class="params">e</span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;Oops, error&quot;</span>);</span><br><span class="line">  &#125;);</span><br></pre></td></tr></table></figure><ul><li>async&#x2F;await 终极优化</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">  <span class="keyword">let</span> response = <span class="keyword">await</span> <span class="title function_">fetch</span>(url);</span><br><span class="line">  <span class="keyword">let</span> data = response.<span class="title function_">json</span>();</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(data);</span><br><span class="line">&#125; <span class="keyword">catch</span> (e) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;Oops, error&quot;</span>, e);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 注：这段代码如果想运行，外面需要包一个 async function</span></span><br></pre></td></tr></table></figure><h2 id="8-react-native-基础知识"><a href="#8-react-native-基础知识" class="headerlink" title="8. react native 基础知识"></a>8. react native 基础知识</h2><h4 id="属性-props"><a href="#属性-props" class="headerlink" title="属性 props"></a>属性 props</h4><ul><li>一般使用在自定义组件中,用来提高自定义组件的可复用性</li><li>在父组件中指定，在组件的生命周期中不会改变</li></ul><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; <span class="title class_">Component</span> &#125; <span class="keyword">from</span> <span class="string">&quot;react&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">AppRegistry</span>, <span class="title class_">Text</span>, <span class="title class_">View</span> &#125; <span class="keyword">from</span> <span class="string">&quot;react-native&quot;</span>;</span><br><span class="line"><span class="comment">//自定义组件</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Greeting</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Component</span> &#123;</span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">Text</span>&gt;</span>Hello &#123;this.props.hh&#125;!<span class="tag">&lt;/<span class="name">Text</span>&gt;</span></span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">LotsOfGreetings</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Component</span> &#123;</span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">View</span> <span class="attr">style</span>=<span class="string">&#123;&#123;</span> <span class="attr">alignItems:</span> &quot;<span class="attr">center</span>&quot; &#125;&#125;&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">Greeting</span> <span class="attr">name</span>=<span class="string">&quot;Rexxar&quot;</span> <span class="attr">hh</span>=<span class="string">&quot;asd&quot;</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">Greeting</span> <span class="attr">name</span>=<span class="string">&quot;Jaina&quot;</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">Greeting</span> <span class="attr">name</span>=<span class="string">&quot;Valeera&quot;</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">View</span>&gt;</span></span></span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="title class_">AppRegistry</span>.<span class="title function_">registerComponent</span>(<span class="string">&quot;LotsOfGreetings&quot;</span>, <span class="function">() =&gt;</span> <span class="title class_">LotsOfGreetings</span>);</span><br></pre></td></tr></table></figure><h4 id="状态-state"><a href="#状态-state" class="headerlink" title="状态 state"></a>状态 state</h4><ul><li>组件内部存在需要改变的数据，或者组件存在不同状态信息</li><li>在 constructor()中初始化 state，改变状态时需要调用 setState 方法</li></ul><h4 id="组件生命周期"><a href="#组件生命周期" class="headerlink" title="组件生命周期"></a>组件生命周期</h4><ul><li>图解</li></ul><p><img src="http://img.blog.csdn.net/20160703034722480" alt="http://img.blog.csdn.net/20160703034722480"></p><h4 id="处理文本输入"><a href="#处理文本输入" class="headerlink" title="处理文本输入"></a>处理文本输入</h4><ul><li><p>TextInput 组件 有一个 onChangeText 的属性。(状态)</p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; <span class="title class_">Component</span> &#125; <span class="keyword">from</span> <span class="string">&quot;react&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">AppRegistry</span>, <span class="title class_">Text</span>, <span class="title class_">TextInput</span>, <span class="title class_">View</span> &#125; <span class="keyword">from</span> <span class="string">&quot;react-native&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">PizzaTranslator</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Component</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params">props</span>) &#123;</span><br><span class="line">    <span class="variable language_">super</span>(props);</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">state</span> = &#123; <span class="attr">text</span>: <span class="string">&quot;&quot;</span> &#125;;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">View</span> <span class="attr">style</span>=<span class="string">&#123;&#123;</span> <span class="attr">padding:</span> <span class="attr">10</span> &#125;&#125;&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">TextInput</span> <span class="attr">style</span>=<span class="string">&#123;&#123;</span> <span class="attr">height:</span> <span class="attr">40</span> &#125;&#125; <span class="attr">placeholder</span>=<span class="string">&quot;Type here to translate!&quot;</span> <span class="attr">onChangeText</span>=<span class="string">&#123;text</span> =&gt;</span> this.setState(&#123; text &#125;)&#125; /&gt;</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">Text</span>&gt;</span>&#123;this.state.text&#125;<span class="tag">&lt;/<span class="name">Text</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">View</span>&gt;</span></span></span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="title class_">AppRegistry</span>.<span class="title function_">registerComponent</span>(<span class="string">&quot;PizzaTranslator&quot;</span>, <span class="function">() =&gt;</span> <span class="title class_">PizzaTranslator</span>);</span><br></pre></td></tr></table></figure></li></ul><h2 id="9-ionic-简单介绍"><a href="#9-ionic-简单介绍" class="headerlink" title="9. ionic 简单介绍"></a>9. ionic 简单介绍</h2><p>​ 官网介绍：**<em>The top open source framework for building amazing mobile apps.</em>**</p><p>####1. 主要技术</p><ul><li>HTML5</li><li>JavaScript</li><li>Angularjs</li><li>Cordova</li><li>Sass</li><li>Typescript（ionic2）</li></ul><p>####2. 特点</p><ul><li>使用 Javascript MVVM 框架和 Angularjs 来构建应用</li><li>双向绑定</li><li>web 思维</li><li>跨平台</li></ul><h2 id="10-react-native-与-ionic-对比"><a href="#10-react-native-与-ionic-对比" class="headerlink" title="10.react native 与 ionic 对比"></a>10.react native 与 ionic 对比</h2><h4 id="1-跨平台特性"><a href="#1-跨平台特性" class="headerlink" title="1. 跨平台特性"></a>1. 跨平台特性</h4><p>​ ionic：write once，run anywhere</p><p>​ react native：learn once, write anywhere</p><h4 id="2-学习曲线"><a href="#2-学习曲线" class="headerlink" title="2. 学习曲线"></a>2. 学习曲线</h4><p>​ ionic: 只需要会 html css js 既可</p><p>​ react native ：只需要 js 既可 😄，当然不是普通的 js</p><h4 id="3-功能"><a href="#3-功能" class="headerlink" title="3. 功能"></a>3. 功能</h4><p>​ 两种方式都基本实现了所有的 native 原生 api，不过可能需要自己写代码。。。</p><h4 id="4-性能"><a href="#4-性能" class="headerlink" title="4. 性能"></a>4. 性能</h4><p>​ ionic：在 ios 上基本无法区分是否原生 app</p><p>​ android 上需要使用 ionic-native-transitions 插件调用原生组件，性能略差</p><p>​ 对于配置低的 android，添加 crosswalk 插件后，体验有所提升，打包偏大</p><p>​ react native： 基本接近原生 app</p><h4 id="5-总结"><a href="#5-总结" class="headerlink" title="5. 总结"></a>5. 总结</h4><h5 id="ionic-："><a href="#ionic-：" class="headerlink" title="ionic ："></a>ionic ：</h5><p>优势： ios 和 android 基本上可以共用代码，纯 web 思维</p><p>​ 文档很全，系统级支持封装较好，所有 UI 组件都是有 html 模拟，可以统一使用。</p><p>​ 可实现在线更新 允许加载动态加载 web js</p><p>​ 技术成熟</p><p>劣势：</p><p>​ 占用内存高一些，动画不自然，用户体验较差。</p><h5 id="react-native-："><a href="#react-native-：" class="headerlink" title="react-native ："></a>react-native ：</h5><p>优势</p><p>​ 1、使用 js 进行开发。用户体验，高于 html，开发效率较高</p><p>​ 2、flexbox 布局 据说比 native 的自适应布局更加简单高效 可实现在线更新</p><p>​ 3、允许运行于 JavascriptCore 的动态加载代码 更贴近原生开发</p><p>劣势：</p><p>​ 对开发人员要求较高，不是懂点 web 技术就行的，当官方封装的控件、api 无法满足需求时 就必然需要懂一些 native 的东西去扩展，扩展性仍然远远不如 web，也远远不如直接写 Native code。</p><h2 id="11-写一个小应用"><a href="#11-写一个小应用" class="headerlink" title="11. 写一个小应用"></a>11. 写一个小应用</h2><h4 id="1-简单需求描述"><a href="#1-简单需求描述" class="headerlink" title="1. 简单需求描述"></a>1. 简单需求描述</h4><ul><li><p>要有文章列表</p><p><img src="http://i1.piimg.com/567571/04896860f59c4aca.png"></p></li><li><p>要有图片列表</p><p><img src="http://p1.bpimg.com/567571/63adc06835b318cf.png"></p></li><li><p>要有地图</p><p><img src="http://p1.bpimg.com/567571/135c6fb9e748fdcb.png"></p></li><li><p>三个功能，还需要 tab</p></li></ul><h4 id="2-准备阶段"><a href="#2-准备阶段" class="headerlink" title="2. 准备阶段"></a>2. 准备阶段</h4><ul><li><p>接口准备：</p><p>分类数据: <a href="http://gank.io/api/data/%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/%E8%AF%B7%E6%B1%82%E4%B8%AA%E6%95%B0/%E7%AC%AC%E5%87%A0%E9%A1%B5">http://gank.io/api/data/数据类型/请求个数/第几页</a></p><p>数据类型： 福利 | Android | iOS | 休息视频 | 拓展资源 | 前端 | all</p><p>请求个数： 数字，大于 0</p><p>第几页：数字，大于 0</p></li><li><p>功能所需插件准备：</p><pre><code>&quot;react-native-maps&quot;: &quot;0.13.0&quot;,//地图&quot;react-native-router-flux&quot;: &quot;^3.37.0&quot;,//路由&quot;react-native-vector-icons&quot;: &quot;^4.0.0&quot;//字体图标</code></pre></li><li><p>应用框架图</p><p><img src="http://p1.bpimg.com/567571/4428f3dd8b905115.png"></p></li></ul><h4 id="3-开发"><a href="#3-开发" class="headerlink" title="3.开发"></a>3.开发</h4><ul><li><p>新建项目 init</p></li><li><p>定义路由</p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">&lt;<span class="title class_">Router</span> onExitApp=&#123;<span class="variable language_">this</span>.<span class="property">_backAndroidHandler</span>&#125;&gt;</span><br><span class="line">                <span class="language-xml"><span class="tag">&lt;<span class="name">Scene</span> <span class="attr">key</span>=<span class="string">&quot;root&quot;</span> <span class="attr">hideNavBar</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                    <span class="tag">&lt;<span class="name">Scene</span> <span class="attr">key</span>=<span class="string">&quot;tabbar&quot;</span> <span class="attr">tabs</span> <span class="attr">tabBarStyle</span>=<span class="string">&#123;&#123;</span> <span class="attr">backgroundColor:</span> &#x27;#<span class="attr">FFF</span>&#x27;, <span class="attr">borderTopWidth:</span> <span class="attr">1</span>, <span class="attr">borderTopColor:</span> &#x27;#<span class="attr">BBB</span>&#x27; &#125;&#125;&gt;</span></span></span><br><span class="line"><span class="language-xml">                        <span class="tag">&lt;<span class="name">Scene</span> <span class="attr">key</span>=<span class="string">&quot;tab1&quot;</span> <span class="attr">initial</span> <span class="attr">title</span>=<span class="string">&quot;前端&quot;</span> <span class="attr">icon</span>=<span class="string">&#123;TabIcon&#125;</span> <span class="attr">tabIcon</span>=<span class="string">&quot;home&quot;</span> <span class="attr">navigationBarStyle</span>=<span class="string">&#123;&#123;</span> <span class="attr">backgroundColor:</span> &#x27;#<span class="attr">ffdb42</span>&#x27; &#125;&#125;&gt;</span></span></span><br><span class="line"><span class="language-xml">                            <span class="tag">&lt;<span class="name">Scene</span> <span class="attr">key</span>=<span class="string">&#x27;article&#x27;</span> <span class="attr">component</span>=<span class="string">&#123;Article&#125;</span> <span class="attr">title</span>=<span class="string">&#x27;Web Front-end&#x27;</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">                            <span class="tag">&lt;<span class="name">Scene</span> <span class="attr">key</span>=<span class="string">&#x27;articlecontent&#x27;</span> <span class="attr">component</span>=<span class="string">&#123;ArticleContent&#125;</span> <span class="attr">title</span>=<span class="string">&quot;content&quot;</span> <span class="attr">hideTabBar</span>/&gt;</span></span></span><br><span class="line"><span class="language-xml">                        <span class="tag">&lt;/<span class="name">Scene</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                        <span class="tag">&lt;<span class="name">Scene</span> <span class="attr">key</span>=<span class="string">&quot;tab2&quot;</span> <span class="attr">title</span>=<span class="string">&quot;妹纸&quot;</span> <span class="attr">icon</span>=<span class="string">&#123;TabIcon&#125;</span> <span class="attr">tabIcon</span>=<span class="string">&quot;venus&quot;</span> <span class="attr">navigationBarStyle</span>=<span class="string">&#123;&#123;</span> <span class="attr">backgroundColor:</span> &#x27;#<span class="attr">ffdb42</span>&#x27; &#125;&#125;&gt;</span></span></span><br><span class="line"><span class="language-xml">                            <span class="tag">&lt;<span class="name">Scene</span> <span class="attr">key</span>=<span class="string">&#x27;meizhi&#x27;</span> <span class="attr">component</span>=<span class="string">&#123;MeiZhi&#125;</span> <span class="attr">title</span>=<span class="string">&#x27;妹纸图&#x27;</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">                        <span class="tag">&lt;/<span class="name">Scene</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                         <span class="tag">&lt;<span class="name">Scene</span> <span class="attr">key</span>=<span class="string">&quot;tab3&quot;</span> <span class="attr">title</span>=<span class="string">&quot;地图&quot;</span> <span class="attr">icon</span>=<span class="string">&#123;TabIcon&#125;</span> <span class="attr">tabIcon</span>=<span class="string">&quot;map&quot;</span> <span class="attr">navigationBarStyle</span>=<span class="string">&#123;&#123;</span> <span class="attr">backgroundColor:</span> &#x27;#<span class="attr">ffdb42</span>&#x27; &#125;&#125;&gt;</span></span></span><br><span class="line"><span class="language-xml">                            <span class="tag">&lt;<span class="name">Scene</span> <span class="attr">key</span>=<span class="string">&#x27;maps&#x27;</span> <span class="attr">component</span>=<span class="string">&#123;Maps&#125;</span> <span class="attr">title</span>=<span class="string">&#x27;Maps&#x27;</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">                        <span class="tag">&lt;/<span class="name">Scene</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                        <span class="tag">&lt;<span class="name">Scene</span> <span class="attr">key</span>=<span class="string">&quot;tab4&quot;</span>  <span class="attr">title</span>=<span class="string">&quot;布局&quot;</span> <span class="attr">icon</span>=<span class="string">&#123;TabIcon&#125;</span> <span class="attr">tabIcon</span>=<span class="string">&quot;user-o&quot;</span> <span class="attr">navigationBarStyle</span>=<span class="string">&#123;&#123;</span> <span class="attr">backgroundColor:</span> &#x27;#<span class="attr">ffdb42</span>&#x27; &#125;&#125;&gt;</span></span></span><br><span class="line"><span class="language-xml">                            <span class="tag">&lt;<span class="name">Scene</span> <span class="attr">key</span>=<span class="string">&#x27;contacts&#x27;</span> <span class="attr">component</span>=<span class="string">&#123;Contacts&#125;</span> <span class="attr">title</span>=<span class="string">&#x27;flex布局&#x27;</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">                        <span class="tag">&lt;/<span class="name">Scene</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                    <span class="tag">&lt;/<span class="name">Scene</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                <span class="tag">&lt;/<span class="name">Scene</span>&gt;</span></span></span><br><span class="line">            &lt;/<span class="title class_">Router</span>&gt;</span><br></pre></td></tr></table></figure></li><li><p>开发文章列表页面</p></li><li><p>开发文章详情页面</p></li><li><p>开发图片列表页面</p></li><li><p>开发地图显示页面</p></li></ul><h4 id="4-优化"><a href="#4-优化" class="headerlink" title="4.优化"></a>4.优化</h4><ul><li>文章列表和图片列表的下拉刷新和上拉加载</li><li>点击图片显示大图</li></ul>]]></content>
      
      
      <categories>
          
          <category> 移动应用开发 </category>
          
          <category> 前端技术 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> JavaScript </tag>
            
            <tag> Android </tag>
            
            <tag> 移动开发 </tag>
            
            <tag> 跨平台开发 </tag>
            
            <tag> React Native </tag>
            
            <tag> Ionic </tag>
            
            <tag> iOS </tag>
            
            <tag> Mobile App Development </tag>
            
            <tag> Front-end Technology </tag>
            
            <tag> Cross-platform Framework </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>AngularJS和Ionic应用性能优化实践与技巧</title>
      <link href="/2017/01/18/angularjs%E5%92%8Cionic%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96%EF%BC%882%EF%BC%89-angularjs%E5%92%8Cionic%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%962/"/>
      <url>/2017/01/18/angularjs%E5%92%8Cionic%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96%EF%BC%882%EF%BC%89-angularjs%E5%92%8Cionic%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%962/</url>
      
        <content type="html"><![CDATA[<h1 id="angular-性能优化"><a href="#angular-性能优化" class="headerlink" title="angular 性能优化"></a>angular 性能优化</h1><ol><li><p>使用$watchCollection(obj, listener)，<br>不要使用<code>$watch()</code>或者<code>$watchGroup()</code>;</p></li><li><p>使用 one-time binding</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123;::user.first_name&#125;&#125;</span><br></pre></td></tr></table></figure><span id="more"></span></li><li><p>使用 Track by<br>以前的用法<br><code>ng-repeat=&quot;user in users&quot;</code><br>修改后的用法<br><code>ng-repeat=&quot;user in users track by user.id&quot;</code>如果 users 有 id 的话<br>或者<code>ng-repeat=&quot;user in users track by $index&quot;</code>如果没有 id</p></li><li><p>不要使用 console.log(),而是用$log</p><p>The <code>$log</code> service has several log levels <code>.info</code> <code>.debug</code> and <code>.error</code>.</p></li><li><p>禁用 dubug</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">angular.<span class="title function_">module</span>(<span class="string">&#x27;yourModule&#x27;</span>).<span class="title function_">config</span>(<span class="keyword">function</span>(<span class="params">$compileProvider</span>) &#123;</span><br><span class="line">  <span class="keyword">if</span> (<span class="comment">/* test if in production */</span>) &#123;</span><br><span class="line"> $compileProvider.<span class="title function_">debugInfoEnabled</span>(<span class="literal">false</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>AngularJS by default adds scope references to the DOM for tools such as <a href="https://chrome.google.com/webstore/detail/angularjs-batarang/ighdmehidhipcmcojjgiloacoafjmpfk?hl=en">angularjs-batarang</a> to work. This has an impact on your application performance.</p></li><li><p>使用 lodash 库的_.forEach 遍历,他的效率是 angular foreach 的 4 倍。</p></li><li><p>动画，参考这篇文章<a href="http://www.bennadel.com/blog/2935-enable-animations-explicitly-for-a-performance-boost-in-angularjs.htm%E3%80%82%E6%8D%AE%E8%AF%B4%E6%9C%89%E6%98%BE%E8%91%97%E6%8F%90%E5%8D%87">http://www.bennadel.com/blog/2935-enable-animations-explicitly-for-a-performance-boost-in-angularjs.htm。据说有显著提升</a></p></li></ol><h1 id="ionic-性能优化"><a href="#ionic-性能优化" class="headerlink" title="ionic 性能优化"></a>ionic 性能优化</h1><ol><li>使用原生滚动方式</li></ol><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">angular.<span class="title function_">module</span>(<span class="string">&quot;yourModule&quot;</span>).<span class="title function_">config</span>(<span class="keyword">function</span> (<span class="params">$ionicConfigProvider</span>) &#123;</span><br><span class="line">  $ionicConfigProvider.<span class="property">scrolling</span>.<span class="title function_">jsScrolling</span>(<span class="literal">false</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>​ 参考:<a href="http://blog.ionic.io/native-scrolling-in-ionic-a-tale-in-rhyme/">http://blog.ionic.io/native-scrolling-in-ionic-a-tale-in-rhyme/</a></p><ol start="2"><li>使用 collection repeat</li></ol><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">ion-content</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">ion-item</span> <span class="attr">collection-repeat</span>=<span class="string">&quot;item in items&quot;</span>&gt;</span> &#123;&#123;item&#125;&#125; <span class="tag">&lt;/<span class="name">ion-item</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">ion-content</span>&gt;</span></span><br></pre></td></tr></table></figure><p>参考:<a href="http://ionicframework.com/docs/api/directive/collectionRepeat/">http://ionicframework.com/docs/api/directive/collectionRepeat/</a></p><ol start="3"><li>无限滚动</li></ol><p><ion-infinite-scroll> 指令允许调用一个函数，当页面到底部或靠近底部的时候。</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">ion-content</span> <span class="attr">ng-controller</span>=<span class="string">&quot;MyController&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">ion-list</span>&gt;</span> .... .... <span class="tag">&lt;/<span class="name">ion-list</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">ion-infinite-scroll</span> <span class="attr">on-infinite</span>=<span class="string">&quot;loadMore()&quot;</span> <span class="attr">distance</span>=<span class="string">&quot;1%&quot;</span>&gt;</span> <span class="tag">&lt;/<span class="name">ion-infinite-scroll</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">ion-content</span>&gt;</span></span><br></pre></td></tr></table></figure><p>使用 one-time binding,track by 和 native scrolling 组合有最好的性能。</p><ol start="4"><li><p>缓存试图</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">angular.<span class="title function_">module</span>(<span class="string">&quot;yourModule&quot;</span>).<span class="title function_">config</span>(<span class="keyword">function</span> (<span class="params">$ionicConfigProvider</span>) &#123;</span><br><span class="line">  $ionicConfigProvider.<span class="property">views</span>.<span class="title function_">maxCache</span>(<span class="number">5</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$stateProvider.<span class="title function_">state</span>(<span class="string">&quot;myState&quot;</span>, &#123;</span><br><span class="line">  <span class="attr">cache</span>: <span class="literal">false</span>,</span><br><span class="line">  <span class="attr">url</span>: <span class="string">&quot;/myUrl&quot;</span>,</span><br><span class="line">  <span class="attr">templateUrl</span>: <span class="string">&quot;my-template.html&quot;</span>,</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">ion-view</span> <span class="attr">cache-view</span>=<span class="string">&quot;false&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">ion-view</span>&gt;</span></span><br></pre></td></tr></table></figure></li><li><p>试图缓存事件</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">$scope.$on(<span class="string">&quot;$ionicView.loaded&quot;</span>, <span class="keyword">function</span> (<span class="params"></span>) &#123;&#125;);</span><br><span class="line">$scope.$on(<span class="string">&quot;$ionicView.enter&quot;</span>, <span class="keyword">function</span> (<span class="params"></span>) &#123;&#125;);</span><br><span class="line">$scope.$on(<span class="string">&quot;$ionicView.leave&quot;</span>, <span class="keyword">function</span> (<span class="params"></span>) &#123;&#125;);</span><br><span class="line">$scope.$on(<span class="string">&quot;$ionicView.beforeEnter&quot;</span>, <span class="keyword">function</span> (<span class="params"></span>) &#123;&#125;);</span><br><span class="line">$scope.$on(<span class="string">&quot;$ionicView.beforeLeave&quot;</span>, <span class="keyword">function</span> (<span class="params"></span>) &#123;&#125;);</span><br><span class="line">$scope.$on(<span class="string">&quot;$ionicView.afterEnter&quot;</span>, <span class="keyword">function</span> (<span class="params"></span>) &#123;&#125;);</span><br><span class="line">$scope.$on(<span class="string">&quot;$ionicView.afterLeave&quot;</span>, <span class="keyword">function</span> (<span class="params"></span>) &#123;&#125;);</span><br><span class="line">$scope.$on(<span class="string">&quot;$ionicView.unloaded&quot;</span>, <span class="keyword">function</span> (<span class="params"></span>) &#123;&#125;);</span><br></pre></td></tr></table></figure><p>正确使用事件加载数据可以优化程序</p></li></ol>]]></content>
      
      
      <categories>
          
          <category> 前端开发 </category>
          
          <category> 性能优化 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> JavaScript </tag>
            
            <tag> 性能优化 </tag>
            
            <tag> 前端框架 </tag>
            
            <tag> Ionic </tag>
            
            <tag> AngularJS </tag>
            
            <tag> 移动应用开发 </tag>
            
            <tag> Web性能 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Ionic应用性能提升技巧：页面转场优化与缓存策略</title>
      <link href="/2017/01/18/ionic%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96-ionic%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/"/>
      <url>/2017/01/18/ionic%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96-ionic%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/</url>
      
        <content type="html"><![CDATA[<h1 id="ionic-native-transitions"><a href="#ionic-native-transitions" class="headerlink" title="ionic-native-transitions"></a>ionic-native-transitions</h1><ol><li><p>下载</p><p>npm install ionic-native-transitions –save</p></li><li><p>安装</p><p>cordova plugin add <a href="https://github.com/Telerik-Verified-Plugins/NativePageTransitions">https://github.com/Telerik-Verified-Plugins/NativePageTransitions</a></p><span id="more"></span></li><li><p>引入</p><script src="lib/ionic-native-transitions/dist/ionic-native-transitions.js"></script></li><li><p>如果是 ios9，页面切换抖动，则安装</p><p>cordova plugin add cordova-plugin-wkwebvie</p></li><li><p>注入</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">angular.<span class="title function_">module</span>(<span class="string">&quot;yourApp&quot;</span>, [<span class="string">&quot;ionic-native-transitions&quot;</span>]);</span><br></pre></td></tr></table></figure></li><li><p>配置</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">.<span class="title function_">config</span>(<span class="keyword">function</span>(<span class="params">$ionicNativeTransitionsProvider</span>)&#123;</span><br><span class="line">    $ionicNativeTransitionsProvider.<span class="title function_">setDefaultOptions</span>(&#123;</span><br><span class="line">        <span class="attr">duration</span>: <span class="number">400</span>, <span class="comment">// in milliseconds (ms), default 400,</span></span><br><span class="line">        <span class="attr">slowdownfactor</span>: <span class="number">4</span>, <span class="comment">// overlap views (higher number is more) or no overlap (1), default 4</span></span><br><span class="line">        <span class="attr">iosdelay</span>: -<span class="number">1</span>, <span class="comment">// ms to wait for the iOS webview to update before animation kicks in, default -1</span></span><br><span class="line">        <span class="attr">androiddelay</span>: -<span class="number">1</span>, <span class="comment">// same as above but for Android, default -1</span></span><br><span class="line">        <span class="attr">winphonedelay</span>: -<span class="number">1</span>, <span class="comment">// same as above but for Windows Phone, default -1,</span></span><br><span class="line">        <span class="attr">fixedPixelsTop</span>: <span class="number">0</span>, <span class="comment">// the number of pixels of your fixed header, default 0 (iOS and Android)</span></span><br><span class="line">        <span class="attr">fixedPixelsBottom</span>: <span class="number">0</span> <span class="comment">// the number of pixels of your fixed footer (f.i. a tab bar), default 0 (iOS and Android)</span></span><br><span class="line">        <span class="attr">triggerTransitionEvent</span>: <span class="string">&#x27;$ionicView.afterEnter&#x27;</span>, <span class="comment">// internal ionic-native-transitions option</span></span><br><span class="line">        <span class="attr">backInOppositeDirection</span>: <span class="literal">false</span> <span class="comment">// Takes over default back transition and state back transition to use the opposite direction transition to go back</span></span><br><span class="line">    &#125;);</span><br><span class="line">   $ionicNativeTransitionsProvider.<span class="title function_">setDefaultTransition</span>(&#123;</span><br><span class="line">        <span class="attr">type</span>: <span class="string">&#x27;slide&#x27;</span>,</span><br><span class="line">        <span class="attr">direction</span>: <span class="string">&#x27;left&#x27;</span></span><br><span class="line">    &#125;);</span><br><span class="line">  $ionicNativeTransitionsProvider.<span class="title function_">setDefaultBackTransition</span>(&#123;</span><br><span class="line">        <span class="attr">type</span>: <span class="string">&#x27;slide&#x27;</span>,</span><br><span class="line">        <span class="attr">direction</span>: <span class="string">&#x27;right&#x27;</span></span><br><span class="line">    &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></li><li><p>其他参考<a href="https://github.com/shprink/ionic-native-transitions">https://github.com/shprink/ionic-native-transitions</a> 或者 pdf</p></li></ol><h1 id="删除默认滚动条"><a href="#删除默认滚动条" class="headerlink" title="删除默认滚动条"></a>删除默认滚动条</h1><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">.<span class="title function_">config</span>(<span class="keyword">function</span>(<span class="params">$ionicConfigProvider</span>) &#123;</span><br><span class="line">  $ionicConfigProvider.<span class="property">scrolling</span>.<span class="title function_">jsScrolling</span>(<span class="literal">false</span>);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// Or for only a single platform, use</span></span><br><span class="line">  <span class="comment">// if( ionic.Platform.isAndroid() ) &#123;</span></span><br><span class="line">    <span class="comment">// $ionicConfigProvider.scrolling.jsScrolling(false);</span></span><br><span class="line">  <span class="comment">// &#125;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="使用缓存"><a href="#使用缓存" class="headerlink" title="使用缓存"></a>使用缓存</h1><ol><li><p>安装</p><p>bower install –save angular-cache</p></li><li><p>注入</p><p>angular.module(‘myApp’, [‘angular-cache’])</p></li><li><p>使用</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">.<span class="title function_">controller</span>(<span class="string">&#x27;Posts&#x27;</span>, <span class="keyword">function</span> (<span class="params">CacheFactory</span>) &#123;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (!<span class="title class_">CacheFactory</span>.<span class="title function_">get</span>(<span class="string">&#x27;postCache&#x27;</span>)) &#123;</span><br><span class="line">  <span class="title class_">CacheFactory</span>.<span class="title function_">createCache</span>(<span class="string">&#x27;postCache&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> postCache = <span class="title class_">CacheFactory</span>.<span class="title function_">get</span>(<span class="string">&#x27;postCache&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Cache a post</span></span><br><span class="line">postCache.<span class="title function_">put</span>(id, data);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Delete from cache</span></span><br><span class="line">postCache.<span class="title function_">remove</span>(id);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Get a post</span></span><br><span class="line">$scope.<span class="property">post</span> = postCache.<span class="title function_">get</span>(id);</span><br><span class="line"></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure></li><li><p>详情请看<a href="https://github.com/jmdobry/angular-cache">https://github.com/jmdobry/angular-cache</a></p></li></ol><h1 id="使用-Crosswalk-WebView"><a href="#使用-Crosswalk-WebView" class="headerlink" title="使用 Crosswalk WebView"></a>使用 Crosswalk WebView</h1><ol><li><p>安装</p><p>cordova plugin add cordova-plugin-crosswalk-webview</p></li><li><p>如果使用了第一步优化，在 config.xml 加入</p><p><preference name="CrosswalkAnimatable" value="true" /></p></li></ol>]]></content>
      
      
      <categories>
          
          <category> 移动应用开发 </category>
          
          <category> 性能优化 </category>
          
          <category> Ionic开发 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 性能优化 </tag>
            
            <tag> 移动开发 </tag>
            
            <tag> Ionic </tag>
            
            <tag> Angular </tag>
            
            <tag> WebView </tag>
            
            <tag> Crosswalk </tag>
            
            <tag> 页面转场 </tag>
            
            <tag> 缓存管理 </tag>
            
            <tag> 混合应用 </tag>
            
            <tag> 前端优化 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>苏幕遮·独恋飞蛾：一曲执着的生命绝唱</title>
      <link href="/2017/01/04/%E8%8B%8F%E5%B9%95%E9%81%AE-%E8%8B%8F%E5%B9%95%E9%81%AE/"/>
      <url>/2017/01/04/%E8%8B%8F%E5%B9%95%E9%81%AE-%E8%8B%8F%E5%B9%95%E9%81%AE/</url>
      
        <content type="html"><![CDATA[<h3 id="独恋飞蛾"><a href="#独恋飞蛾" class="headerlink" title="独恋飞蛾"></a>独恋飞蛾</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">情已逝，缘未了。欲罢不能，何时是拂晓。痴望情思路迢迢，只身孤影，独有恋曲过今朝。人已死，心未缈。风絮满城，何处无寂寥。静闻空心雨潇潇，谁为梦魇？唯有飞蛾火中烧。</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 古典词作 </category>
          
          <category> 文学创作 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 苏幕遮 </tag>
            
            <tag> 词牌 </tag>
            
            <tag> 古典诗词 </tag>
            
            <tag> 抒情词 </tag>
            
            <tag> 生命诗歌 </tag>
            
            <tag> 情感词作 </tag>
            
            <tag> 意象诗词 </tag>
            
            <tag> 飞蛾意象 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>愿化作雄鹰：追寻人生无悔的彩虹</title>
      <link href="/2017/01/04/%E6%84%BF%E5%8C%96%E4%BD%9C%E9%9B%84%E9%B9%B0%EF%BC%8C%E9%A3%9E%E5%90%91%E5%A4%A9%E7%A9%BA-%E6%84%BF%E5%8C%96%E4%BD%9C%E9%9B%84%E9%B9%B0%E9%A3%9E%E5%90%91%E5%A4%A9%E7%A9%BA/"/>
      <url>/2017/01/04/%E6%84%BF%E5%8C%96%E4%BD%9C%E9%9B%84%E9%B9%B0%EF%BC%8C%E9%A3%9E%E5%90%91%E5%A4%A9%E7%A9%BA-%E6%84%BF%E5%8C%96%E4%BD%9C%E9%9B%84%E9%B9%B0%E9%A3%9E%E5%90%91%E5%A4%A9%E7%A9%BA/</url>
      
        <content type="html"><![CDATA[<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">脸上的泪痕是曾经的懵懂</span><br><span class="line"></span><br><span class="line">心中的坚韧从今天萌生</span><br><span class="line"></span><br><span class="line">抚摸胸口她送的伤痛</span><br><span class="line"></span><br><span class="line">为什么嘴边还会残留着笑容</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">再见，至今还在做的梦</span><br><span class="line"></span><br><span class="line">我想去追寻人生无悔的彩虹</span><br><span class="line"></span><br><span class="line">不论是否能够拥抱成功</span><br><span class="line"></span><br><span class="line">都无愧于她的别赠</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">现在，我要忘记她给的痛</span><br><span class="line"></span><br><span class="line">用实际完成对未来的憧憬</span><br><span class="line"></span><br><span class="line">让瞬间的生命化为永恒</span><br><span class="line"></span><br><span class="line">这永恒中不会再有她的生命</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">泰山巅峰刺骨的寒冷</span><br><span class="line"></span><br><span class="line">阻止不了一心征服的雄鹰</span><br><span class="line"></span><br><span class="line">他的骨子里有对信念的虔诚</span><br><span class="line"></span><br><span class="line">他的眼中只会有天空</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 诗歌创作 </category>
          
          <category> 生活感悟 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 现代诗 </tag>
            
            <tag> 励志诗歌 </tag>
            
            <tag> 人生感悟 </tag>
            
            <tag> 情感抒发 </tag>
            
            <tag> 生命思考 </tag>
            
            <tag> 理想追求 </tag>
            
            <tag> 成长历程 </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
