---
title: æ—¶åºæ•°æ®åº“
copyright_author: houxiaozhao
copyright_author_href: https://github.com/houxiaozhao
copyright_url: https://100042.xyz
copyright_info: æ­¤æ–‡ç« ç‰ˆæƒå½’houxiaozhaoæ‰€æœ‰ï¼Œå¦‚æœ‰è½¬è½½ï¼Œè¯·æ³¨æ˜æ¥è‡ªåŸä½œè€…
date: 2019-03-07 15:00:01.0
updated: 2022-03-08 11:32:49.106
url: /archives/æ—¶åºæ•°æ®åº“
categories:
tags:
  - nodejs
  - InfluxDB
---

# å‰è¨€

æˆ‘ä¹‹å‰çš„èŠ‚ç‚¹æ•°æ®æ˜¯å…¨éƒ½å­˜åˆ° mongoDB ä¸­çš„ã€‚å¶ç„¶çš„æœºä¼šï¼Œå‘ç°äº† InfluxDB è¿™ç§æ—¶åºæ•°æ®åº“ã€‚äºæ˜¯èŠ±äº†ç‚¹æ—¶é—´ç®€å•ä½¿ç”¨ä¸€äº›ï¼Œçœ‹çœ‹æ˜¯å¦èƒ½æ›¿æ¢ mongoDB å­˜å‚¨å†å²æ•°æ®ã€‚

# InfluxDB ç®€ä»‹

InfluxDB æ˜¯ä¸€ä¸ªå¼€æºæ—¶åºæ•°æ®åº“ã€‚é€‚åˆå¤„ç†åˆ†æèµ„æºæ•°æ®ç›‘æ§ç›¸å…³æ•°æ®ã€‚

[https://docs.influxdata.com/influxdb/v1.6/](https://docs.influxdata.com/influxdb/v1.6/)

  <!--more-->

# å®‰è£…

ç›®å‰æœ€æ–°ç‰ˆæœ¬ä¸º v1.6ã€‚

å®‰è£… InfluxDB çš„æ–¹å¼å¾ˆç®€å•(Ubuntu)

    $ curl -sL <https://repos.influxdata.com/influxdb.key> | sudo apt-key add -
    $ source /etc/lsb-release
    $ echo "deb <https://repos.influxdata.com/${DISTRIB_ID,,}> ${DISTRIB_CODENAME} stable" | sudo tee /etc/apt/sources.list.d/influxdb.list
    $ sudo apt-get update && sudo apt-get install influxdb
    $ sudo service influxdb start

å®Œæˆã€‚ğŸ˜‹

ç„¶åå°±å¯ä»¥åœ¨å‘½ä»¤è¡Œé‡Œè¾“å…¥ influx æ„‰å¿«çš„ç©è€äº†ã€‚

ä½¿ç”¨å‘½ä»¤è¡Œåˆ›å»ºä¸€äº›æ•°æ®

    create database 'mydb'
    use mydb
    insert test,tag1=111,tag2=222 field1=111111,field2=222222

ç„¶åå°±å¯ä»¥æŸ¥è¯¢æ•°æ®ã€‚ç”±äºæ˜¯æ–°æ‰‹ï¼Œå½“ç„¶æ˜¯ä½¿ç”¨å·¥å…·å•¦ã€‚

ä»¥å‰çš„ç‰ˆæœ¬è‡ªå¸¦ä¸€ä¸ª web ç®¡ç†ç•Œé¢ã€‚ç°åœ¨çš„ç‰ˆæœ¬æ²¡æœ‰äº†~

é™„ä¸Šå¯è§†åŒ–å·¥å…·ä¸€æš[https://github.com/CymaticLabs/InfluxDBStudio](https://github.com/CymaticLabs/InfluxDBStudio)

![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://img-blog.csdnimg.cn/20190307145841886.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3UwMTExMTI3NzM=,size_16,color_FFFFFF,t_70)
![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://img-blog.csdnimg.cn/20190307145901883.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3UwMTExMTI3NzM=,size_16,color_FFFFFF,t_70)

æ’å…¥æˆåŠŸ ğŸ˜„ å¯ä»¥çœ‹åˆ°é‡Œé¢é™¤äº†æˆ‘ä»¬è‡ªå·±åŠ çš„ä¸¤ä¸ª tag,ä¸¤ä¸ª field,è¿˜åŒ…æ‹¬ä¸€ä¸ªè‡ªåŠ¨æ·»åŠ çš„ timeã€‚æ¯•ç«Ÿæ˜¯`æ—¶åºæ•°æ®åº“`å˜›ï¼

é™¤äº†ä½¿ç”¨ InfluxDBStudio ä»¥å¤–ï¼Œè¿˜å¯ä»¥ä½¿ç”¨å¦ä¸€ä¸ªå·¥å…· Grafanaã€‚[https://grafana.com](https://grafana.com/) æ„Ÿå…´è¶£çš„å¯ä»¥è‡ªå·±å»æŸ¥æŸ¥ã€‚å—¯ï¼Œå¾ˆç‚«ã€‚

![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://img-blog.csdnimg.cn/20190307145928906.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3UwMTExMTI3NzM=,size_16,color_FFFFFF,t_70)

# Nodejs ä½¿ç”¨

npm åŒ… [https://www.npmjs.com/package/influx](https://www.npmjs.com/package/influx)

## å®‰è£…

    npm install --save influx@next

## ç¬¬ä¸€æ­¥ æ’å…¥æ•°æ®

    const Influx = require('influx'); //å¯¼åŒ…
    // å®šä¹‰æ•°æ®åº“è¿æ¥å’Œæ•°æ®æ ¼å¼ï¼Œåˆ›å»ºclient
    const client = new Influx.InfluxDB({
      database: 'mydb',
      username: 'root',
      password: 'root',
      hosts: [{ host: 'xx.xx.xx.xxx' }],
      schema: [
        {
          measurement: 'test', //ç±»ä¼¼äºæ•°æ®è¡¨çš„æ¦‚å¿µ
          fields: { //æ•°æ®è¡¨çš„å­—æ®µï¼Œå®šä¹‰ç±»å‹ï¼ŒFLOAT/INTEGER/STRING/BOOLEAN
    			  field1:Influx.FieldType.INTEGER,
    				field2:Influx.FieldType.INTEGER,
          }, // tag ä¹Ÿæ˜¯é‡Œé¢çš„å­—æ®µï¼Œæ˜¯è‡ªå¸¦ç´¢å¼•å…‰ç¯ã€‚æŸ¥è¯¢é€Ÿåº¦æ æ çš„ã€‚
          tags: ['tag1','tag2']
        }
      ]
    });
    // æ’å…¥æ•°æ®
    client.writePoints([
              {
                measurement: 'test',
                fields: {
                  field1:1231123,
    							field2:44233,
                },
                tags: {
                  tag1:14233,
    							tag2:41122
                }
              }
            ])

## ç¬¬äºŒæ­¥ æŸ¥è¯¢æ•°æ®

    const Influx = require('influx');
    // å’Œä¸Šè¾¹ä¸€æ ·ã€‚
    const client = new Influx.InfluxDB({
      database: 'mydb',
      username: 'root',
      password: 'root',
      hosts: [{ host: 'xx.xx.xx.xxx' }],
      schema: [
        {
          measurement: 'test', //ç±»ä¼¼äºæ•°æ®è¡¨çš„æ¦‚å¿µ
          fields: { //æ•°æ®è¡¨çš„å­—æ®µï¼Œå®šä¹‰ç±»å‹ï¼ŒFLOAT/INTEGER/STRING/BOOLEAN
    			  field1:Influx.FieldType.INTEGER,
    				field2:Influx.FieldType.INTEGER,
          }, // tag ä¹Ÿæ˜¯é‡Œé¢çš„å­—æ®µï¼Œæ˜¯è‡ªå¸¦ç´¢å¼•å…‰ç¯ã€‚æŸ¥è¯¢é€Ÿåº¦æ æ çš„ã€‚
          tags: ['tag1','tag2']
        }
      ]
    });
    // è·å–5åˆ†é’Ÿå†…çš„æ•°æ®
    // è‡³äºInfluxçš„æŸ¥è¯¢è¯­æ³•ï¼Œæ®è¯´å’Œmysqlæœ‰ç‚¹ç±»ä¼¼ã€‚è¿˜æ²¡æœ‰å…·ä½“ç ”ç©¶ã€‚ç°åœ¨å°±ç®€å•æŸ¥ä¸€ä¸ªå§
    client
      .query(
        `
        SELECT * FROM "test" WHERE time > now() - 5m
      `
      )
      .then(res => {
        console.log(res); //è¾“å‡ºä¸€ä¸ªæ•°ç»„ã€‚
      });

# æ€»ç»“

åˆ°ç›®å‰ä½ç½®ï¼Œå·²ç»åŸºæœ¬æ»¡è¶³é¡¹ç›®éœ€æ±‚ã€‚æ¥ä¸‹æ¥å°±æ˜¯å„ç§èŠ±å¼æŸ¥è¯¢è€Œå·²ã€‚

## å„ç§é“¾æ¥ ğŸ”—

- [https://docs.influxdata.com/influxdb/v1.6/](https://docs.influxdata.com/influxdb/v1.6/)
- [https://github.com/CymaticLabs/InfluxDBStudio](https://github.com/CymaticLabs/InfluxDBStudio)
- [https://grafana.com](https://grafana.com/)
- [https://www.npmjs.com/package/influx](https://www.npmjs.com/package/influx)
